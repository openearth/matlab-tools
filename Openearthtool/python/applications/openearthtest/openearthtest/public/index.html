<html>

<head>
	<link href="stylesheets/style.css" rel="stylesheet" type="text/css">
	<script type="text/javascript" src="scripts/js/loadxmldoc.js"></script>
	<script type="text/javascript">

		// Initialize called on HTML body load
		function init()
		{
			programFile = "programs.xml"
			fillProgramListbox(programFile);
		}

		// Fill program-selection listbox with available cases
		function fillProgramListbox(programFile)
		{
			// first remove all what is in the listbox
			while(document.getElementById("dataProgramSelect").options.length!=0)
			document.getElementById("dataProgramSelect").remove(0);

			programDoc=loadXMLDoc("xml/" + programFile);
			numOfData=programDoc.getElementsByTagName("title").length;

			for (i=0;i<numOfData;i=i+1)
			{
			var oOption = document.createElement("OPTION");
			oOption.text=programDoc.getElementsByTagName("title")[i].childNodes[0].nodeValue;
			oOption.value=i;
			document.getElementById("dataProgramSelect").options.add(oOption)
			}

			fillCaseListbox(0)

			return true;
		}

		// Fill case-selection listbox with available cases
		function fillCaseListbox(programValue)
		{
			// first remove all what is in the listbox
			while(document.getElementById("dataCaseSelect").options.length!=0)
			document.getElementById("dataCaseSelect").remove(0);

			while(document.getElementById("dataSubCaseSelect").options.length!=0)
			document.getElementById("dataSubCaseSelect").remove(0);

			caseFile = programDoc.getElementsByTagName("casefile")[programValue].childNodes[0].nodeValue
			programDir = caseFile.substring(0,caseFile.length-4)
			caseDoc=loadXMLDoc("xml/"+ programDir +"/"+ caseFile);
			numOfData=caseDoc.getElementsByTagName("title").length;

			for (i=0;i<numOfData;i=i+1)
			{
			var oOption = document.createElement("OPTION");
			oOption.text=caseDoc.getElementsByTagName("title")[i].childNodes[0].nodeValue;
			oOption.value=i;
			document.getElementById("dataCaseSelect").options.add(oOption)
			}

			fillSubCaseListbox(0,programDir)

			return true;
		}

		// Fill case-selection listbox with available cases
		function fillSubCaseListbox(caseValue,programDir)
		{
			if(caseDoc.getElementsByTagName("subcasefile").length!=0)
			{
				// first remove all what is in the listbox
				while(document.getElementById("dataSubCaseSelect").options.length!=0)
				document.getElementById("dataSubCaseSelect").remove(0);

				subcaseFile = caseDoc.getElementsByTagName("subcasefile")[caseValue].childNodes[0].nodeValue
				caseDir = subcaseFile.substring(0,subcaseFile.length-4)
				subcaseDoc=loadXMLDoc("xml/"+ programDir + "/" + subcaseFile);
				numOfData=subcaseDoc.getElementsByTagName("title").length;

				for (i=0;i<numOfData;i=i+1)
				{
				var oOption = document.createElement("OPTION");
				oOption.text=subcaseDoc.getElementsByTagName("title")[i].childNodes[0].nodeValue;
				oOption.value=i;
				document.getElementById("dataSubCaseSelect").options.add(oOption)
				}
			}
			else
			{
				var oOption = document.createElement("OPTION");
				oOption.text="No subcases available";
				oOption.value=100;
				dataSubCaseSelect.options.add(oOption)
			}

			return true;
		}

	</script>
</head>

<body onload="init()" id='body'>
<h1>OpenEarth Viewer</h1>
<hr/>
<div style='border: 1px solid silver; width:600px; height:200px'>
<h3>Open Earth Data, Model and Tool Viewer</h3>
<p>
Using the OpenEarth viewer, you can easily view data, models and tools in a Google Earth interface. Select a case below and click on 'Launch viewer' to open the application.
</p>

<p>Select case:</p>
<form name="dataviewer" action="data.html" method="get">
	<select name="program" id="dataProgramSelect" class="s" onchange="fillCaseListbox(dataProgramSelect.value)">
		<option value="0" class="vs">Select program</option>
	</select>
    <select name="case" id="dataCaseSelect" class="s" onchange="fillSubCaseListbox(dataCaseSelect.value,programDir)">
		<option value="0" class="vs">Select case</option>
	</select>
    <select name="subcase" id="dataSubCaseSelect" class="s">
		<option value="0" class="vs">Select subcase</option>
	</select>
	<input type="submit" value="Launch dataviewer" />
</form>
</div>

<br />
This tool is provided by: <br />
<a href="http://openearth.eu" target="_blank"><img src="images/oet.png" align="left" width="100" border="0"/></a>
</body>

</html>