<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" xmlns:tal="http://xml.zope.org/namespaces/tal">
<head>
  <title>netCDF Kickstarter</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
  <meta name="keywords" content="netcdf kickstarter tudelft delft nemo naturecoast sandmotor" />
  <meta name="description" content="netCDF kickstarter application to quickly generate netCDF data files according to CF convention" />
  <link rel="shortcut icon" href="${request.static_url('netcdfkickstarter:static/favicon.ico')}" />
  <link rel="stylesheet" href="static/jquery-ui-1.10.2/css/smoothness/jquery-ui-1.10.2.custom.min.css" />
  <script src="static/jquery-ui-1.10.2/js/jquery-1.9.1.js"></script>
  <script src="static/jquery-ui-1.10.2/js/jquery-ui-1.10.2.custom.js"></script>
  <script src="static/jquery-cookie/jquery.cookie.js"></script>
  <script type="text/javascript">
    function fillTemplateList() {
      var json_url = "json/templates?callback=?";
      $.getJSON(json_url, function(data) {
        obj = $("#template-selector select");
        for (var i=0;i<data.length;i++) {
          objOption = $("<option>").val(data[i])
                                   .text(data[i]);
          obj.append(objOption);
        };
	fillMarkerTabs();
      });
    }

    function fillCRSList() {
      var json_url = "json/coordinatesystems?callback=?";
      $.getJSON(json_url, function(data) {
        obj = $("#crs-selector select");
        for (var i=0;i<data.length;i++) {
          objOption = $("<option>").val(data[i]["epsg_code"])
                                   .text(data[i]["_name"]);
          obj.append(objOption);
        };
      });
    }

    function fillMarkerTabs() {
      var json_url = "json/categories?callback=?";
      $.getJSON(json_url, function(data) {
        obj = $("#marker-tabs");
	obj.html("");
        objList = $("<ul>");
        obj.append(objList);
        for (var i=0;i<data.length;i++) {
          objItem = $("<li>").append($("<a>").attr("href","#tab-"+data[i])
					     .text(data[i]))
	  objPanel = $("<div>").attr("id","tab-"+data[i]);

          objList.append(objItem);
	  obj.append(objPanel);

	  if (i==0) {
            fillMarkerList(objPanel);
          }
        };
	obj.tabs("refresh").tabs("option","active",0);
      });
    }

    function fillMarkerList(pnl) {
      var cat = $(pnl).attr("id").replace("tab-","");
      var tmpl = $("#template-selector select").val();
      var json_url = "json/templates/" + tmpl + "?category=" + cat + "&callback=?";
      $.getJSON(json_url, function(data) {
	html = "";
        for (var i=0;i<data.length;i++) {
	  if (data[i]["default"] == null) {
            data[i]["default"] = "";
          }
	  switch (data[i]["type"]) {
	    case "int":
            case "float":
              html += "<tr>";
	      html += "<td>" + data[i]["description"] + ":</td>";
	      html += "<td><input type=text size=10 name=m[" +
			data[i]["category"] + "." + data[i]["key"] + "] value=" +
			data[i]["default"] + "></td>";
	      html += "</tr>";
	    break;
	    case "str":
              html += "<tr>";
	      html += "<td>" + data[i]["description"] + ":</td>";
	      html += "<td><input type=text size=40 name=m[" +
			data[i]["category"] + "." + data[i]["key"] + "] value=" +
			data[i]["default"] + "></td>";
	      html += "</tr>"
            break;
	  }
        };
        pnl.html("<table border=0>" + html + "</table>");
      });
    }

    function setFormAction() {
      var format = $("#output-options input:radio:checked").val();
      var tmpl = $("#template-selector select").val();
      $("form").attr("action",format + "/" + tmpl);
    }

    $(function() {
      $("#marker-tabs").tabs({beforeActivate:function(event,ui){
					fillMarkerList(ui.newPanel);}});
      $("#create-netcdf input").button();
      $("#format-options").buttonset();
      $("#file-download input").button();
      fillTemplateList();
      fillCRSList();
    });
    </script>
    <style>
      h1 {
        font-family:verdana;
        font-size:26px;
        text-align:center;
      }
      #container {
        width:800px;
        margin-left:auto;
        margin-right:auto;
      }
      #template-selector select,
      #crs-selector select {
        width:100%;
        font-size:18px;
      }
      #format-options label {
        width:16%;
        margin-top:5px;
        margin-bottom:5px;
      }
      #create-netcdf input {
        width:100%;
      }
      #filename {
        float:left;
      }
      #filename input {
        width:600px;
      }
      #file-download {
        float:right;
      }
    </style>
    </head>
<body>
  <div id="container">
  <h1>netCDF Kickstarter</h1>
  <form action="#" method="get" onsubmit="setFormAction();">
    <div id="file-options">
      <div id="filename" class="ui-widget">
	<input type="text" name="filename" value="kickstarter.nc">
      </div>
      <div id="file-download">
        <input type="checkbox" name="download" value="1" id="c1" checked>
	<label for="c1">download as file</label>
      </div>
    </div>
    <div id="template-selector">
      <select onchange="fillMarkerTabs();"></select>
    </div>
    <div id="crs-selector">
      <select name="epsg"></select>
    </div>
    <div id="marker-tabs"></div>
    <div id="output-options">
      <div id="format-options">
	<input type="radio" id="r1" name="format" value="cdl"><label for="r1">CDL</label>
	<input type="radio" id="r2" name="format" value="netcdf" checked><label for="r2">netCDF</label>
	<input type="radio" id="r3" name="format" value="python"><label for="r3">Python</label>
	<input type="radio" id="r4" name="format" value="matlab"><label for="r4">Matlab</label>
	<input type="radio" id="r5" name="format" value="matlabnew"><label for="r5">Matlab *</label>
	<input type="radio" id="r6" name="format" value="ncml"><label for="r6">ncML</label>
	<input type="radio" id="r7" name="format" value="r"><label for="r7">R</label>
      </div>
    </div>
    <div id="create-netcdf">
      <input type="submit" value="Kickstart!">
    </div>
  </form>
  </div>
</body>
</html>
