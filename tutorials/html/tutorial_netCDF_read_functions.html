
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>Reading a netCDF file</title>
      <meta name="generator" content="MATLAB 7.9">
      <meta name="date" content="2009-11-05">
      <meta name="m-file" content="tutorial_netCDF_read_functions">
      <link type="text/css" href="script/css/jquery-ui-1.7.2.custom.css" rel="stylesheet">
      <link type="text/css" href="script/css/jquery.collapsible.css" rel="stylesheet"><script type="text/javascript" src="script/js/jquery-1.3.2.min.js"></script><script type="text/javascript" src="script/js/jquery-ui-1.7.2.custom.min.js"></script><script type="text/javascript" src="script/js/matlab2collapsible.js"></script><script type="text/javascript" src="script/js/jquery.collapsible.js"></script><script type="text/javascript" src="script/js/matlabhelp.js"></script><script type="text/javascript">
  	$(document).ready(function ()
  	{
  	// Copy content
	copycontent();

	// validate href of links to matlab tutorials
	matlabpreparehelprefs();

  	// Accordion
  	collapsible($(".collapsible"));
  	});
    </script><style>

pre.codeinput {
  overflow-x: auto;
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
}

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #9F1EF4}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  overflow-x: auto;
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

#contents {
  border-style:solid;
  border-width:1px;
}

  </style></head>
   <body LINK="#48339F" VLINK="#48339F" ALINK="#48339F">
      <div class="content">
         <div class="introduction ui-widget ui-widget-content ui-corner-all">
            <h1>Reading a netCDF file</h1>
            <div>
               <p>Someone should finish this tutorial. It still looks like nothing....</p>
            </div>
            <h2>Contents</h2>
            <div>
               <ul>
                  <li><a href="#1">Basics of netCDF files</a></li>
                  <li><a href="#2">Locating a data file on the internet</a></li>
                  <li><a href="#6">Interacting with a netCDF file</a></li>
                  <li><a href="#9">View metadata</a></li>
                  <li><a href="#12">Zero based indexing</a></li>
                  <li><a href="#13">Stride</a></li>
                  <li><a href="#14">netCDF viewers</a></li>
               </ul>
            </div>
         </div>
         <div class="collapsible">
            <div>
               <h2><a name="1">Basics of netCDF files</a></h2>
               <div><pre class="codeinput"><span class="comment">% Visit a link, any suggestions?</span>
</pre></div>
            </div>
            <div>
               <h2><a name="2">Locating a data file on the internet</a></h2>
               <div>
                  <p>To locate a netCDF data file, browse to an OPeNDAP website, as e.g. the OpenEarth website:</p>
               </div>
            </div>
            <div>
               <div>
                  <p><a href="http://OPeNDAP.deltares.nl:8080">http://OPeNDAP.deltares.nl:8080</a></p>
               </div>
            </div>
            <div>
               <div>
                  <p>Find the Jarkus netCDF file by clicking on the following links: HYRAX ==&gt; Rijkswaterstaat ==&gt; JarKus ==&gt; transects. Click
                     on the link to the file and extract the direct link to the JarKus netCDF data file.
                  </p><pre class="codeinput">url = <span class="string">'http://OPeNDAP .deltares.nl:8080/OPeNDAP/rijkswaterstaat/jarkus/profiles/transect.nc'</span>;
</pre></div>
            </div>
            <div>
               <div>
                  <p>For some frequently used filetypes a dedicated funtion exists. This has the advantage that it returns the link to the netCDF
                     file on the Deltares network if it is available. This is faster than accessing data over the internet.
                  </p><pre class="codeinput">url = jarkus_url;
</pre></div>
            </div>
            <div>
               <h2><a name="6">Interacting with a netCDF file</a></h2>
               <div>
                  <p>To let matlab talk with a netCDF file, the snc toolbox has been developed. See what is in there:</p><pre class="codeinput">help <span class="string">snctools</span>
</pre><pre class="codeoutput">  SNC NetCDF toolbox (&lt;a href="http://mexcdf.sourceforge.net/"&gt;http://mexcdf.sourceforge.net/&lt;/a&gt;).
 
  SNCTools uses the the C (mexnc), java interface (toolsUI-2.2.22.jar) or Matlab (2008b+) 
  low-level netCDF interface. You can switch with the following preference:
  setpref ('SNCTOOLS', 'USE_JAVA', true/false);
 
  NC_ADDHIST         - Either appends or constructs a history attribute.
  NC_ADD_DIMENSION   - adds a dimension to an existing netcdf file
  NC_ADDHIST         - Either appends or constructs a history attribute.
  NC_ADDNEWRECS      - Tacks on new data from simple matlab structure to an unlimited-dimension netcdf file
  NC_ADD_RECS        - add records onto the end of a netcdf file
  NC_ADDVAR          - adds a variable to a NetCDF file
  NC_ATTGET          - Get the values of a NetCDF attribute.
  NC_ATTPUT          - put an attribute into a netcdf file
  NC_CAT_A           - concatentates a set of netcdf files into ascending order
  NC_CREATE_EMPTY    - creates an empty netCDF file 
  NC_DATATYPE_STRING - convert an enumerated datatype to human-readable string
  NC_DIFF            - determines if two NetCDF files contain the same data
  NC_DUMP            - is a Matlab counterpart to the NetCDF utility 'ncdump'.
  NC_GETALL          - read the entire contents of a netcdf file into a nested structure
  NC_GETBUFFER       - read the record variables of a netcdf file into a structure
  NC_GETDIMINFO      - returns metadata about a specific NetCDF dimension
  NC_GETLAST         - Get last few datums from an unlimited NetCDF variable.
  NC_GETVARINFO      - returns metadata about a specific NetCDF variable
  NC_INFO            - information about a NetCDF 2 or 3 file
  NC_ISCOORDVAR      - yes if the given variable is also a coordinate variable.
  NC_ISUNLIMITEDVAR  - yes if the given variable has a record dimension
  NC_ISVAR           - yes if the given variable is in the netcdf file
  NC_PADHEADER       - pads the metadata header of a netcdf file
  NC_VARGET          - Retrieve data from a NetCDF variable (zero-based indices!).
  NC_VARPUT          - Write data into a NetCDF file.
  NC_VARRENAME       - Renames a NetCDF variable.
  NC_VARSIZE         - return the size of the requested netncfile variable
  SNC2MAT            - saves netcdf file to *.mat format

</pre></div>
            </div>
            <div>
               <div>
                  <p>Important functions are nc_varget and nc_dump</p><pre class="codeinput">help <span class="string">nc_dump</span>
</pre><pre class="codeoutput">  NC_DUMP:  a Matlab counterpart to the NetCDF utility 'ncdump'.
      NC_DUMP(NCFILE) prints metadata about the netCDF file NCFILE.  
      NC_DUMP(NCFILE,VARNAME) prints metadata about just the one netCDF variable
      named VARNAME.
 

</pre></div>
            </div>
            <div>
               <div><pre class="codeinput">help <span class="string">nc_varget</span>
</pre><pre class="codeoutput">  NC_VARGET  Retrieve data from a netCDF variable (zero-based indices!).
 
  DATA = NC_VARGET(NCFILE,VARNAME) retrieves all the data from the 
  variable VARNAME in the netCDF file NCFILE.
 
  DATA = NC_VARGET(NCFILE,VARNAME,START,COUNT) retrieves the contiguous
  portion of the variable specified by the index vectors START and 
  COUNT.  Remember that SNCTOOLS indexing is zero-based, not 
  one-based.  Specifying a -1 in COUNT means to retrieve everything 
  along that dimension from the START coordinate.
 
  DATA = NC_VARGET(NCFILE,VARNAME,START,COUNT,STRIDE) retrieves 
  a non-contiguous portion of the dataset.  The amount of
  skipping along each dimension is given through the STRIDE vector.
 
  NCFILE can also be an OPeNDAP URL if the proper SNCTOOLS backend is
  installed.  See the README for details.
  
  NC_VARGET tries to be intelligent about retrieving the data.
  Since most general matlab operations are done in double precision,
  retrieved numeric data will be cast to double precision, while 
  character data remains just character data.  
 
  Singleton dimensions are removed from the output data.  
 
  A '_FillValue' attribute is honored by flagging those datums as NaN.
  A 'missing_value' attribute is honored by flagging those datums as 
  NaN.  The exception to this is for NC_CHAR variables, as mixing 
  character data and NaN doesn't really seem to work in matlab.
 
  If the named NetCDF variable has valid scale_factor and add_offset 
  attributes, then the data is scaled accordingly.  
 
  EXAMPLE:
  #1.  In this case, the variable in question has rank 2, and has size 
       500x700.  We want to retrieve starting at row 300, column 250.
       We want 100 contiguous rows, 200 contiguous columns.
  
       vardata = nc_varget ( file, variable_name, [300 250], [100 200] );
 
 See also: snctools

</pre></div>
            </div>
            <div>
               <h2><a name="9">View metadata</a></h2>
               <div>
                  <p>We can get data from this file using the function nc_varget. But first, let's see what is in the file using nc_dump. nc_dump
                     shows all the metadata in the file. In the case of the JarKus file this is a lot.
                  </p><pre class="codeinput">nc_dump(url)
</pre><pre class="codeoutput">netcdf http://opendap.deltares.nl:8080/opendap/rijkswaterstaat/jarkus/profiles/transect.nc { 

dimensions:
	alongshore = 2178 ;
	cross_shore = 1925 ;
	time = UNLIMITED ; (44 currently)


variables:
	long crs([]), shape = [1]
		crs:grid_mapping_name = "Oblique Stereographic" 
		crs:semi_major_axis = 6.3774e+006 
		crs:semi_minor_axis = "" 
		crs:inverse_flattening = 299.153 
		crs:latitude_of_projection_origin = 52.1562 
		crs:longitude_of_projection_origin = 5.38764 
		crs:false_easting = 155000 
		crs:false_northing = 463000 
		crs:scale_factor_at_projection_origin = 0.999908 
	char areaname(alongshore), shape = [2178]
		areaname:long_name = "area name" 
		areaname:comment = "names for the 15 coastal areas as defined by rijkswaterstaat" 
		areaname:string_length = 100 d
	double alongshore(alongshore), shape = [2178]
	long id(alongshore), shape = [2178]
		id:long_name = "identifier" 
		id:comment = "sum of area code (x1000000) and alongshore coordinate" 
	long areacode(alongshore), shape = [2178]
		areacode:long_name = "area code" 
		areacode:comment = "codes for the 15 coastal areas as defined by rijkswaterstaat" 
	double cross_shore(cross_shore), shape = [1925]
	double x(alongshore,cross_shore), shape = [2178 1925]
		x:standard_name = "projection_x_coordinate" 
		x:units = "m" 
		x:axis = "X" 
	double y(alongshore,cross_shore), shape = [2178 1925]
		y:standard_name = "projection_y_coordinate" 
		y:units = "m" 
		y:axis = "Y" 
	double lat(alongshore,cross_shore), shape = [2178 1925]
		lat:standard_name = "latitude" 
		lat:units = "degree_north" 
		lat:axis = "X" 
	double lon(alongshore,cross_shore), shape = [2178 1925]
		lon:standard_name = "longitude" 
		lon:units = "degree_east" 
		lon:axis = "Y" 
	double angle(alongshore), shape = [2178]
		angle:long_name = "angle of transect" 
		angle:units = "mradian" 
		angle:comment = "positive counter clockwise 0 east" 
	double mean_high_water(alongshore), shape = [2178]
		mean_high_water:long_name = "mean high water" 
		mean_high_water:units = "m" 
		mean_high_water:comment = "mean high water relative to nap" 
	double mean_low_water(alongshore), shape = [2178]
		mean_low_water:long_name = "mean low water" 
		mean_low_water:units = "m" 
		mean_low_water:comment = "mean low water relative to nap" 
	long time(time), shape = [44]
	double altitude(time,alongshore,cross_shore), shape = [44 2178 1925]
		altitude:standard_name = "surface_altitude" 
		altitude:units = "m" 
		altitude:comment = "altitude above geoid (NAP)" 
		altitude:coordinates = "lat lon" 
		altitude:grid_mapping = "crs" 
		altitude:_FillValue = -9999 


//global attributes:
		:alongshore.long_name = "alongshore coordinate" 
		:alongshore.units = "m" 
		:alongshore.comment = "alongshore coordinate within the 15 coastal areas as defined by rijkswaterstaat" 
		:cross_shore.long_name = "cross-shore coordinate" 
		:cross_shore.units = "m" 
		:cross_shore.comment = "cross-shore coordinate relative to the rsp (rijks strand paal)" 
		:time.standard_name = "time" 
		:time.units = "year" 
		:time.comment = "measurement year" 
		:time.axis = "T" 
		:title = "Jarkus Data" 
		:institution = "Rijkswaterstaat" 
		:source = "on shore and off shore measurements" 
		:history = "data received from Rijkswaterstaat, converted to netcdf on 02-Jun-2009" 
		:references = "Original source: http://www.watermarkt.nl/kustenzeebodem/ Deltares storage: https://repos.deltares.nl/repos/mcdata/trunk/jarkus/Converted with script with $Id: grid2netcdf.m 480 2009-05-29 14:55:07Z boer_g $" 
		:Conventions = "CF-1.4" 
		:spatial_ref = "COMPD_CS["Amersfoort / RD New + NAP",PROJCS["Amersfoort / RD New",GEOGCS["Amersfoort",DATUM["Amersfoort",SPHEROID["Bessel 1841",6377397.155,299.1528128,AUTHORITY["EPSG","7004"]],TOWGS84[565.04,49.91,465.84,-0.40939438743923684,-0.35970519561431136,1.868491000350572,0.8409828680306614],AUTHORITY["EPSG","6289"]],PRIMEM["Greenwich",0.0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.017453292519943295],AXIS["Geodetic latitude",NORTH],AXIS["Geodetic longitude",EAST],AUTHORITY["EPSG","4289"]],PROJECTION["Oblique Stereographic",AUTHORITY["EPSG","9809"]],PARAMETER["central_meridian",5.387638888888891],PARAMETER["latitude_of_origin",52.15616055555556],PARAMETER["scale_factor",0.9999079],PARAMETER["false_easting",155000.0],PARAMETER["false_northing",463000.0],UNIT["m",1.0],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","28992"]],VERT_CS["Normaal Amsterdams Peil",VERT_DATUM["Normaal Amsterdams Peil",2005,AUTHORITY["EPSG","5109"]],UNIT["m",1.0],AXIS["Gravity-related height",UP],AUTHORITY["EPSG","5709"]],AUTHORITY["EPSG","7415"]]" 
}
</pre></div>
            </div>
            <div>
               <div>
                  <p>From the metadata we can see that there is a field 'id'. To get this data, use nc_varget.</p><pre class="codeinput">id = nc_varget(url,<span class="string">'id'</span>);
</pre></div>
            </div>
            <div>
               <div>
                  <p>Now id contains the id's:</p><pre class="codeinput">id(1:10)
</pre><pre class="codeoutput">
ans =

     2000100
     2000101
     2000102
     2000103
     2000104
     2000105
     2000106
     2000120
     2000140
     2000160

</pre></div>
            </div>
            <div>
               <h2><a name="12">Zero based indexing</a></h2>
               <div>
                  <p>TODO</p>
               </div>
            </div>
            <div>
               <h2><a name="13">Stride</a></h2>
               <div>
                  <p>TODO</p>
               </div>
            </div>
            <div>
               <h2><a name="14">netCDF viewers</a></h2>
               <div>
                  <p>TODO</p>
               </div>
            </div>
         </div>
         <p class="footer"><br>
            this tutorial is based on: <a class="matlabhref" href="matlab:edit('_tutorial_netCDF_read_functions');" browserhref="http://crucible.delftgeosystems.nl/browse/~raw,r=1892/OpenEarthTools/trunk/matlab/general/netCDF/_tutorial_netCDF_read_functions.m">_tutorial_netCDF_read_functions.m (revision: 1892)</a><br>
Published with MATLAB&reg; 7.9<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Reading a netCDF file
% Someone should finish this tutorial. It still looks like nothing....

%% Basics of netCDF files

% Visit a link, any suggestions?

%% Locating a data file on the internet
% To locate a netCDF data file, browse to an OPeNDAP website, as e.g. the
% OpenEarth website:
%%
% <http://OPeNDAP.deltares.nl:8080> 

%% 
% Find the Jarkus netCDF file by clicking on the following links:
% HYRAX ==> Rijkswaterstaat ==> JarKus ==> transects.
% Click on the link to the file and extract the direct link to the JarKus
% netCDF data file. 

url = 'http://OPeNDAP .deltares.nl:8080/OPeNDAP/rijkswaterstaat/jarkus/profiles/transect.nc';

%%
% For some frequently used filetypes a dedicated funtion exists. This has 
% the advantage that it returns the link to the netCDF file on the Deltares
% network if it is available. This is faster than accessing data over the
% internet. 

url = jarkus_url;

%% Interacting with a netCDF file
% To let matlab talk with a netCDF file, the snc toolbox has been
% developed. See what is in there:

help snctools

%%
% Important functions are nc_varget and nc_dump

help nc_dump   
%% 

help nc_varget

%% View metadata
% We can get data from this file using the function nc_varget. But first, let's see what
% is in the file using nc_dump. nc_dump shows all the metadata in the file.
% In the case of the JarKus file this is a lot.

nc_dump(url)

%% 
% From the metadata we can see that there is a field 'id'. To get this
% data, use nc_varget.

id = nc_varget(url,'id');

%%
% Now id contains the id's:

id(1:10)

%% Zero based indexing
%
% TODO

%% Stride
%
% TODO

%% netCDF viewers
%
% TODO

##### SOURCE END #####
-->
   </body>
</html>