
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>Extracting JarKus data from netCDF (2)</title>
      <meta name="generator" content="MATLAB 7.10">
      <meta name="date" content="2010-06-22">
      <meta name="m-file" content="jarkus_tutorial_reading_data_2">
      <link type="text/css" href="script/css/jquery-ui-1.7.2.custom.css" rel="stylesheet">
      <link type="text/css" href="script/css/jquery.collapsible.css" rel="stylesheet"><script type="text/javascript" src="script/js/jquery-1.3.2.min.js"></script><script type="text/javascript" src="script/js/jquery-ui-1.7.2.custom.min.js"></script><script type="text/javascript" src="script/js/matlab2collapsible.js"></script><script type="text/javascript" src="script/js/jquery.collapsible.js"></script><script type="text/javascript" src="script/js/matlabhelp.js"></script><script src="http://www.google.com/jsapi?key=ABQIAAAA9KO06BPsmsvzw4PogoawhRRxYg1slSMvxuda9W0Kolc-SbeLlhQGHwE9W-XlCfe8WtZh74R56zOChQ"></script><script type="text/javascript" src="script/js/googleEarthApi.js"></script><script type="text/javascript">
    $(document).ready(function ()
      {
        // Copy content
	copycontent();

	// validate href of links to matlab tutorials
	matlabpreparehelprefs();

  	// Accordion
  	collapsible($(".collapsible"));
	
	// googleearth($(".geapi"));
	currentGeApiDiv = $(".geapi");	
      });
    </script><link type="text/css" href="script/css/matlabcode.css" rel="stylesheet">
   </head>
   <body LINK="#48339F" VLINK="#48339F" ALINK="#48339F">
      <div class="content">
         <div class="introduction ui-widget ui-widget-content ui-corner-all">
            <h1>Extracting JarKus data from netCDF (2)</h1>
            <div>
               <p>another example reading JarKus data</p>
            </div>
            <h2>Contents</h2>
            <div>
               <ul>
                  <li><a href="#1">url of netCDF file with jarkus data</a></li>
                  <li><a href="#2">transect info</a></li>
                  <li><a href="#3">retrieve info about dimensions and variable names</a></li>
                  <li><a href="#4">derive the identifier of the parameter 'altitude'</a></li>
                  <li><a href="#5">locate the relevant positions along the dimensions</a></li>
                  <li><a href="#6">retrieve the transect data</a></li>
                  <li><a href="#7">plot the transect</a></li>
               </ul>
            </div>
         </div>
         <div class="collapsible">
            <div>
               <h2><a name="1">url of netCDF file with jarkus data</a></h2>
               <div><pre class="codeinput">url = jarkus_url
</pre><pre class="codeoutput">
url =

p:\mcdata\opendap\rijkswaterstaat\jarkus\profiles\transect.nc

</pre></div>
            </div>
            <div>
               <h2><a name="2">transect info</a></h2>
               <div><pre class="codeinput">year     = 2006;            <span class="comment">% year of sounding</span>
kustvak  = <span class="string">'Noord-Holland'</span>; <span class="comment">% area name</span>
transect = 3000;            <span class="comment">% alongshore coordinate</span>
</pre></div>
            </div>
            <div>
               <h2><a name="3">retrieve info about dimensions and variable names</a></h2>
               <div><pre class="codeinput">info = nc_info(url);
</pre></div>
            </div>
            <div>
               <h2><a name="4">derive the identifier of the parameter 'altitude'</a></h2>
               <div><pre class="codeinput">altitude_id = strcmp({info.Dataset.Name}, <span class="string">'altitude'</span>);
</pre></div>
            </div>
            <div>
               <h2><a name="5">locate the relevant positions along the dimensions</a></h2>
               <div><pre class="codeinput">id.time        = (1970 + floor(nc_varget(url, <span class="string">'time'</span>)/365)) == year;
id.alongshore  = nc_varget(url, <span class="string">'areacode'</span>  ) == rws_kustvak(kustvak) &amp;<span class="keyword">...</span>
                 nc_varget(url, <span class="string">'alongshore'</span>) == transect;
id.cross_shore = true(size(nc_varget(url, <span class="string">'cross_shore'</span>)));
</pre></div>
            </div>
            <div>
               <h2><a name="6">retrieve the transect data</a></h2>
               <div><pre>remove 1 from start indices because netCDF is 0-based while matlab is 1-based.
OETSETTINGS be default selects the netCDF java library the removed substitus NaN for missing values (e.g. -9999)</pre><pre class="codeinput">x              = nc_varget(url, <span class="string">'cross_shore'</span>);
start_altitude = [find(id.time       , 1,<span class="string">'first'</span>) <span class="keyword">...</span>
                  find(id.alongshore , 1,<span class="string">'first'</span>) <span class="keyword">...</span>
                  find(id.cross_shore, 1,<span class="string">'first'</span>)] - 1;
count_altitude = [ sum(id.time       )<span class="keyword">...</span>
                   sum(id.alongshore )<span class="keyword">...</span>
                   sum(id.cross_shore)];
z              = nc_varget(url, <span class="string">'altitude'</span>, start_altitude, count_altitude);
</pre></div>
            </div>
            <div>
               <h2><a name="7">plot the transect</a></h2>
               <div><pre class="codeinput">figure
plot  (x, z);
xlim  ([-400 1800]);
xlabel(<span class="string">'crossshore [km]'</span>)
ylabel(<span class="string">'z [m]'</span>)
title ([kustvak <span class="string">' raai '</span> num2str(transect) <span class="string">' in '</span> num2str(year)])
grid   <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="jarkus_tutorial_reading_data_2_01.png" relsrc="jarkus_tutorial_reading_data_2_01.png"> </div>
            </div>
         </div>
         <p class="footer"><br>
            this tutorial is based on: <a class="matlabhref" href="matlab:edit('jarkus_tutorial_reading_data_2');" browserhref="http://crucible.delftgeosystems.nl/browse/~raw,r=2703/OpenEarthTools/trunk/matlab/applications/Rijkswaterstaat/jarkus/jarkus_tutorial_reading_data_2.m">jarkus_tutorial_reading_data_2.m (revision: 2703)</a><br>
Published with MATLAB&reg; 7.10<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Extracting JarKus data from netCDF (2)
% another example reading JarKus data

%% url of netCDF file with jarkus data

url = jarkus_url

%% transect info

year     = 2006;            % year of sounding
kustvak  = 'Noord-Holland'; % area name
transect = 3000;            % alongshore coordinate

%% retrieve info about dimensions and variable names

info = nc_info(url);

%% derive the identifier of the parameter 'altitude'

altitude_id = strcmp({info.Dataset.Name}, 'altitude');

%% locate the relevant positions along the dimensions

id.time        = (1970 + floor(nc_varget(url, 'time')/365)) == year;
id.alongshore  = nc_varget(url, 'areacode'  ) == rws_kustvak(kustvak) &...
                 nc_varget(url, 'alongshore') == transect;
id.cross_shore = true(size(nc_varget(url, 'cross_shore')));

%% retrieve the transect data
%  remove 1 from start indices because netCDF is 0-based while matlab is 1-based.
%  OETSETTINGS be default selects the netCDF java library the removed substitus NaN for missing values (e.g. -9999)

x              = nc_varget(url, 'cross_shore');
start_altitude = [find(id.time       , 1,'first') ...
                  find(id.alongshore , 1,'first') ...
                  find(id.cross_shore, 1,'first')] - 1;
count_altitude = [ sum(id.time       )...
                   sum(id.alongshore )...
                   sum(id.cross_shore)];
z              = nc_varget(url, 'altitude', start_altitude, count_altitude);

%% plot the transect

figure
plot  (x, z);
xlim  ([-400 1800]);
xlabel('crossshore [km]')
ylabel('z [m]')
title ([kustvak ' raai ' num2str(transect) ' in ' num2str(year)])
grid   on

##### SOURCE END #####
-->
   </body>
</html>