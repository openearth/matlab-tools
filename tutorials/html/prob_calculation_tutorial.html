
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>setting up a probabilistic calculation</title>
      <meta name="generator" content="MATLAB 7.6">
      <meta name="date" content="2009-12-21">
      <meta name="m-file" content="prob_calculation_tutorial">
      <link type="text/css" href="script/css/jquery-ui-1.7.2.custom.css" rel="stylesheet">
      <link type="text/css" href="script/css/jquery.collapsible.css" rel="stylesheet"><script type="text/javascript" src="script/js/jquery-1.3.2.min.js"></script><script type="text/javascript" src="script/js/jquery-ui-1.7.2.custom.min.js"></script><script type="text/javascript" src="script/js/matlab2collapsible.js"></script><script type="text/javascript" src="script/js/jquery.collapsible.js"></script><script type="text/javascript" src="script/js/matlabhelp.js"></script><script src="http://www.google.com/jsapi?key=ABQIAAAA9KO06BPsmsvzw4PogoawhRRxYg1slSMvxuda9W0Kolc-SbeLlhQGHwE9W-XlCfe8WtZh74R56zOChQ"></script><script type="text/javascript" src="script/js/googleEarthApi.js"></script><script type="text/javascript">
    $(document).ready(function ()
      {
        // Copy content
	copycontent();

	// validate href of links to matlab tutorials
	matlabpreparehelprefs();

  	// Accordion
  	collapsible($(".collapsible"));
	
	// googleearth($(".geapi"));
	currentGeApiDiv = $(".geapi");	
      });
    </script><link type="text/css" href="script/css/matlabcode.css" rel="stylesheet">
   </head>
   <body LINK="#48339F" VLINK="#48339F" ALINK="#48339F">
      <div class="content">
         <div class="introduction ui-widget ui-widget-content ui-corner-all">
            <h1>setting up a probabilistic calculation</h1>
            <div>
               <p>This is a script with a tutorial on setting up a probabilistic calculation. The script assumes that oetsettings has been run!</p>
            </div>
            <h2>Contents</h2>
            <div>
               <ul>
                  <li><a href="#1">create a new function to define the stochastic variables</a></li>
                  <li><a href="#2">define the "stochast"-variable</a></li>
                  <li><a href="#5">create a new function to define the Z-function</a></li>
                  <li><a href="#6">define the limit state function (Z-function)</a></li>
                  <li><a href="#7">run the calculation with FORM</a></li>
                  <li><a href="#8">get a summary of the calculations results</a></li>
                  <li><a href="#9">plot the calculation development</a></li>
                  <li><a href="#10">run the calculation with Monte Carlo</a></li>
                  <li><a href="#11">plot the calculation results</a></li>
               </ul>
            </div>
         </div>
         <div class="collapsible">
            <div>
               <h2><a name="1">create a new function to define the stochastic variables</a></h2>
               <div><pre class="codeinput">oetnewfun(<span class="string">'prob_example1_stochast'</span>,<span class="keyword">...</span>
    <span class="string">'output'</span>, <span class="string">'stochast'</span>)
</pre></div>
            </div>
            <div>
               <h2><a name="2">define the "stochast"-variable</a></h2>
               <div>
                  <p>Define the stochastic variables within the newly created function. Create a structure with the fields 'Name', 'Distr' and
                     'Params'. Each stochastic variable must have a name, a distribution and parameters. The distribution functions should have
                     as first input argument the P (probability), the second and possibly following input arguments are the parameters which have
                     to be specified in "Params" (in the right order). The number of stochastic variables can be chosen depending on the system
                     to solve. The definition of the stochast variable can be customised as long as the general structure is preserved. The following
                     lines are optional; these lines allow the user to set (temporary) one or more variables to deterministic without editting
                     in the function itself.
                  </p><pre class="codeinput">stochast = struct(<span class="keyword">...</span>
    <span class="string">'Name'</span>, {
        <span class="string">'R'</span><span class="keyword">...</span><span class="comment"> % example stochastic variable "R" (Resistance or Strength)</span>
        <span class="string">'S'</span><span class="keyword">...</span><span class="comment"> % example stochastic variable "S" (Solicitation or Load)</span>
        },<span class="keyword">...</span>
    <span class="string">'Distr'</span>, {
        @norm_inv<span class="keyword">...</span><span class="comment"> % distribution function (of R)</span>
        @norm_inv<span class="keyword">...</span><span class="comment"> % distribution function (of S)</span>
        },<span class="keyword">...</span>
    <span class="string">'Params'</span>, {
        {8 1}<span class="keyword">...</span><span class="comment"> % mu and sigma (of R)</span>
        {6 1}<span class="keyword">...</span><span class="comment"> % mu and sigma (of S)</span>
</pre></div>
            </div>
            <div>
               <div><pre class="codeinput">        } <span class="keyword">...</span>
    );
</pre></div>
            </div>
            <div>
               <div><pre class="codeinput">OPT = struct(<span class="keyword">...</span>
    <span class="string">'active'</span>, true(size(stochast)));

OPT = setProperty(OPT, varargin{:});

<span class="keyword">for</span> i = find(~OPT.active)
    stochast(i).Distr = @deterministic;
<span class="keyword">end</span>
</pre></div>
            </div>
            <div>
               <h2><a name="5">create a new function to define the Z-function</a></h2>
               <div>
                  <p>The input and output variables as specified here must be used.</p><pre class="codeinput">oetnewfun(<span class="string">'prob_example1_x2z'</span>,<span class="keyword">...</span>
    <span class="string">'output'</span>, <span class="string">'z'</span>,<span class="keyword">...</span>
    <span class="string">'input'</span>, {<span class="string">'samples'</span> <span class="string">'Resistance'</span> <span class="string">'varargin'</span>})
</pre></div>
            </div>
            <div>
               <h2><a name="6">define the limit state function (Z-function)</a></h2>
               <div>
                  <p>Define the Z-function in the newly created function. Z must be calculated. This part can be customised, as long as the output
                     "z" is a column vector with the same number of rows as samples.R (or of samples.S, which is the same). In this example, z
                     is easily calculated in one line of code. However, many alternatives are possible. Other functions can be called, or even
                     external programs. Note that in some cases a loop is required to calculate all instances separately.
                  </p><pre class="codeinput"><span class="comment">% calculate z (in this case: Z = R - S)</span>
z = samples.R - samples.S;
</pre></div>
            </div>
            <div>
               <h2><a name="7">run the calculation with FORM</a></h2>
               <div>
                  <p>After saving both the stochast-function and the x2z-function, the model is ready to run. When calling the FORM routine, it
                     is essential that both the stochast and the x2z-funtion are parsed.
                  </p><pre class="codeinput">FORMres = FORM(prob_example1_stochast,<span class="keyword">...</span>
    <span class="string">'x2zFunction'</span>, @prob_example1_x2z);
</pre></div>
            </div>
            <div>
               <h2><a name="8">get a summary of the calculations results</a></h2>
               <div><pre class="codeinput">displayFORMresult(FORMres)
</pre></div>
            </div>
            <div>
               <h2><a name="9">plot the calculation development</a></h2>
               <div><pre class="codeinput">plotFORMresult(FORMres)
</pre></div>
            </div>
            <div>
               <h2><a name="10">run the calculation with Monte Carlo</a></h2>
               <div>
                  <p>A similar calculation can be easily carried out with the Monte Carlo method as well.</p><pre class="codeinput">MCres = MC(prob_example1_stochast,<span class="keyword">...</span>
    <span class="string">'x2zFunction'</span>, @prob_example1_x2z,<span class="keyword">...</span>
    <span class="string">'NrSamples'</span>, 1000);
</pre></div>
            </div>
            <div>
               <h2><a name="11">plot the calculation results</a></h2>
               <div><pre class="codeinput">plotMCResult(MCres,<span class="keyword">...</span><span class="comment">)</span>
</pre></div>
            </div>
         </div>
         <p class="footer"><br>
            this tutorial is based on: <a class="matlabhref" href="matlab:edit('prob_calculation_tutorial');" browserhref="http://crucible.delftgeosystems.nl/browse/~raw,r=2096/OpenEarthTools/trunk/matlab/applications/probabilistic/prob_calculation_tutorial.m">prob_calculation_tutorial.m (revision: 2096)</a><br>
Published with MATLAB&reg; 7.6<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% setting up a probabilistic calculation
% This is a script with a tutorial on setting up a probabilistic calculation. The script assumes that oetsettings has been run!

%% create a new function to define the stochastic variables
oetnewfun('prob_example1_stochast',...
    'output', 'stochast')

%% define the "stochast"-variable
% Define the stochastic variables within the newly created function.
% Create a structure with the fields 'Name', 'Distr' and 'Params'. Each
% stochastic variable must have a name, a distribution and parameters. The
% distribution functions should have as first input argument the P
% (probability), the second and possibly following input arguments are the
% parameters which have to be specified in "Params" (in the right order).
% The number of stochastic variables can be chosen depending on the system
% to solve. The definition of the stochast variable can be customised as
% long as the general structure is preserved. The following lines are
% optional; these lines allow the user to set (temporary) one or more 
% variables to deterministic without editting in the function itself.

stochast = struct(...
    'Name', {
        'R'... % example stochastic variable "R" (Resistance or Strength)
        'S'... % example stochastic variable "S" (Solicitation or Load)
        },...
    'Distr', {
        @norm_inv... % distribution function (of R)
        @norm_inv... % distribution function (of S)
        },...
    'Params', {
        {8 1}... % mu and sigma (of R)
        {6 1}... % mu and sigma (of S)
        } ...
    );

%%
OPT = struct(...
    'active', true(size(stochast)));

OPT = setProperty(OPT, varargin{:});

for i = find(~OPT.active)
    stochast(i).Distr = @deterministic;
end

%% create a new function to define the Z-function
% The input and output variables as specified here must be used.
oetnewfun('prob_example1_x2z',...
    'output', 'z',...
    'input', {'samples' 'Resistance' 'varargin'})

%% define the limit state function (Z-function)
% Define the Z-function in the newly created function. Z must be calculated. 
% This part can be customised, as long as the output "z" is a column vector 
% with the same number of rows as samples.R (or of samples.S, which is the 
% same). In this example, z is easily calculated in one line of code. 
% However, many alternatives are possible. Other functions can be called, 
% or even external programs. Note that in some cases a loop is required to 
% calculate all instances separately.

% calculate z (in this case: Z = R - S)
z = samples.R - samples.S;

%% run the calculation with FORM
% After saving both the stochast-function and the x2z-function, the model
% is ready to run. When calling the FORM routine, it is essential that both
% the stochast and the x2z-funtion are parsed.

FORMres = FORM(prob_example1_stochast,...
    'x2zFunction', @prob_example1_x2z);

%% get a summary of the calculations results
displayFORMresult(FORMres)

%% plot the calculation development
plotFORMresult(FORMres)

%% run the calculation with Monte Carlo
% A similar calculation can be easily carried out with the Monte Carlo
% method as well.

MCres = MC(prob_example1_stochast,...
    'x2zFunction', @prob_example1_x2z,...
    'NrSamples', 1000);

%% plot the calculation results
plotMCResult(MCres,...)
    'space', 'x');
##### SOURCE END #####
-->
   </body>
</html>