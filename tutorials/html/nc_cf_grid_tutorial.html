
<!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
-->
<title>nc_cf_grid_tutorial</title>
<meta name="generator" content="MATLAB 7.7">
<meta name="date" content="2010-07-01">
<meta name="m-file" content="nc_cf_grid_tutorial">
<link type="text/css" href="script/css/jquery-ui-1.7.2.custom.css" rel="stylesheet">
<link type="text/css" href="script/css/jquery.collapsible.css" rel="stylesheet"><script type="text/javascript" src="script/js/jquery-1.3.2.min.js"></script><script type="text/javascript" src="script/js/jquery-ui-1.7.2.custom.min.js"></script><script type="text/javascript" src="script/js/matlab2collapsible.js"></script><script type="text/javascript" src="script/js/jquery.collapsible.js"></script><script type="text/javascript" src="script/js/matlabhelp.js"></script><script src="http://www.google.com/jsapi?key=ABQIAAAA9KO06BPsmsvzw4PogoawhRRxYg1slSMvxuda9W0Kolc-SbeLlhQGHwE9W-XlCfe8WtZh74R56zOChQ"></script><script type="text/javascript" src="script/js/googleEarthApi.js"></script><script type="text/javascript">
$(document).ready(function ()
{
// Copy content
copycontent();

// validate href of links to matlab tutorials
matlabpreparehelprefs();

// Accordion
collapsible($(".collapsible"));

// googleearth($(".geapi"));
currentGeApiDiv = $(".geapi");	
});
</script><link type="text/css" href="script/css/matlabcode.css" rel="stylesheet">
</head>
<body LINK="#48339F" VLINK="#48339F" ALINK="#48339F">
<div class="content">
<h2>Contents</h2>
<div>
<ul>
<li><a href="#1">NC_CF_GRID_TUTORIAL  how to read and subset a netCDF grid file</a></li>
<li><a href="#2">subset orthogonal Smith &amp; Sandwell worldbathymetric data for DCSM region</a></li>
<li><a href="#3">get full coordinate sticks</a></li>
<li><a href="#4">Determine indices of subset based on the the subregion you want</a></li>
<li><a href="#5">get subset</a></li>
<li><a href="#6">plot</a></li>
</ul>
</div>
<div class="collapsible">
<div>
<h2><a name="1">NC_CF_GRID_TUTORIAL  how to read and subset a netCDF grid file</a></h2>
<div><pre class="codeinput"><span class="comment">%See also: SNCTOOLS, NC_CF_GRID,...</span>
<span class="comment">%          NC_CF_STATIONTIMESERIES_TUTORIAL,...</span>
<span class="comment">%          NC_CF_GRID_WRITE_LAT_LON_ORTHOGONAL_TUTORIAL,</span>
<span class="comment">%          NC_CF_GRID_WRITE_LAT_LON_CURVILINEAR_TUTORIAL,</span>
<span class="comment">%          NC_CF_GRID_WRITE_X_Y_ORTHOGONAL_TUTORIAL</span>
<span class="comment">%          NC_CF_GRID_WRITE_X_Y_CURVILINEAR_TUTORIAL</span>
</pre></div>
</div>
<div>
<h2><a name="2">subset orthogonal Smith &amp; Sandwell worldbathymetric data for DCSM region</a></h2>
<div><pre>The full grid is way too large too handle.</pre><pre class="codeinput">   D.url     = <span class="string">'http://coast-enviro.er.usgs.gov/thredds/dodsC/bathy/smith_sandwell_v11'</span>;
nc_dump(D.url)
</pre><pre class="codeoutput">URL http://coast-enviro.er.usgs.gov/thredds/dodsC/bathy/smith_sandwell_v11 { 

dimensions:
lon = 21600 ;
lat = 17280 ;


variables:
// Preference 'PRESERVE_FVD':  false,
// dimensions consistent with ncBrowse, not with native MATLAB netcdf package.
single lon(lon), shape = [21600]
lon:long_name = "Uniformly spaced longitudes (-179.9917E - 179.9917E.01667E)" 
lon:units = "degrees_east" 
single lat(lat), shape = [17280]
lat:long_name = "Mercator spaced latitudes (80.738N - 80.738S)" 
...</pre></div>
</div>
<div>
<h2><a name="3">get full coordinate sticks</a></h2>
<div><pre class="codeinput">   D.lon         = nc_varget (D.url,<span class="string">'lon'</span>); <span class="comment">% -180 ... 180</span>
D.lat         = nc_varget (D.url,<span class="string">'lat'</span>); <span class="comment">%   90 ... -90</span>
</pre></div>
</div>
<div>
<h2><a name="4">Determine indices of subset based on the the subregion you want</a></h2>
<div><pre class="codeinput">   OPT.lon       = [-4 10];
OPT.lat       = [48 58];

ind.lon       = find(D.lon &gt; OPT.lon(1) &amp; D.lon &lt; OPT.lon(2) | D.lon &gt; OPT.lon(1)+360 &amp; D.lon &lt; OPT.lon(2)+360)
ind.lat       = find(D.lat &gt; OPT.lat(1) &amp; D.lat &lt; OPT.lat(2))
</pre><pre class="codeoutput">
ind = 

lon: [840x1 double]


ind = 

lon: [840x1 double]
lat: [1003x1 double]

</pre></div>
</div>
<div>
<h2><a name="5">get subset</a></h2>
<div><pre>note: nc_varget is zero-based</pre><pre class="codeinput">   D.lon         = D.lon(ind.lon);
D.lat         = D.lat(ind.lat);
start         = [ind.lat(1)-1 ind.lon(1)-1]; <span class="comment">% use -1 to get from 1-based Matlab to 0-based netCDF index !!</span>
count         = [length(ind.lat) length(ind.lon)];
D.z           = nc_varget(D.url,<span class="string">'topo'</span> ,start,count);
M.z.units     = nc_attget(D.url,<span class="string">'topo'</span>,<span class="string">'units'</span>);
M.z.long_name = nc_attget(D.url,<span class="string">'topo'</span>,<span class="string">'long_name'</span>);
</pre></div>
</div>
<div>
<h2><a name="6">plot</a></h2>
<div><pre class="codeinput">   pcolorcorcen(D.lon,D.lat,D.z);
tickmap(<span class="string">'ll'</span>)
grid <span class="string">on</span>
axislat
caxis([-100 100])
colorbarwithvtext([M.z.long_name,<span class="string">' ['</span>,M.z.units,<span class="string">']'</span>])
print(<span class="string">'-dpng'</span>,[<span class="string">'smith_sandwell_v11_lat_'</span>,nums2str(OPT.lat(:)'),<span class="string">'_lon_'</span>,nums2str(OPT.lon(:)')])
</pre><img vspace="5" hspace="5" src="nc_cf_grid_tutorial_01.png" relsrc="nc_cf_grid_tutorial_01.png"> </div>
</div>
</div>
<p class="footer"><br>
this tutorial is based on: <a class="matlabhref" href="matlab:edit('nc_cf_grid_tutorial');" browserhref="http://crucible.delftgeosystems.nl/browse/~raw,r=NaN/OpenEarthTools/trunk/matlab/io/netcdf/nctools/nc_cf_grid_tutorial.m">nc_cf_grid_tutorial.m (revision: NaN)</a><br>
Published with MATLAB&reg; 7.7<br></p>
</div>
<!--
##### SOURCE BEGIN #####
%% NC_CF_GRID_TUTORIAL  how to read and subset a netCDF grid file
%
%See also: SNCTOOLS, NC_CF_GRID,...
%          NC_CF_STATIONTIMESERIES_TUTORIAL,...
%          NC_CF_GRID_WRITE_LAT_LON_ORTHOGONAL_TUTORIAL, 
%          NC_CF_GRID_WRITE_LAT_LON_CURVILINEAR_TUTORIAL, 
%          NC_CF_GRID_WRITE_X_Y_ORTHOGONAL_TUTORIAL
%          NC_CF_GRID_WRITE_X_Y_CURVILINEAR_TUTORIAL

%% subset orthogonal Smith & Sandwell worldbathymetric data for DCSM region
%  The full grid is way too large too handle.

D.url     = 'http://coast-enviro.er.usgs.gov/thredds/dodsC/bathy/smith_sandwell_v11';
nc_dump(D.url)

%% get full coordinate sticks 

D.lon         = nc_varget (D.url,'lon'); % -180 ... 180
D.lat         = nc_varget (D.url,'lat'); %   90 ... -90

%% Determine indices of subset based on the the subregion you want 

OPT.lon       = [-4 10];
OPT.lat       = [48 58];

ind.lon       = find(D.lon > OPT.lon(1) & D.lon < OPT.lon(2) | D.lon > OPT.lon(1)+360 & D.lon < OPT.lon(2)+360)
ind.lat       = find(D.lat > OPT.lat(1) & D.lat < OPT.lat(2))

%% get subset
%  note: nc_varget is zero-based

D.lon         = D.lon(ind.lon);
D.lat         = D.lat(ind.lat);
start         = [ind.lat(1)-1 ind.lon(1)-1]; % use -1 to get from 1-based Matlab to 0-based netCDF index !!
count         = [length(ind.lat) length(ind.lon)];
D.z           = nc_varget(D.url,'topo' ,start,count);
M.z.units     = nc_attget(D.url,'topo','units');
M.z.long_name = nc_attget(D.url,'topo','long_name');

%% plot

pcolorcorcen(D.lon,D.lat,D.z);
tickmap('ll')
grid on
axislat   
caxis([-100 100])
colorbarwithvtext([M.z.long_name,' [',M.z.units,']'])
print('-dpng',['smith_sandwell_v11_lat_',nums2str(OPT.lat(:)'),'_lon_',nums2str(OPT.lon(:)')])

##### SOURCE END #####
-->
</body>
</html>
