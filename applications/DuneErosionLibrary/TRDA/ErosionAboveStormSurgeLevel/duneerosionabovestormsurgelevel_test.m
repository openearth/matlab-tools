function testResult = duneerosionabovestormsurgelevel_test()
% DUNEEROSIONABOVESTORMSURGELEVEL_TEST  Unit test for duneerosionabovestormsurgelevel
%  
% This function describes a unit test for duneerosionabovestormsurgelevel.
%
%
%   See also duneerosionabovestormsurgelevel

%% Copyright notice
%   --------------------------------------------------------------------
%   Copyright (C) 2009 Deltares
%       Pieter van Geer
%
%       pieter.vangeer@deltares.nl	
%
%       Rotterdamseweg 185
%       2629 HD Delft
%       P.O. 177
%       2600 MH Delft
%
%   This library is free software: you can redistribute it and/or
%   modify it under the terms of the GNU Lesser General Public
%   License as published by the Free Software Foundation, either
%   version 2.1 of the License, or (at your option) any later version.
%
%   This library is distributed in the hope that it will be useful,
%   but WITHOUT ANY WARRANTY; without even the implied warranty of
%   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
%   Lesser General Public License for more details.
%
%   You should have received a copy of the GNU Lesser General Public
%   License along with this library. If not, see <http://www.gnu.org/licenses/>.
%   --------------------------------------------------------------------

% This tools is part of <a href="http://OpenEarth.Deltares.nl">OpenEarthTools</a>.
% OpenEarthTools is an online collaboration to share and manage data and 
% programming tools in an open source, version controlled environment.
% Sign up to recieve regular updates of this function, and to contribute 
% your own tools.

%% Version <http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.keywords.html>
% Created: 19 Nov 2009
% Created with Matlab version: 7.9.0.529 (R2009b)

% $Id$
% $Date$
% $Author$
% $Revision$
% $HeadURL$
% $Keywords: $

%% $Description (Name = dune erosion above storm surge level (A Volume) unit test & IncludeCode = false & EvaluateCode = true)
% According to the TRDA additional erosion has to be accounted for. This additional dune erosion is
% calculated with the use of the amount of eroded sediment above storm surge level.
% duneerosionabovestormsurgelevel calculates the dune erosion above stom surge level given two
% profiles. The routine is tested with two cases:
%
% # A basic test which tests the principle of duneerosionabovestormsurgelevel
% # A test with a real erosion profile
% 


%% $RunCode

tempTestResult(1) = duneerosionabovestormsurgelevelbasic_test;
tempTestResult(2) = duneerosionabovestormsurgelevelprofile_test;
testResult = all(tempTestResult);

end

function testResult = duneerosionabovestormsurgelevelbasic_test()
%% $Description (Name = basic test)
% This testcase describes a basic test of the principle of the function
% duneerosionabovestormsurgelevel.

xPreStorm = [-100 100 110 300]
zPreStorm = [5 5 0 0]
xPostStorm = [-100 0 10 300]
zPostStorm = zPreStorm
waterLevel = 0

figure;
hold on
grid on
plot(xPreStorm,zPreStorm,'Color','k','LineWidth',3,'DisplayName','Pre storm Profile');
plot(xPostStorm,zPostStorm,'Color','r','LineWidth',3,'DisplayName','Post storm Profile (shifted 100 meter)');
plot(xlim,ones(1,2)*waterLevel,'Color','b','DisplayName','maximum SSL');
ylim([-1 7]);
leg = legend('show');
set(leg,'Location','NorthWest');
xlabel('Cross-shore location [m]');
ylabel('Elevation [m]');

%%
% The figure above shows a post storm profile that is identical to the pre storm profile, but
% shifted landward 100 meters. The profile has a height of 5 meters above SSL. The amount of eroded
% sediement should therefore equal -100*5 = -500 m2.
close(gcf);

%% $RunCode
Result = duneerosionabovestormsurgelevel(...
    xPreStorm,...
    zPreStorm,...
    xPostStorm,...
    zPostStorm,...
    waterLevel);

testResult = Result.VTVinfo.AVolume == -500;

%% $PublishResult
plotduneerosion(Result,figure);
ylim([-1 7]);
xlim([-100 300]);
end

function testResult = duneerosionabovestormsurgelevelprofile_test()
%% $Description
x = [-1185;-1180;-1175;-1170;-1165;-1160;-1155;-1150;-1145;-1140;-1135;-1130;-1125;-1120;-1115;-1110;-1105;-1100;-1095;-1090;-1085;-1080;-1075;-1070;-1065;-1060;-1055;-1050;-1045;-1040;-1035;-1030;-1025;-1020;-1015;-1010;-1005;-1000;-995;-990;-985;-980;-975;-970;-965;-960;-955;-950;-945;-940;-935;-930;-925;-920;-915;-910;-905;-900;-895;-890;-885;-880;-875;-870;-865;-860;-855;-850;-845;-840;-835;-830;-825;-820;-815;-810;-805;-800;-795;-790;-785;-780;-775;-770;-765;-760;-755;-750;-745;-740;-735;-730;-725;-720;-715;-710;-705;-700;-695;-690;-685;-680;-675;-670;-665;-660;-655;-650;-645;-640;-635;-630;-625;-620;-615;-610;-605;-600;-595;-590;-585;-580;-575;-570;-565;-560;-555;-550;-545;-540;-535;-530;-525;-520;-515;-510;-505;-500;-495;-490;-485;-480;-475;-470;-465;-460;-455;-450;-445;-440;-435;-430;-425;-420;-415;-410;-405;-400.875000000000;-400;-395;-390;-387.272727272727;-385;-383.214285714286;-380;-375;-372.592592592593;-370;-365;-360;-358.666666666667;-355;-350;-345;-340;-335;-330;-325;-320;-315;-310;-305;-300;-295;-290;-285.185185185185;-285;-280;-275;-270;-265;-260;-259.130434782609;-255;-250;-245;-240;-235;-230;-225;-220;-217.500000000000;-215;-214.730769230769;-210;-205;-200;-195;-190;-185;-180;-175;-170;-166.364792383512;-165;-160;-158.053108300856;-155;-150;-145;-140;-135;-130;-125;-120;-115;-110;-106.347517730496;-105;-100;-97.8472469657663;-95;-90;-85;-80;-75;-70;-65;-60;-55;-50;-45;-40;-35;-30;-25;-20;-15;-10;-5;0;5;10;15;20;25;30;35;40;45;50;55;60;65;70;70.0059398214282;75;80;85;90;95;100;105;110;115;120;125;130;135;140;145;150;155;160;165;167.025849938996;170;175;180;185;190;195;198.970202236842;200;205;210;215;220;225;230;235;240;242.107444015152;245;250;255;260;265;270;275;280;285;290;295;300;305;310;315;320;325;330;335;340;345;350;355;360;365;370;375;380;385;390;395;400;405;410;415;420;425;430;435;440;445;450;455;460;465;470;475;480;485;490;495;500;505;510;515;520;525;530;535;540;545;550;555;560;565;570;575;580;585;590;595;600;605;610;615;620;625;630;635;640;645;650;655;660;665;670;675;680;685;690;695;700;705;710;715;720;725;730;735;740;745;750;755;760;765;770;775;780;785;790;795;800;805;810;815;820;825;830;835;840;845;850;855;860;865;870;875;880;885;890;895;900;905;910;915;920;925;930;935;940;945;950;955;960;965;970;975;980;985;990;995;1000;1005;1010;1015;1020;1025;1030;1035;1040;1045;1050;1055;1060;1065;1070;1075;1080;1085;1090;1095;1100;1105;1110;1115;1120;1125;1130;1135;1140;1145;1150;1155;1160;1165;1170;1175;1180;1185;1190;1195;1200;1205;1210;1215;1220;1225;1230;1235;1240;1245;1250;1255;1260;1265;1270;1275;1280;1285;1290;1295;1300;1305;1310;1315;1320;1325;1330;1335;1340;1345;1350;1355;1360;1365;1370;1375;1380;1385;1390;1395;1400;1405;1410;1415;1420;1425;1430;1435;1440;1445;1450;1455;1460;1465;1470;1475;1480;1485;1490;1495;1500;1505;1510;1515;1520;1525;1530;1535;1540;1545;1550;1555;1560;1565;1570;1575;1580;1585;1590;1595;1600;];
z1 = [10;9;9.5;10;10.2778;10.556;10.833;11.111;11.39;11.6;11.94;12.22;12.5;13.125;13.75;14.375;15;15.83;16.67;17.5;17.7083;17.91667;18.125;18.33;18.541;18.750;18.9583;19.16;19.375;19.583;19.791;20;20.083;20.166;20.250;20.33;20.416;20.5;20.583;20.66;20.750;20.83;20.91;21;20.916;20.83;20.75;20.66;20.583;20.5;20.416;20.33;20.25;20.166;20.08;20;19.72;19.44;19.16;18.88;18.61;18.33;18.0555555555556;17.7777777777778;17.5000000000000;18;18.5000000000000;18;17.5000000000000;16.6666666666667;15.8333333333333;15;14.5000000000000;14;13.5000000000000;13;12.5000000000000;12.3076923076923;12.1153846153846;11.9230769230769;11.7307692307692;11.5384615384615;11.3461538461538;11.1538461538462;10.9615384615385;10.7692307692308;10.5769230769231;10.3846153846154;10.1923076923077;10;9.72222222222222;9.44444444444445;9.16666666666667;8.88888888888889;8.61111111111111;8.33333333333333;8.05555555555556;7.77777777777778;7.50000000000000;7.43900000000000;7.37800000000000;7.31700000000000;7.25600000000000;7.19500000000000;7.13400000000000;7.07300000000000;7.01200000000000;6.95100000000000;6.89000000000000;6.82900000000000;6.76800000000000;6.70700000000000;6.64600000000000;6.58500000000000;6.52400000000000;6.46300000000000;6.40200000000000;6.34100000000000;6.28000000000000;6.21900000000000;6.15800000000000;6.09700000000000;6.03600000000000;5.97500000000000;5.91400000000000;5.85300000000000;5.79200000000000;5.73100000000000;5.67000000000000;5.73000000000000;5.88000000000000;6.08000000000000;5.31000000000000;5.88000000000000;6.05000000000000;6.14000000000000;6.37000000000000;5.94000000000000;5.24000000000000;5.29000000000000;5.16000000000000;5.19000000000000;5.14000000000000;5.18000000000000;5.30000000000000;5.23000000000000;5.31000000000000;5.34000000000000;5.44000000000000;5.29000000000000;5.12000000000000;5.11000000000000;5.13000000000000;5.78000000000000;5;4.90000000000000;4.67000000000000;5;5.07000000000000;5.16000000000000;5.06000000000000;5;4.95000000000000;5;5.09000000000000;5.13000000000000;5;4.86000000000000;4.77000000000000;4.88000000000000;5;5.33000000000000;5.71000000000000;6.44000000000000;8;8.23000000000000;8.24000000000000;8.34000000000000;8.11000000000000;8.18000000000000;7.86000000000000;7.07000000000000;6.42000000000000;6.05000000000000;5.26000000000000;5;4.99000000000000;4.78000000000000;4.78000000000000;4.87000000000000;4.96000000000000;4.92000000000000;5;5.38000000000000;5.59000000000000;5.41000000000000;5.22000000000000;5.19000000000000;5.48000000000000;5.48000000000000;5.07000000000000;5;4.93000000000000;5;6.23000000000000;8.39000000000000;10.1100000000000;10.3900000000000;11.3200000000000;12.2500000000000;12.8000000000000;12.7100000000000;12.8900000000000;13.3116840800000;13.4700000000000;16.3000000000000;16.8022980583791;17.5900000000000;17.4400000000000;17.2000000000000;16.3600000000000;13.4000000000000;9.91000000000000;7.08000000000000;6.91000000000000;6.82000000000000;6.03000000000000;5;4.62000000000000;3.28000000000000;2.89250445000000;2.38000000000000;1.92000000000000;1.63000000000000;1.43000000000000;1.31000000000000;1.09000000000000;0.890000000000000;0.770000000000000;0.720000000000000;0.550000000000000;0.350000000000000;0.230000000000000;0.160000000000000;0.0800000000000000;-0.100000000000000;-0.120000000000000;-0.310000000000000;-0.400000000000000;-0.780000000000000;-0.950000000000000;-1.03500000000000;-1.12000000000000;-1.22000000000000;-1.32000000000000;-1.27500000000000;-1.23000000000000;-1.10500000000000;-0.980000000000000;-1.06500000000000;-1.15000000000000;-1.32500000000000;-1.50000000000000;-1.63500000000000;-1.77000000000000;-1.77033263000000;-2.05000000000000;-2.33000000000000;-2.56000000000000;-2.79000000000000;-2.98500000000000;-3.18000000000000;-3.22000000000000;-3.26000000000000;-3.34000000000000;-3.42000000000000;-3.51500000000000;-3.61000000000000;-3.59500000000000;-3.58000000000000;-3.64000000000000;-3.70000000000000;-3.76000000000000;-3.82000000000000;-3.96000000000000;-4.01672379829189;-4.10000000000000;-4.14500000000000;-4.19000000000000;-4.24000000000000;-4.29000000000000;-4.31000000000000;-4.32588081000000;-4.33000000000000;-4.30000000000000;-4.27000000000000;-4.25000000000000;-4.23000000000000;-4.11500000000000;-4;-3.87500000000000;-3.75000000000000;-3.64041291000000;-3.49000000000000;-3.23000000000000;-2.94000000000000;-2.65000000000000;-2.57500000000000;-2.50000000000000;-2.60500000000000;-2.71000000000000;-2.93500000000000;-3.16000000000000;-3.38500000000000;-3.61000000000000;-3.84000000000000;-4.07000000000000;-4.21000000000000;-4.35000000000000;-4.46000000000000;-4.57000000000000;-4.65500000000000;-4.74000000000000;-4.75000000000000;-4.76000000000000;-4.76000000000000;-4.76000000000000;-4.81500000000000;-4.87000000000000;-4.94500000000000;-5.02000000000000;-5.00500000000000;-4.99000000000000;-5.06000000000000;-5.13000000000000;-5.24500000000000;-5.36000000000000;-5.41500000000000;-5.47000000000000;-5.54000000000000;-5.61000000000000;-5.68000000000000;-5.75000000000000;-5.84000000000000;-5.93000000000000;-5.96000000000000;-5.99000000000000;-6.08500000000000;-6.18000000000000;-6.27000000000000;-6.36000000000000;-6.39000000000000;-6.42000000000000;-6.38000000000000;-6.34000000000000;-6.28500000000000;-6.23000000000000;-6.17500000000000;-6.12000000000000;-6.11000000000000;-6.10000000000000;-6.07000000000000;-6.04000000000000;-6.04500000000000;-6.05000000000000;-5.99000000000000;-5.93000000000000;-5.90000000000000;-5.87000000000000;-5.82000000000000;-5.77000000000000;-5.74500000000000;-5.72000000000000;-5.71500000000000;-5.71000000000000;-5.74500000000000;-5.78000000000000;-5.78500000000000;-5.79000000000000;-5.77000000000000;-5.75000000000000;-5.72000000000000;-5.69000000000000;-5.71500000000000;-5.74000000000000;-5.73500000000000;-5.73000000000000;-5.76000000000000;-5.79000000000000;-5.88500000000000;-5.98000000000000;-6.01000000000000;-6.04000000000000;-6.08500000000000;-6.13000000000000;-6.19500000000000;-6.26000000000000;-6.33500000000000;-6.41000000000000;-6.47500000000000;-6.54000000000000;-6.63000000000000;-6.72000000000000;-6.78500000000000;-6.85000000000000;-6.93500000000000;-7.02000000000000;-7.06500000000000;-7.11000000000000;-7.16000000000000;-7.21000000000000;-7.34500000000000;-7.48000000000000;-7.53500000000000;-7.59000000000000;-7.65000000000000;-7.71000000000000;-7.79000000000000;-7.87000000000000;-7.94500000000000;-8.02000000000000;-8.11000000000000;-8.20000000000000;-8.24000000000000;-8.28000000000000;-8.37500000000000;-8.47000000000000;-8.54500000000000;-8.62000000000000;-8.69500000000000;-8.77000000000000;-8.81500000000000;-8.86000000000000;-8.92000000000000;-8.98000000000000;-9.07000000000000;-9.16000000000000;-9.20000000000000;-9.24000000000000;-9.35500000000000;-9.47000000000000;-9.50500000000000;-9.54000000000000;-9.57500000000000;-9.61000000000000;-9.69000000000000;-9.77000000000000;-9.87500000000000;-9.98000000000000;-10.0200000000000;-10.0600000000000;-10.1050000000000;-10.1500000000000;-10.2200000000000;-10.2900000000000;-10.3400000000000;-10.3900000000000;-10.4500000000000;-10.5100000000000;-10.5850000000000;-10.6600000000000;-10.6950000000000;-10.7300000000000;-10.7850000000000;-10.8400000000000;-10.8950000000000;-10.9500000000000;-11.0100000000000;-11.0700000000000;-11.1300000000000;-11.1900000000000;-11.2050000000000;-11.2200000000000;-11.2750000000000;-11.3300000000000;-11.4050000000000;-11.4800000000000;-11.5050000000000;-11.5300000000000;-11.5700000000000;-11.6100000000000;-11.6500000000000;-11.6900000000000;-11.7450000000000;-11.8000000000000;-11.8500000000000;-11.9000000000000;-11.9200000000000;-11.9400000000000;-12.0150000000000;-12.0900000000000;-12.0950000000000;-12.1000000000000;-12.1450000000000;-12.1900000000000;-12.2200000000000;-12.2500000000000;-12.3150000000000;-12.3800000000000;-12.3850000000000;-12.3900000000000;-12.4250000000000;-12.4600000000000;-12.5300000000000;-12.6000000000000;-12.6000000000000;-12.6000000000000;-12.6450000000000;-12.6900000000000;-12.7350000000000;-12.7800000000000;-12.7800000000000;-12.7800000000000;-12.8250000000000;-12.8700000000000;-12.9250000000000;-12.9800000000000;-13;-13.0200000000000;-13.0300000000000;-13.0400000000000;-13.0900000000000;-13.1400000000000;-13.1450000000000;-13.1500000000000;-13.1800000000000;-13.2100000000000;-13.2050000000000;-13.2000000000000;-13.2950000000000;-13.3900000000000;-13.3300000000000;-13.2700000000000;-13.3500000000000;-13.4300000000000;-13.4500000000000;-13.4700000000000;-13.4600000000000;-13.4500000000000;-13.4850000000000;-13.5200000000000;-13.5550000000000;-13.5900000000000;-13.5750000000000;-13.5600000000000;-13.6250000000000;-13.6900000000000;-13.6750000000000;-13.6600000000000;-13.6450000000000;-13.6300000000000;-13.6950000000000;-13.7600000000000;-13.7750000000000;-13.7900000000000;-13.7800000000000;-13.7700000000000;-13.7800000000000;-13.7900000000000;-13.8650000000000;-13.9400000000000;-13.8800000000000;-13.8200000000000;-13.8650000000000;-13.9100000000000;-13.9400000000000;-13.9700000000000;-13.9600000000000;-13.9500000000000;-13.9850000000000;-14.0200000000000;-14.0300000000000;-14.0400000000000;-14.0100000000000;-13.9800000000000;];
z2 = [10;9;9.5;10;10.277;10.55;10.83;11.11;11.38;11.666;11.944;12.22;12.5;13.125;13.75;14.375;15;15.83;16.66;17.5;17.7083;17.916;18.125;18.3333333333333;18.5416666666667;18.7500000000000;18.9583333333333;19.1666666666667;19.3750000000000;19.5833333333333;19.7916666666667;20;20.0833333333333;20.1666666666667;20.2500000000000;20.3333333333333;20.4166666666667;20.5000000000000;20.5833333333333;20.6666666666667;20.7500000000000;20.8333333333333;20.9166666666667;21;20.9166666666667;20.8333333333333;20.7500000000000;20.6666666666667;20.5833333333333;20.5000000000000;20.4166666666667;20.3333333333333;20.2500000000000;20.1666666666667;20.0833333333333;20;19.7222222222222;19.4444444444444;19.1666666666667;18.8888888888889;18.6111111111111;18.3333333333333;18.0555555555556;17.7777777777778;17.5000000000000;18;18.5000000000000;18;17.5000000000000;16.6666666666667;15.8333333333333;15;14.5000000000000;14;13.5000000000000;13;12.5000000000000;12.3076923076923;12.1153846153846;11.9230769230769;11.7307692307692;11.5384615384615;11.3461538461538;11.1538461538462;10.9615384615385;10.7692307692308;10.5769230769231;10.3846153846154;10.1923076923077;10;9.72222222222222;9.44444444444445;9.16666666666667;8.88888888888889;8.61111111111111;8.33333333333333;8.05555555555556;7.77777777777778;7.50000000000000;7.43900000000000;7.37800000000000;7.31700000000000;7.25600000000000;7.19500000000000;7.13400000000000;7.07300000000000;7.01200000000000;6.95100000000000;6.89000000000000;6.82900000000000;6.76800000000000;6.70700000000000;6.64600000000000;6.58500000000000;6.52400000000000;6.46300000000000;6.40200000000000;6.34100000000000;6.28000000000000;6.21900000000000;6.15800000000000;6.09700000000000;6.03600000000000;5.97500000000000;5.91400000000000;5.85300000000000;5.79200000000000;5.73100000000000;5.67000000000000;5.73000000000000;5.88000000000000;6.08000000000000;5.31000000000000;5.88000000000000;6.05000000000000;6.14000000000000;6.37000000000000;5.94000000000000;5.24000000000000;5.29000000000000;5.16000000000000;5.19000000000000;5.14000000000000;5.18000000000000;5.30000000000000;5.23000000000000;5.31000000000000;5.34000000000000;5.44000000000000;5.29000000000000;5.12000000000000;5.11000000000000;5.13000000000000;5.78000000000000;5;4.90000000000000;4.67000000000000;5;5.07000000000000;5.16000000000000;5.06000000000000;5;4.95000000000000;5;5.09000000000000;5.13000000000000;5;4.86000000000000;4.77000000000000;4.88000000000000;5;5.33000000000000;5.71000000000000;6.44000000000000;8;8.23000000000000;8.24000000000000;8.34000000000000;8.11000000000000;8.18000000000000;7.86000000000000;7.07000000000000;6.42000000000000;6.05000000000000;5.26000000000000;5;4.99000000000000;4.78000000000000;4.78000000000000;4.87000000000000;4.96000000000000;4.92000000000000;5;5.38000000000000;5.59000000000000;5.41000000000000;5.22000000000000;5.19000000000000;5.48000000000000;5.48000000000000;5.07000000000000;5;4.93000000000000;5;6.23000000000000;8.39000000000000;10.1100000000000;10.3900000000000;11.3200000000000;12.2500000000000;12.8000000000000;12.7100000000000;12.8900000000000;13.3116840800000;11.9468916969237;6.94689169852151;5;4.85026289000000;4.62262237000000;4.41246106000000;4.21628084000000;4.03161481000000;3.85664609000000;3.68999062000000;3.53056524000000;3.37750339000000;3.23009893000000;3.12565619000000;3.08776736000000;2.95001842000000;2.89250445000000;2.81643606000000;2.68666360000000;2.56039255000000;2.43735390000000;2.31731145000000;2.20005641000000;2.08540318000000;1.97318589000000;1.86325557000000;1.75547784000000;1.64973101000000;1.54590441000000;1.44389708000000;1.34361663000000;1.24497820000000;1.14790369000000;1.05232097000000;0.958163330000000;0.865368860000000;0.773880020000000;0.683643190000000;0.594608340000000;0.506728680000000;0.419960380000000;0.334262310000000;0.249595830000000;0.165924550000000;0.0832141799999997;0.00143235999999991;-0.0794515100000002;-0.159466360000000;-0.238639610000000;-0.316997290000000;-0.394564080000000;-0.394655760000000;-0.471363460000000;-0.547417760000000;-0.622748270000000;-0.697375250000000;-0.771318070000000;-0.844595190000000;-0.917224280000000;-0.989222240000000;-1.06060524000000;-1.13138877000000;-1.20158768000000;-1.27121623000000;-1.34028810000000;-1.40881643000000;-1.47681385000000;-1.54429251000000;-1.61126411000000;-1.67773991000000;-1.74373076000000;-1.77033263000000;-2.00826463452395;-2.40826463392483;-2.80826463332571;-3.20826463272659;-3.60826463212747;-4.00826463152835;-4.32588081000000;-4.33000000000000;-4.30000000000000;-4.27000000000000;-4.25000000000000;-4.23000000000000;-4.11500000000000;-4;-3.87500000000000;-3.75000000000000;-3.64041291000000;-3.49000000000000;-3.23000000000000;-2.94000000000000;-2.65000000000000;-2.57500000000000;-2.50000000000000;-2.60500000000000;-2.71000000000000;-2.93500000000000;-3.16000000000000;-3.38500000000000;-3.61000000000000;-3.84000000000000;-4.07000000000000;-4.21000000000000;-4.35000000000000;-4.46000000000000;-4.57000000000000;-4.65500000000000;-4.74000000000000;-4.75000000000000;-4.76000000000000;-4.76000000000000;-4.76000000000000;-4.81500000000000;-4.87000000000000;-4.94500000000000;-5.02000000000000;-5.00500000000000;-4.99000000000000;-5.06000000000000;-5.13000000000000;-5.24500000000000;-5.36000000000000;-5.41500000000000;-5.47000000000000;-5.54000000000000;-5.61000000000000;-5.68000000000000;-5.75000000000000;-5.84000000000000;-5.93000000000000;-5.96000000000000;-5.99000000000000;-6.08500000000000;-6.18000000000000;-6.27000000000000;-6.36000000000000;-6.39000000000000;-6.42000000000000;-6.38000000000000;-6.34000000000000;-6.28500000000000;-6.23000000000000;-6.17500000000000;-6.12000000000000;-6.11000000000000;-6.10000000000000;-6.07000000000000;-6.04000000000000;-6.04500000000000;-6.05000000000000;-5.99000000000000;-5.93000000000000;-5.90000000000000;-5.87000000000000;-5.82000000000000;-5.77000000000000;-5.74500000000000;-5.72000000000000;-5.71500000000000;-5.71000000000000;-5.74500000000000;-5.78000000000000;-5.78500000000000;-5.79000000000000;-5.77000000000000;-5.75000000000000;-5.72000000000000;-5.69000000000000;-5.71500000000000;-5.74000000000000;-5.73500000000000;-5.73000000000000;-5.76000000000000;-5.79000000000000;-5.88500000000000;-5.98000000000000;-6.01000000000000;-6.04000000000000;-6.08500000000000;-6.13000000000000;-6.19500000000000;-6.26000000000000;-6.33500000000000;-6.41000000000000;-6.47500000000000;-6.54000000000000;-6.63000000000000;-6.72000000000000;-6.78500000000000;-6.85000000000000;-6.93500000000000;-7.02000000000000;-7.06500000000000;-7.11000000000000;-7.16000000000000;-7.21000000000000;-7.34500000000000;-7.48000000000000;-7.53500000000000;-7.59000000000000;-7.65000000000000;-7.71000000000000;-7.79000000000000;-7.87000000000000;-7.94500000000000;-8.02000000000000;-8.11000000000000;-8.20000000000000;-8.24000000000000;-8.28000000000000;-8.37500000000000;-8.47000000000000;-8.54500000000000;-8.62000000000000;-8.69500000000000;-8.77000000000000;-8.81500000000000;-8.86000000000000;-8.92000000000000;-8.98000000000000;-9.07000000000000;-9.16000000000000;-9.20000000000000;-9.24000000000000;-9.35500000000000;-9.47000000000000;-9.50500000000000;-9.54000000000000;-9.57500000000000;-9.61000000000000;-9.69000000000000;-9.77000000000000;-9.87500000000000;-9.98000000000000;-10.0200000000000;-10.0600000000000;-10.1050000000000;-10.1500000000000;-10.2200000000000;-10.2900000000000;-10.3400000000000;-10.3900000000000;-10.4500000000000;-10.5100000000000;-10.5850000000000;-10.6600000000000;-10.6950000000000;-10.7300000000000;-10.7850000000000;-10.8400000000000;-10.8950000000000;-10.9500000000000;-11.0100000000000;-11.0700000000000;-11.1300000000000;-11.1900000000000;-11.2050000000000;-11.2200000000000;-11.2750000000000;-11.3300000000000;-11.4050000000000;-11.4800000000000;-11.5050000000000;-11.5300000000000;-11.5700000000000;-11.6100000000000;-11.6500000000000;-11.6900000000000;-11.7450000000000;-11.8000000000000;-11.8500000000000;-11.9000000000000;-11.9200000000000;-11.9400000000000;-12.0150000000000;-12.0900000000000;-12.0950000000000;-12.1000000000000;-12.1450000000000;-12.1900000000000;-12.2200000000000;-12.2500000000000;-12.3150000000000;-12.3800000000000;-12.3850000000000;-12.3900000000000;-12.4250000000000;-12.4600000000000;-12.5300000000000;-12.6000000000000;-12.6000000000000;-12.6000000000000;-12.6450000000000;-12.6900000000000;-12.7350000000000;-12.7800000000000;-12.7800000000000;-12.7800000000000;-12.8250000000000;-12.8700000000000;-12.9250000000000;-12.9800000000000;-13;-13.0200000000000;-13.0300000000000;-13.0400000000000;-13.0900000000000;-13.1400000000000;-13.1450000000000;-13.1500000000000;-13.1800000000000;-13.2100000000000;-13.2050000000000;-13.2000000000000;-13.2950000000000;-13.3900000000000;-13.3300000000000;-13.2700000000000;-13.3500000000000;-13.4300000000000;-13.4500000000000;-13.4700000000000;-13.4600000000000;-13.4500000000000;-13.4850000000000;-13.5200000000000;-13.5550000000000;-13.5900000000000;-13.5750000000000;-13.5600000000000;-13.6250000000000;-13.6900000000000;-13.6750000000000;-13.6600000000000;-13.6450000000000;-13.6300000000000;-13.6950000000000;-13.7600000000000;-13.7750000000000;-13.7900000000000;-13.7800000000000;-13.7700000000000;-13.7800000000000;-13.7900000000000;-13.8650000000000;-13.9400000000000;-13.8800000000000;-13.8200000000000;-13.8650000000000;-13.9100000000000;-13.9400000000000;-13.9700000000000;-13.9600000000000;-13.9500000000000;-13.9850000000000;-14.0200000000000;-14.0300000000000;-14.0400000000000;-14.0100000000000;-13.9800000000000;];
WL = 5;

figure;
hold on
grid on
box on
plot(x,z2,'DisplayName','Post storm profile','Color','r','LineWidth',2);
plot(x,z1,'DisplayName','Pre storm profile','Color','k','LineWidth',2);
plot(xlim,[WL, WL],'b','DisplayName','Water level','LineWidth',1,'LineStyle','--');
legend show

%% $RunCode
try
    Result = duneerosionabovestormsurgelevel(x,z1,x,z2,WL);
    % The zActive and z2Active values differ...
    testResult = ~all(Result.zActive == Result.z2Active);
catch
    testResult = false;
end

%% $PublishResult
patch([Result.xActive; flipud(Result.xActive)],...
    [Result.zActive; flipud(Result.z2Active)],...
    'k',...
    'EdgeColor','none',...
    'FaceColor',[150 116 0]/255,...
    'DisplayName',['Erosion Volume above storm surge level (', num2str(Result.VTVinfo.AVolume), ' m3/m)']);
legend off
legend show
end