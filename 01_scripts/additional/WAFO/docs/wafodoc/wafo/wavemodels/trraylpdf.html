<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of trraylpdf</title>
  <meta name="keywords" content="trraylpdf">
  <meta name="description" content=" Calculates transformed Rayleigh approximation for amplitudes">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">wavemodels</a> &gt; trraylpdf.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\wavemodels&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>trraylpdf
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Calculates transformed Rayleigh approximation for amplitudes</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> f=trraylpdf(x,def,gn,utc) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="trraylpdf.html" class="code" title=" Calculates transformed Rayleigh approximation for amplitudes ">TRRAYLPDF</a> Calculates transformed Rayleigh approximation for amplitudes 
           
   CALL:  f = <a href="trraylpdf.html" class="code" title=" Calculates transformed Rayleigh approximation for amplitudes ">trraylpdf</a>(x,def,g,u); 
  
     f    = density structure of wave amplitude f(x); 
  
     x    = a row vector with x-values. 
     def  = 'Ac',    gives wave crest amplitude Ac (default). 
            'At',    gives wave trough amplitude At. 
            'AcAt',  gives wave <a href="../../wafo/wstats/range.html" class="code" title="  Calculates the difference between the maximum and minimum values. ">range</a> Ac+At 
     g    = [y g(y)] a two column matrix with the transformation  g(y). 
     u    = reference level (default the most frequently crossed level). 
  
  Example: 
   np =10000; dt = .2; method = 1 
   x1 = <a href="../../wafo/wsim/spec2nlsdat.html" class="code" title=" Simulates a Randomized 2nd order non-linear wave X(t)  ">spec2nlsdat</a>(<a href="../../wafo/spec/jonswap.html" class="code" title=" Calculates (and plots) a JONSWAP spectral density">jonswap</a>,np,dt); 
   [S, H,Ac,At] = <a href="../../wafo/onedim/dat2steep.html" class="code" title=" Extracts waveheights and steepnesses from data. ">dat2steep</a>(x1,4,method);  
   gnl = <a href="../../wafo/trgauss/dat2tr.html" class="code" title=" Estimate transformation, g, from data.">dat2tr</a>(x1,'nonlinear');   % nonlinear transformation 
   gl  = <a href="../../wafo/trgauss/dat2tr.html" class="code" title=" Estimate transformation, g, from data.">dat2tr</a>(x1,'linear');      % identity transformations   
   x   = linspace(0,8); 
   fnl = <a href="trraylpdf.html" class="code" title=" Calculates transformed Rayleigh approximation for amplitudes ">trraylpdf</a>(x,'ac',gnl,0);  % with transformation 
   fl  = <a href="trraylpdf.html" class="code" title=" Calculates transformed Rayleigh approximation for amplitudes ">trraylpdf</a>(x,'ac',gl,0);   % without transformation 
   <a href="../../wafo/wstats/empdistr.html" class="code" title=" Computes and plots the empirical CDF ">empdistr</a>(Ac), hold on 
   <a href="../../wafo/trgauss/pdfplot.html" class="code" title=" Plot contents of pdf structures">pdfplot</a>(fnl,11,'g'),  
   <a href="../../wafo/trgauss/pdfplot.html" class="code" title=" Plot contents of pdf structures">pdfplot</a>(fl,11,'r'),  hold off   
  
  See also  <a href="../../wafo/wstats/wraylpdf.html" class="code" title=" Rayleigh probability density function">wraylpdf</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/trgauss/createpdf.html" class="code" title=" f=createpdf(ndim)">createpdf</a></li></TD>
<TD> PDF class constructor</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/gaus2dat.html" class="code" title=" x = gaus2dat(xx,g)">gaus2dat</a></li></TD>
<TD> Transforms  xx  using the inverse of transformation  g.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/tranproc.html" class="code" title=" y = tranproc(x,ff)">tranproc</a></li></TD>
<TD> Transforms process X and up to four derivatives</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\polyfun\interp1.m">interp1</a></li></TD>
<TD>       1-D interpolation (table lookup)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\linspace.m">linspace</a></li></TD>
<TD>      Linearly spaced vector.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter3.html" class="code" title="This is a script file.">Chapter3</a></li></TD>
<TD> % CHAPTER3  Demonstrates distributions of wave characteristics</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> f=<a name="_sub0" href="#_subfunctions" class="code">trraylpdf</a>(x,def,gn,utc) 
002 <span class="comment">%TRRAYLPDF Calculates transformed Rayleigh approximation for amplitudes </span>
003 <span class="comment">%          </span>
004 <span class="comment">%  CALL:  f = trraylpdf(x,def,g,u); </span>
005 <span class="comment">% </span>
006 <span class="comment">%    f    = density structure of wave amplitude f(x); </span>
007 <span class="comment">% </span>
008 <span class="comment">%    x    = a row vector with x-values. </span>
009 <span class="comment">%    def  = 'Ac',    gives wave crest amplitude Ac (default). </span>
010 <span class="comment">%           'At',    gives wave trough amplitude At. </span>
011 <span class="comment">%           'AcAt',  gives wave range Ac+At </span>
012 <span class="comment">%    g    = [y g(y)] a two column matrix with the transformation  g(y). </span>
013 <span class="comment">%    u    = reference level (default the most frequently crossed level). </span>
014 <span class="comment">% </span>
015 <span class="comment">% Example: </span>
016 <span class="comment">%  np =10000; dt = .2; method = 1 </span>
017 <span class="comment">%  x1 = spec2nlsdat(jonswap,np,dt); </span>
018 <span class="comment">%  [S, H,Ac,At] = dat2steep(x1,4,method);  </span>
019 <span class="comment">%  gnl = dat2tr(x1,'nonlinear');   <span class="comment">% nonlinear transformation </span></span>
020 <span class="comment">%  gl  = dat2tr(x1,'linear');      <span class="comment">% identity transformations   </span></span>
021 <span class="comment">%  x   = linspace(0,8); </span>
022 <span class="comment">%  fnl = trraylpdf(x,'ac',gnl,0);  <span class="comment">% with transformation </span></span>
023 <span class="comment">%  fl  = trraylpdf(x,'ac',gl,0);   <span class="comment">% without transformation </span></span>
024 <span class="comment">%  empdistr(Ac), hold on </span>
025 <span class="comment">%  pdfplot(fnl,11,'g'),  </span>
026 <span class="comment">%  pdfplot(fl,11,'r'),  hold off   </span>
027 <span class="comment">% </span>
028 <span class="comment">% See also  wraylpdf </span>
029  
030 <span class="comment">% Tested on : matlab 5.3 </span>
031 <span class="comment">% svi    10.11.1999 </span>
032 <span class="comment">% ir     24.05.2000 </span>
033 <span class="comment">% ir     25.06.2000 </span>
034 <span class="comment">% Revised pab  </span>
035 <span class="comment">% Added example   </span>
036  
037  
038 <span class="comment">% References: </span>
039 <span class="comment">% Rychlik, I. and Leadbetter, M.R. (1997) </span>
040 <span class="comment">% 'Analysis of ocean waves by crossing- and oscillation-intensities' </span>
041 <span class="comment">% Proceedings of Seventh (1997) ISOPE Conference, Vol. III, pp. 206-213. </span>
042 <span class="comment">% </span>
043  
044 x = x(:);   
045 f=<a href="../../wafo/trgauss/createpdf.html" class="code" title=" PDF class constructor">createpdf</a>; 
046  
047 <span class="keyword">if</span> nargin&lt;2|isempty(def) 
048   def=<span class="string">'ac'</span>; 
049 <span class="keyword">end</span> 
050  
051 <span class="keyword">switch</span> lower(def(2:<span class="keyword">end</span>)) 
052  <span class="keyword">case</span>  <span class="string">'c'</span>,               defnr = 1; 
053  <span class="keyword">case</span>  <span class="string">'t'</span>,               defnr =-1; 
054  <span class="keyword">case</span>  <span class="string">'cat'</span>,             defnr = 2; 
055  <span class="keyword">otherwise</span>, error(<span class="string">'Unknown def'</span>) 
056 <span class="keyword">end</span> 
057  
058 <span class="keyword">if</span>  nargin&lt;3|isempty(gn) 
059   gn=[(-5:0.02:5)' (-5:0.02:5)']; 
060 <span class="keyword">end</span> 
061  
062 <span class="keyword">if</span> nargin&lt;4|isempty(utc) 
063   utc_d = <a href="../../wafo/trgauss/gaus2dat.html" class="code" title=" Transforms  xx  using the inverse of transformation  g.">gaus2dat</a>([0 0],gn); <span class="comment">% most frequent crossed level  </span>
064   utc   = utc_d(1,2); 
065 <span class="keyword">end</span> 
066  
067 <span class="keyword">if</span>  nargin&lt;1|isempty(x) 
068    <span class="keyword">if</span> defnr&lt;2    
069 <span class="comment">%      xx=gaus2dat([ (0:0.1:5)' (0:0.1:5)'],gn); </span>
070 <span class="comment">%      x=xx(:,2)-utc; </span>
071        ac=<a href="../../wafo/trgauss/gaus2dat.html" class="code" title=" Transforms  xx  using the inverse of transformation  g.">gaus2dat</a>([0 5],gn); 
072        x=(linspace(utc,ac(1,2),100)-utc)'; 
073    <span class="keyword">else</span> 
074 <span class="comment">%      xx1=gaus2dat([ (0:0.05:5)' (0:0.05:5)'],gn); </span>
075 <span class="comment">%      xx2=gaus2dat([ (0:0.05:5)' -(0:0.05:5)'],gn); </span>
076 <span class="comment">%      x=xx1(:,2)-xx2(:,2); </span>
077        ac=<a href="../../wafo/trgauss/gaus2dat.html" class="code" title=" Transforms  xx  using the inverse of transformation  g.">gaus2dat</a>([0 5],gn); 
078        at=<a href="../../wafo/trgauss/gaus2dat.html" class="code" title=" Transforms  xx  using the inverse of transformation  g.">gaus2dat</a>([0 -5],gn); 
079        x=linspace(0,ac(1,2)-at(1,2),100)'; 
080    <span class="keyword">end</span> 
081 <span class="keyword">end</span> 
082  
083 h1=x; 
084 f.x={x}; 
085  
086 der1=ones(length(h1),1);der2=ones(length(h1),1); 
087  
088 <span class="keyword">if</span> defnr==1 
089    hg1=<a href="../../wafo/trgauss/tranproc.html" class="code" title=" Transforms process X and up to four derivatives  ">tranproc</a>([utc+h1 der1],gn);der1=abs(hg1(:,2)); 
090 <span class="comment">%   f.f  = der1.*wraylpdf(hg1(:,1),1); </span>
091    f.f  = der1.*hg1(:,1).*exp(-0.5*hg1(:,1).^2); 
092 <span class="keyword">end</span> 
093  
094 <span class="keyword">if</span> defnr==-1 
095   hg2=<a href="../../wafo/trgauss/tranproc.html" class="code" title=" Transforms process X and up to four derivatives  ">tranproc</a>([utc-h1 der2],gn);der2=abs(hg2(:,2)); 
096 <span class="comment">%  f.f  = der2.*wraylpdf(-hg2(:,1),1); </span>
097    f.f  = -der2.*hg2(:,1).*exp(-0.5*hg2(:,1).^2); 
098 <span class="keyword">end</span>  
099  
100 <span class="keyword">if</span> defnr==2 
101   r=0:0.01:7; 
102   h11=<a href="../../wafo/trgauss/gaus2dat.html" class="code" title=" Transforms  xx  using the inverse of transformation  g.">gaus2dat</a>([ones(length(r),1),r'],gn);<span class="comment">%G(R) </span>
103   h22=<a href="../../wafo/trgauss/gaus2dat.html" class="code" title=" Transforms  xx  using the inverse of transformation  g.">gaus2dat</a>([ones(length(r),1),-r'],gn);<span class="comment">%G(-R) </span>
104                                              <span class="comment">%new g transformation G(R)-G(-R) </span>
105   h=h11(:,2)-h22(:,2); 
106   Gs=[r' h];gs=fliplr(Gs); 
107                                              <span class="comment">%derivative of g </span>
108   der=ones(length(r),1); 
109   hgs=<a href="../../wafo/trgauss/tranproc.html" class="code" title=" Transforms process X and up to four derivatives  ">tranproc</a>([h der],gs); 
110   der=abs(hgs(:,2));  r2=abs(hgs(:,1)); 
111 <span class="comment">%  ff=der.*wraylpdf(r2,1); </span>
112   ff  = der.*r2.*exp(-0.5*r2.^2); 
113   f.f  = interp1(h,ff,x,<span class="string">'linear'</span>); 
114 <span class="keyword">end</span> 
115  
116 <span class="keyword">switch</span> lower(def) 
117  <span class="keyword">case</span>  <span class="string">'ac'</span> 
118   Htxt = [<span class="string">'Transformed Rayleigh approx. of Ac density'</span>]; 
119   xtxt = [<span class="string">'Ac [m]'</span>]; 
120  <span class="keyword">case</span>  <span class="string">'at'</span> 
121   Htxt = [<span class="string">'Transformed Rayleigh approx. of At density'</span>]; 
122   xtxt = [<span class="string">'At [m]'</span>]; 
123  <span class="keyword">case</span>  <span class="string">'acat'</span> 
124   Htxt = [<span class="string">'Transformed Rayleigh approx. of H=Ac+At density'</span>]; 
125   xtxt = [<span class="string">'H=Ac+At [m]'</span>]; 
126 <span class="keyword">end</span>  
127    
128 f.title=Htxt; 
129 f.labx{1}=xtxt; 
130  
131  
132</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>