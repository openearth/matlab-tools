<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of Chapter2</title>
  <meta name="keywords" content="Chapter2">
  <meta name="description" content=" % CHAPTER2 Modelling random loads and stochastic waves">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">wafo</a> &gt; <a href="../index.html">papers</a> &gt; <a href="index.html">tutorcom</a> &gt; Chapter2.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\papers\tutorcom&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>Chapter2
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong> % CHAPTER2 Modelling random loads and stochastic waves</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> % <a href="Chapter2.html" class="code" title=" % CHAPTER2 Modelling random loads and stochastic waves">CHAPTER2</a> Modelling random loads and stochastic waves
 
  <a href="Chapter2.html" class="code" title=" % CHAPTER2 Modelling random loads and stochastic waves">Chapter2</a> contains the commands used in Chapter 2 of the tutorial and
  present some tools for analysis of randodm functions with
  respect to their correlation, spectral and distributional properties.
  The code is divided into three examples: 
 
  Example1 is devoted to estimation of different parameters in the model.
  Example2 deals with spectral densities and
  Example3 presents the use of WAFO to simulate samples of a Gaussian
  process.
 
  Some of the commands are edited for fast computation. 
  Each set of commands is followed by a 'pause' command.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../../wafo/onedim/covplot.html" class="code" title=" covplot(rn,L,plotflag,lintype)">covplot</a></li></TD>
<TD> Plots the auto covariance function (ACF) 1D or 2D.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/onedim/dat2cov.html" class="code" title=" R = dat2cov(xn,varargin)">dat2cov</a></li></TD>
<TD> Estimate auto covariance function from data.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/trgauss/dat2gaus.html" class="code" title=" xx = dat2gaus(x,g)">dat2gaus</a></li></TD>
<TD> Transforms  x  using the transformation  g.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/onedim/dat2lc.html" class="code" title=" lc = dat2lc(x,h,def);">dat2lc</a></li></TD>
<TD> Extracts level-crossing spectrum from data,</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/onedim/dat2spec.html" class="code" title=" [S,fcut] = dat2spec(xn,varargin)">dat2spec</a></li></TD>
<TD> Estimate one-sided spectral density from data.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/onedim/dat2spec2.html" class="code" title=" S = dat2spec2(xn,L,g,plotflag,wdef,dT,chopOffHighFreq)">dat2spec2</a></li></TD>
<TD> Estimate one-sided spectral density, version 2.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/onedim/dat2tp.html" class="code" title=" [tp, ind] = data2tp(x,h,wdef);">dat2tp</a></li></TD>
<TD> Extracts turning points from data,</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/trgauss/dat2tr.html" class="code" title=" [g, test, cmax, irr, g2]= dat2tr(x,def,varargin);">dat2tr</a></li></TD>
<TD> Estimate transformation, g, from data.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/onedim/findoutliers.html" class="code" title=" [ind, indg]=findoutliers(xx,zcrit,dcrit,ddcrit,plotflag)">findoutliers</a></li></TD>
<TD> Finds the indices to spurious points in a timeseries</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/trgauss/hermitetr.html" class="code" title=" [g ,t0]=hermitetr(x,data,def)">hermitetr</a></li></TD>
<TD> Calculate transformation, g, proposed by Winterstein</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/jonswap.html" class="code" title=" S1 = jonswap(w1,sdata,plotflag)">jonswap</a></li></TD>
<TD> Calculates (and plots) a JONSWAP spectral density</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/trgauss/mctrtest.html" class="code" title=" test2 = mctrtest(S,Np,test0,def,opt)">mctrtest</a></li></TD>
<TD> Test if a stochastic process is Gaussian.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/mkdspec.html" class="code" title=" Snew=mkdspec(S,D,plotflag)">mkdspec</a></li></TD>
<TD> Make a directional spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/phi1.html" class="code" title=" ph=phi1(w,h)">phi1</a></li></TD>
<TD> factor for transforming spectra to finite water depth spectra</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/onedim/reconstruct.html" class="code" title=" [y,g,g2,test,tobs,mu1o, mu1oStd]=reconstruct(x,inds,Nsim,L,def,varargin)">reconstruct</a></li></TD>
<TD> reconstruct the spurious/missing points of timeseries</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/spec2cov.html" class="code" title=" R = spec2cov(S,nr,Nt,rate,Nx,Ny,dx,dy)">spec2cov</a></li></TD>
<TD> Computes covariance function and its derivatives</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/spec2dt.html" class="code" title=" dT = spec2dt(S);">spec2dt</a></li></TD>
<TD>  Computes sampling interval from Nyquist frequency in spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/spec2mom.html" class="code" title=" [m,mtext] = spec2mom(S,nr,vari,even)">spec2mom</a></li></TD>
<TD> Calculates spectral moments from spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wsim/spec2sdat.html" class="code" title=" [x,xder]=spec2sdat(S,np,dt,iseed,method)">spec2sdat</a></li></TD>
<TD> Simulates a Gaussian process and its derivative from spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/trgauss/spec2skew.html" class="code" title=" [skew, kurt, ma, sa, Hs ,Hd]=spec2skew(S,h,method)">spec2skew</a></li></TD>
<TD> Estimates the moments of 2'nd order non-linear waves</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/spec2spec.html" class="code" title=" [Snew]=spec2spec(S,newtype,phi,v)">spec2spec</a></li></TD>
<TD> Transforms between different types of spectra</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/spreading.html" class="code" title=" D = spreading(th,type,th0,data,w,def)">spreading</a></li></TD>
<TD> Directional spreading functions</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/torsethaugen.html" class="code" title=" [S, Sw, Ss]=torsethaugen(w1,sdata,plotflag)">torsethaugen</a></li></TD>
<TD> Calculates a double peaked (swell + wind) spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/trgauss/trplot.html" class="code" title=" h=trplot(g,g2,ma,sa)">trplot</a></li></TD>
<TD> Plots transformation, g, eg. estimated with dat2tr.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/misc/wafostamp.html" class="code" title=" [H,ax]=wafostamp(varargin)">wafostamp</a></li></TD>
<TD> Prints a caption "made by WAFO" in current figure.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/onedim/waveplot.html" class="code" title=" Nf1 = waveplot(x,varargin)">waveplot</a></li></TD>
<TD> Plots the surface elevation of timeseries.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wkurtosis.html" class="code" title=" k = wkurtosis(X,dim)">wkurtosis</a></li></TD>
<TD> Computes sample kurtosis</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wnormplot.html" class="code" title=" wnormplot(x,nr1,nr2,df);">wnormplot</a></li></TD>
<TD> Plots data on a Normal distribution paper</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wskewness.html" class="code" title=" s = wskewness(X,dim)">wskewness</a></li></TD>
<TD> Computes sample skewness</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/wspecplot.html" class="code" title=" wspecplot(S,varargin)">wspecplot</a></li></TD>
<TD> Plot a spectral density</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<TABLE BORDER=0>

</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="comment">%<span class="comment">% CHAPTER2 Modelling random loads and stochastic waves</span></span>
002 <span class="comment">%</span>
003 <span class="comment">% Chapter2 contains the commands used in Chapter 2 of the tutorial and</span>
004 <span class="comment">% present some tools for analysis of randodm functions with</span>
005 <span class="comment">% respect to their correlation, spectral and distributional properties.</span>
006 <span class="comment">% The code is divided into three examples: </span>
007 <span class="comment">%</span>
008 <span class="comment">% Example1 is devoted to estimation of different parameters in the model.</span>
009 <span class="comment">% Example2 deals with spectral densities and</span>
010 <span class="comment">% Example3 presents the use of WAFO to simulate samples of a Gaussian</span>
011 <span class="comment">% process.</span>
012 <span class="comment">%</span>
013 <span class="comment">% Some of the commands are edited for fast computation. </span>
014 <span class="comment">% Each set of commands is followed by a 'pause' command.</span>
015 <span class="comment">% </span>
016 
017 <span class="comment">% Tested on Matlab 5.3, 7.01</span>
018 <span class="comment">% History</span>
019 <span class="comment">% Revised pab sept2005</span>
020 <span class="comment">%  Added sections -&gt; easier to evaluate using cellmode evaluation.</span>
021 <span class="comment">% Revised pab Dec2004</span>
022 <span class="comment">% Created by GL July 13, 2000</span>
023 <span class="comment">% from commands used in Chapter 2</span>
024 <span class="comment">%</span>
025 
026 pstate =  <span class="string">'off'</span>;
027 
028 <span class="comment">%<span class="comment">% Section 2.1 Introduction and preliminary analysis</span></span>
029 <span class="comment">%<span class="comment">% Example 1: Sea data</span></span>
030 <span class="comment">%<span class="comment">% Observed crossings compared to the expected for Gaussian signals</span></span>
031 xx = load(<span class="string">'sea.dat'</span>);
032 me = mean(xx(:,2))
033 sa = std(xx(:,2))
034 xx(:,2) = xx(:,2) - me;
035 lc = <a href="../../../wafo/onedim/dat2lc.html" class="code" title=" Extracts level-crossing spectrum from data, ">dat2lc</a>(xx);
036 pause(pstate)
037 
038 
039 <span class="comment">%<span class="comment">% Turningpoints and irregularity factor</span></span>
040 T = max(xx(:,1))-min(xx(:,1))
041 f0 = interp1(lc(:,1),lc(:,2),0)/T
042 pause(pstate)
043 
044 tp = <a href="../../../wafo/onedim/dat2tp.html" class="code" title=" Extracts turning points from data,">dat2tp</a>(xx);
045 alfa = f0/(length(tp)/(2*T))
046 pause(pstate)
047 
048 <span class="comment">% A part of sea data is visulized with the following commands</span>
049 clf
050 <a href="../../../wafo/onedim/waveplot.html" class="code" title=" Plots the surface elevation of timeseries.">waveplot</a>(xx,tp,<span class="string">'k-'</span>,<span class="string">'*'</span>,1,1)
051 axis([0 2 -inf inf])
052 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
053 pause(pstate)
054 
055 <span class="comment">%<span class="comment">% Finding possible spurious points</span></span>
056 <span class="comment">%However, if the amount of data is too large for visual examinations one</span>
057 <span class="comment">%could use the following criteria to find possible spurious points. One</span>
058 <span class="comment">%must be careful using the criteria for extremevalue analysis, because</span>
059 <span class="comment">%these criteria might remove the highest and steepest waves.</span>
060 dt = diff(xx(1:2,1));
061 dcrit = 5*dt;
062 ddcrit = 9.81/2*dt*dt;
063 zcrit = 0;
064 [inds, indg] = <a href="../../../wafo/onedim/findoutliers.html" class="code" title=" Finds the indices to spurious points in a timeseries">findoutliers</a>(xx,zcrit,dcrit,ddcrit);
065 pause(pstate)
066 
067 <span class="comment">%<span class="comment">% Section 2.2 Frequency Modeling of Load Histories</span></span>
068 <span class="comment">%<span class="comment">% Periodogram: Raw spectrum</span></span>
069 clf
070 S = <a href="../../../wafo/onedim/dat2spec2.html" class="code" title=" Estimate one-sided spectral density, version 2.  ">dat2spec2</a>(xx,9500);
071 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S)
072 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
073 pause(pstate)
074 
075 <span class="comment">%<span class="comment">% Calculate moments  </span></span>
076 mom = <a href="../../../wafo/spec/spec2mom.html" class="code" title=" Calculates spectral moments from spectrum">spec2mom</a>(S,4)
077 [sa sqrt(mom(1))]
078 pause(pstate)
079 
080 <span class="comment">%<span class="comment">% Section 2.2.1 Random functions in Spectral Domain - Gaussian processes</span></span>
081 <span class="comment">%<span class="comment">% Smoothing of spectral estimate </span></span>
082 clf
083 S1 = <a href="../../../wafo/onedim/dat2spec2.html" class="code" title=" Estimate one-sided spectral density, version 2.  ">dat2spec2</a>(xx,200);
084 S2 = <a href="../../../wafo/onedim/dat2spec2.html" class="code" title=" Estimate one-sided spectral density, version 2.  ">dat2spec2</a>(xx,50);
085 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S1,[],<span class="string">'-.'</span>)
086 hold on
087 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S2)
088 hold off
089 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
090 pause(pstate)
091 
092 <span class="comment">%<span class="comment">% Estimated autocovariance</span></span>
093 clf
094 R2 = <a href="../../../wafo/spec/spec2cov.html" class="code" title=" Computes covariance function and its derivatives  ">spec2cov</a>(S1,1);
095 Rest = <a href="../../../wafo/onedim/dat2cov.html" class="code" title=" Estimate auto covariance function from data.">dat2cov</a>(xx,80,[],<span class="string">'- -'</span>);
096 <a href="../../../wafo/onedim/covplot.html" class="code" title=" Plots the auto covariance function (ACF) 1D or 2D. ">covplot</a>(R2,80,[],<span class="string">'.'</span>)
097 hold on
098 <a href="../../../wafo/onedim/covplot.html" class="code" title=" Plots the auto covariance function (ACF) 1D or 2D. ">covplot</a>(Rest)
099 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
100 hold off
101 pause(pstate)
102 
103 <span class="comment">%<span class="comment">% Section 2.2.2 Transformed Gaussian models</span></span>
104 rho3 = <a href="../../../wafo/wstats/wskewness.html" class="code" title=" Computes sample skewness">wskewness</a>(xx(:,2))
105 rho4 = <a href="../../../wafo/wstats/wkurtosis.html" class="code" title=" Computes sample kurtosis">wkurtosis</a>(xx(:,2))
106 
107 [sk, ku]=<a href="../../../wafo/trgauss/spec2skew.html" class="code" title=" Estimates the moments of 2'nd order non-linear waves ">spec2skew</a>(S1)
108 
109 <span class="comment">%<span class="comment">% Comparisons of 3 transformations</span></span>
110 clf
111 gh = <a href="../../../wafo/trgauss/hermitetr.html" class="code" title=" Calculate transformation, g, proposed by Winterstein ">hermitetr</a>([],[sa sk ku me]);
112 g  = gh; g(:,2)=g(:,1)/sa;
113 <a href="../../../wafo/trgauss/trplot.html" class="code" title=" Plots transformation, g, eg. estimated with dat2tr.">trplot</a>(g)
114 
115 [glc, test0] = <a href="../../../wafo/trgauss/dat2tr.html" class="code" title=" Estimate transformation, g, from data.">dat2tr</a>(xx);
116 hold on
117 plot(glc(:,1),glc(:,2),<span class="string">'b-'</span>)
118 plot(gh(:,1),gh(:,2),<span class="string">'b-.'</span>)
119 hold off
120 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
121 pause(pstate)
122 
123 <span class="comment">%<span class="comment">%  Test Gaussianity of a stochastic process.</span></span>
124 <span class="comment">%MCTRTEST simulates  e(g(u)-u) = int (g(u)-u)^2 du  for Gaussian processes </span>
125 <span class="comment">%  given the spectral density, S. The result is plotted if test0 is given.</span>
126 <span class="comment">%  This is useful for testing if the process X(t) is Gaussian.</span>
127 <span class="comment">%  If 95<span class="comment">% of TEST1 is less than TEST0 then X(t) is not Gaussian at a 5<span class="comment">% level.</span></span></span>
128       
129 <span class="comment">%the following test takes time</span>
130 N = length(xx);
131 test1 = <a href="../../../wafo/trgauss/mctrtest.html" class="code" title=" Test if a stochastic process is Gaussian.">mctrtest</a>(S1,[N,50],test0);
132 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(CR)'</span>)
133 pause(pstate)
134 
135 <span class="comment">%<span class="comment">% Normalplot of data xx</span></span>
136 <span class="comment">% indicates that the underlying distribution has a &quot;heavy&quot; upper tail and a</span>
137 <span class="comment">% &quot;light&quot; lower tail. </span>
138 clf
139 <a href="../../../wafo/wstats/wnormplot.html" class="code" title=" Plots data on a Normal distribution paper">wnormplot</a>(xx(:,2))
140 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
141 pause(pstate)
142 
143 <span class="comment">%<span class="comment">% Section 2.2.3 Spectral densities of sea data</span></span>
144 <span class="comment">%<span class="comment">% Example 2: Different forms of spectra</span></span>
145 clf
146 Hm0 = 7; Tp = 11;
147 spec = <a href="../../../wafo/spec/jonswap.html" class="code" title=" Calculates (and plots) a JONSWAP spectral density">jonswap</a>([],[Hm0 Tp]);
148 spec.note
149 pause(pstate)
150 
151 
152 <span class="comment">%<span class="comment">% Directional spectrum and Encountered directional spectrum</span></span>
153 clf
154 D = <a href="../../../wafo/spec/spreading.html" class="code" title=" Directional spreading functions">spreading</a>(101,<span class="string">'cos2s'</span>,0,[],spec.w,1)
155 Sd = <a href="../../../wafo/spec/mkdspec.html" class="code" title=" Make a directional spectrum">mkdspec</a>(spec,D)
156 pause(pstate)
157 
158 clf
159 Se = <a href="../../../wafo/spec/spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Sd,<span class="string">'encdir'</span>,0,10);
160 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(Se), hold on
161 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(Sd,1,<span class="string">'--'</span>), hold off
162 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
163 pause(pstate)
164 
165 <span class="comment">%<span class="comment">% Frequency spectra</span></span>
166 clf
167 S1 =<a href="../../../wafo/spec/spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Sd,<span class="string">'freq'</span>);
168 S2 = <a href="../../../wafo/spec/spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Se,<span class="string">'enc'</span>);
169 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(spec), hold on
170 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S1,1,<span class="string">'.'</span>),
171 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S2),
172 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
173 hold off
174 pause(pstate)
175 
176 <span class="comment">%<span class="comment">% Wave number spectrum</span></span>
177 clf
178 Sk = <a href="../../../wafo/spec/spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(spec,<span class="string">'k1d'</span>)
179 Skd = <a href="../../../wafo/spec/spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Sd,<span class="string">'k1d'</span>)
180 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(Sk), hold on
181 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(Skd,1,<span class="string">'--'</span>), hold off
182 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
183 pause(pstate)
184 
185 <span class="comment">%<span class="comment">% Effect of waterdepth on spectrum</span></span>
186 clf
187 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(spec,1,<span class="string">'--'</span>), hold on
188 S20 = spec;
189 S20.S = S20.S.*<a href="../../../wafo/spec/phi1.html" class="code" title=" factor for transforming spectra to finite water depth spectra">phi1</a>(S20.w,20);
190 S20.h = 20;
191 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S20),  hold off
192 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
193 pause(pstate)
194 
195 <span class="comment">%<span class="comment">% Section 2.3 Simulation of transformed Gaussian process</span></span>
196 <span class="comment">%<span class="comment">% Example 3: Simulation of random sea    </span></span>
197 <span class="comment">% Reconstruct replaces the spurious points of seasurface by simulated</span>
198 <span class="comment">% data on the basis of the remaining data and a transformed Gaussian</span>
199 <span class="comment">% process. As noted previously one must be careful using the criteria </span>
200 <span class="comment">% for finding spurious points when reconstructing a dataset, because</span>
201 <span class="comment">% these criteria might remove the highest and steepest waves as we can see</span>
202 <span class="comment">% in this plot where the spurious points is indicated with a '+' sign:</span>
203 <span class="comment">%</span>
204 
205 clf
206 [y, grec] = <a href="../../../wafo/onedim/reconstruct.html" class="code" title=" reconstruct the spurious/missing points of timeseries">reconstruct</a>(xx,inds);
207 <a href="../../../wafo/onedim/waveplot.html" class="code" title=" Plots the surface elevation of timeseries.">waveplot</a>(y,<span class="string">'-'</span>,xx(inds,:),<span class="string">'+'</span>,1,1)
208 axis([0 inf -inf inf])
209 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
210 pause(pstate)
211 
212 <span class="comment">%<span class="comment">%</span></span>
213 clf
214 L = 200;
215 x = <a href="../../../wafo/trgauss/dat2gaus.html" class="code" title=" Transforms  x  using the transformation  g.">dat2gaus</a>(y,grec);
216 Sx = <a href="../../../wafo/onedim/dat2spec.html" class="code" title=" Estimate one-sided spectral density from data.">dat2spec</a>(x,L);
217 pause(pstate)
218       
219 clf
220 dt = <a href="../../../wafo/spec/spec2dt.html" class="code" title="  Computes sampling interval from Nyquist frequency in spectrum">spec2dt</a>(Sx)
221 Sx.tr = grec;
222 ysim = <a href="../../../wafo/wsim/spec2sdat.html" class="code" title=" Simulates a Gaussian process and its derivative from spectrum">spec2sdat</a>(Sx,480);
223 <a href="../../../wafo/onedim/waveplot.html" class="code" title=" Plots the surface elevation of timeseries.">waveplot</a>(ysim,<span class="string">'-'</span>)
224 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(CR)'</span>)
225 pause(pstate)
226  
227 <span class="comment">%<span class="comment">% Estimated spectrum compared to Torsethaugen spectrum</span></span>
228 clf
229 Tp = 1.1;
230 H0 = 4*sqrt(<a href="../../../wafo/spec/spec2mom.html" class="code" title=" Calculates spectral moments from spectrum">spec2mom</a>(S1,1))
231 St = <a href="../../../wafo/spec/torsethaugen.html" class="code" title=" Calculates a double peaked (swell + wind) spectrum ">torsethaugen</a>([0:0.01:5],[H0  2*pi/Tp]);
232 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S1)
233 hold on
234 <a href="../../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(St,[],<span class="string">'-.'</span>)
235 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
236 pause(pstate)
237 
238 <span class="comment">%<span class="comment">%</span></span>
239 clf
240 Snorm = St;
241 Snorm.S = Snorm.S/sa^2;
242 dt = <a href="../../../wafo/spec/spec2dt.html" class="code" title="  Computes sampling interval from Nyquist frequency in spectrum">spec2dt</a>(Snorm)
243 pause(pstate)
244 
245 clf
246 [Sk Su] = <a href="../../../wafo/trgauss/spec2skew.html" class="code" title=" Estimates the moments of 2'nd order non-linear waves ">spec2skew</a>(St);
247 sa = sqrt(<a href="../../../wafo/spec/spec2mom.html" class="code" title=" Calculates spectral moments from spectrum">spec2mom</a>(St,1));
248 gh = <a href="../../../wafo/trgauss/hermitetr.html" class="code" title=" Calculate transformation, g, proposed by Winterstein ">hermitetr</a>([],[sa sk ku me]);
249 Snorm.tr = gh;
250 pause(pstate)
251 
252 <span class="comment">%<span class="comment">% Transformed Gaussian model compared to Gaussian model</span></span>
253 clf
254 dt = 0.5;
255 ysim_t = <a href="../../../wafo/wsim/spec2sdat.html" class="code" title=" Simulates a Gaussian process and its derivative from spectrum">spec2sdat</a>(Snorm,240,dt);
256 xsim_t = <a href="../../../wafo/trgauss/dat2gaus.html" class="code" title=" Transforms  x  using the transformation  g.">dat2gaus</a>(ysim_t,Snorm.tr);
257 pause(pstate)
258 
259 clf
260 xsim_t(:,2) = sa*xsim_t(:,2);
261 <a href="../../../wafo/onedim/waveplot.html" class="code" title=" Plots the surface elevation of timeseries.">waveplot</a>(xsim_t,ysim_t,5,1,sa,4.5,<span class="string">'r.'</span>,<span class="string">'b'</span>)
262 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(CR)'</span>)
263 pause(pstate)
264 
265</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>