<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of Chapter5</title>
  <meta name="keywords" content="Chapter5">
  <meta name="description" content=" % CHAPTER5 contains the commands used in Chapter 5 of the tutorial">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">wafo</a> &gt; <a href="../index.html">papers</a> &gt; <a href="index.html">tutorcom</a> &gt; Chapter5.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\papers\tutorcom&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>Chapter5
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong> % CHAPTER5 contains the commands used in Chapter 5 of the tutorial</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> % <a href="Chapter5.html" class="code" title=" % CHAPTER5 contains the commands used in Chapter 5 of the tutorial">CHAPTER5</a> contains the commands used in Chapter 5 of the tutorial
 
  CALL:  <a href="Chapter5.html" class="code" title=" % CHAPTER5 contains the commands used in Chapter 5 of the tutorial">Chapter5</a>
  
  Some of the commands are edited for fast computation. 
  Each set of commands is followed by a 'pause' command.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../../wafo/wstats/empdistr.html" class="code" title=" [Fz] = empdistr(z,varargin)">empdistr</a></li></TD>
<TD> Computes and plots the empirical CDF</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/misc/wafostamp.html" class="code" title=" [H,ax]=wafostamp(varargin)">wafostamp</a></li></TD>
<TD> Prints a caption "made by WAFO" in current figure.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wgevcdf.html" class="code" title=" F = wgevcdf(x,k,s,m);">wgevcdf</a></li></TD>
<TD> Generalized Extreme Value cumulative distribution function</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wgevfit.html" class="code" title=" [phat,cov,pci] = wgevfit(data,method,start,plotflag)">wgevfit</a></li></TD>
<TD> Parameter estimates for GEV data</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wgevrnd.html" class="code" title=" r = wgevrnd(k,s,m0,varargin);">wgevrnd</a></li></TD>
<TD> Random matrices from a Generalized Extreme Value distribution</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wgpdcdf.html" class="code" title=" F = wgpdcdf(x,k,s,m);">wgpdcdf</a></li></TD>
<TD> Generalized Pareto cumulative distribution function</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wgpdfit.html" class="code" title=" [parms,cov] = wgpdfit(data,method,plotflag)">wgpdfit</a></li></TD>
<TD> Parameter estimates for Generalized Pareto data</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wgpdrnd.html" class="code" title=" r = wgpdrnd(k,s,m0,varargin);">wgpdrnd</a></li></TD>
<TD> Random matrices from a Generalized Pareto Distribution</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wgumbplot.html" class="code" title=" phat = wgumbplot(x)">wgumbplot</a></li></TD>
<TD> Plots data on a Gumbel distribution paper.</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wnormplot.html" class="code" title=" wnormplot(x,nr1,nr2,df);">wnormplot</a></li></TD>
<TD> Plots data on a Normal distribution paper</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/wstats/wweibplot.html" class="code" title=" phat = wweibplot(x)">wweibplot</a></li></TD>
<TD> Plots data on a Weibull distribution paper</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<TABLE BORDER=0>

</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="comment">%<span class="comment">% CHAPTER5 contains the commands used in Chapter 5 of the tutorial</span></span>
002 <span class="comment">%</span>
003 <span class="comment">% CALL:  Chapter5</span>
004 <span class="comment">% </span>
005 <span class="comment">% Some of the commands are edited for fast computation. </span>
006 <span class="comment">% Each set of commands is followed by a 'pause' command.</span>
007 <span class="comment">% </span>
008 
009 <span class="comment">% Tested on Matlab 5.3</span>
010 <span class="comment">% History</span>
011 <span class="comment">% Revised pab sept2005</span>
012 <span class="comment">%  Added sections -&gt; easier to evaluate using cellmode evaluation.</span>
013 <span class="comment">% Created by GL July 13, 2000</span>
014 <span class="comment">% from commands used in Chapter 5</span>
015 <span class="comment">%</span>
016  
017 <span class="comment">%<span class="comment">% Chapter 5 Extreme value analysis</span></span>
018 
019 <span class="comment">%<span class="comment">% Section 5.1 Weibull and Gumbel papers</span></span>
020 pstate = <span class="string">'off'</span>
021 
022 <span class="comment">% Significant wave-height data on Weibull paper,</span>
023 Hs = load(<span class="string">'atlantic.dat'</span>);
024 wei = <a href="../../../wafo/wstats/wweibplot.html" class="code" title=" Plots data on a Weibull distribution paper">wweibplot</a>(Hs)
025 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
026 pause(pstate)
027 
028 <span class="comment">%<span class="comment">%</span></span>
029 <span class="comment">% Significant wave-height data on Gumbel paper,</span>
030 gum=<a href="../../../wafo/wstats/wgumbplot.html" class="code" title=" Plots data on a Gumbel distribution paper.">wgumbplot</a>(Hs)
031 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
032 pause(pstate)
033 
034 <span class="comment">%<span class="comment">%</span></span>
035 <span class="comment">% Significant wave-height data on Normal probability paper,</span>
036 <a href="../../../wafo/wstats/wnormplot.html" class="code" title=" Plots data on a Normal distribution paper">wnormplot</a>(log(Hs),1,0);
037 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
038 pause(pstate)
039 
040 <span class="comment">%<span class="comment">% Section 5.2 Generalized Pareto and Extreme Value distributions</span></span>
041 <span class="comment">%<span class="comment">% Section 5.2.1 Generalized Extreme Value distribution</span></span>
042 
043 <span class="comment">% Empirical distribution of significant wave-height with estimated </span>
044 <span class="comment">% Generalized Extreme Value distribution,</span>
045 [gev cov]=<a href="../../../wafo/wstats/wgevfit.html" class="code" title=" Parameter estimates for GEV data">wgevfit</a>(Hs);
046 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
047 pause(pstate)
048 
049 <span class="comment">%<span class="comment">% Section 5.2.2 Generalized Pareto distribution</span></span>
050 
051 <span class="comment">% Exceedances of significant wave-height data over level 3,</span>
052 [gpd3  cov] = <a href="../../../wafo/wstats/wgpdfit.html" class="code" title=" Parameter estimates for Generalized Pareto data">wgpdfit</a>(Hs(Hs&gt;3)-3);
053 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
054 
055 <span class="comment">%<span class="comment">%</span></span>
056 figure
057 <span class="comment">% Exceedances of significant wave-height data over level 7,</span>
058 [gpd7  cov] = <a href="../../../wafo/wstats/wgpdfit.html" class="code" title=" Parameter estimates for Generalized Pareto data">wgpdfit</a>(Hs(Hs&gt;7)-7);
059 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
060 pause(pstate)
061 
062 <span class="comment">%<span class="comment">% </span></span>
063 <span class="comment">%Simulates 100 values from the GEV distribution with parameters (0.3, 1, 2), then estimates the</span>
064 <span class="comment">%parameters using two different methods and plots the estimated distribution functions together</span>
065 <span class="comment">%with the empirical distribution.</span>
066 Rgev = <a href="../../../wafo/wstats/wgevrnd.html" class="code" title=" Random matrices from a Generalized Extreme Value distribution">wgevrnd</a>(0.3,1,2,1,100);
067 <a href="../../../wafo/wstats/empdistr.html" class="code" title=" Computes and plots the empirical CDF ">empdistr</a>(Rgev);
068 hold on
069 gp = <a href="../../../wafo/wstats/wgevfit.html" class="code" title=" Parameter estimates for GEV data">wgevfit</a>(Rgev,<span class="string">'pwm'</span>,[],0);
070 x=sort(Rgev);
071 plot(x,<a href="../../../wafo/wstats/wgevcdf.html" class="code" title=" Generalized Extreme Value cumulative distribution function">wgevcdf</a>(x,gp(1),gp(2),gp(3)))
072 gm = <a href="../../../wafo/wstats/wgevfit.html" class="code" title=" Parameter estimates for GEV data">wgevfit</a>(Rgev,<span class="string">'ml'</span>,gp,0);
073 plot(x,<a href="../../../wafo/wstats/wgevcdf.html" class="code" title=" Generalized Extreme Value cumulative distribution function">wgevcdf</a>(x,gm(1),gm(2),gm(3)),<span class="string">'--'</span>)
074 hold off
075 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
076 pause(pstate)
077 
078 <span class="comment">%<span class="comment">%</span></span>
079 <span class="comment">% Similarly for the GPD distribution;</span>
080 Rgpd = <a href="../../../wafo/wstats/wgpdrnd.html" class="code" title=" Random matrices from a Generalized Pareto Distribution">wgpdrnd</a>(0.4,1,0,1,100);
081 <a href="../../../wafo/wstats/empdistr.html" class="code" title=" Computes and plots the empirical CDF ">empdistr</a>(Rgpd);
082 hold on
083 gp = <a href="../../../wafo/wstats/wgpdfit.html" class="code" title=" Parameter estimates for Generalized Pareto data">wgpdfit</a>(Rgpd,<span class="string">'pkd'</span>,0);
084 x=sort(Rgpd);
085 plot(x,<a href="../../../wafo/wstats/wgpdcdf.html" class="code" title=" Generalized Pareto cumulative distribution function ">wgpdcdf</a>(x,gp(1),gp(2)))
086 gm = <a href="../../../wafo/wstats/wgpdfit.html" class="code" title=" Parameter estimates for Generalized Pareto data">wgpdfit</a>(Rgpd,<span class="string">'mom'</span>,0);
087 plot(x,<a href="../../../wafo/wstats/wgpdcdf.html" class="code" title=" Generalized Pareto cumulative distribution function ">wgpdcdf</a>(x,gm(1),gm(2)),<span class="string">'--'</span>)
088 gw = <a href="../../../wafo/wstats/wgpdfit.html" class="code" title=" Parameter estimates for Generalized Pareto data">wgpdfit</a>(Rgpd,<span class="string">'pwm'</span>,0);
089 plot(x,<a href="../../../wafo/wstats/wgpdcdf.html" class="code" title=" Generalized Pareto cumulative distribution function ">wgpdcdf</a>(x,gw(1),gw(2)),<span class="string">':'</span>)
090 gml = <a href="../../../wafo/wstats/wgpdfit.html" class="code" title=" Parameter estimates for Generalized Pareto data">wgpdfit</a>(Rgpd,<span class="string">'ml'</span>,0);
091 plot(x,<a href="../../../wafo/wstats/wgpdcdf.html" class="code" title=" Generalized Pareto cumulative distribution function ">wgpdcdf</a>(x,gw(1),gw(2)),<span class="string">'-.'</span>)
092 hold off
093 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
094 pause(pstate)
095 
096 <span class="comment">%<span class="comment">% Section 5.3 POT-analysis</span></span>
097 
098 <span class="comment">% Estimated expected exceedance over level u as function of u.</span>
099 u=linspace(2,10,200);
100 <span class="keyword">for</span> i=1:length(u)
101   m(i)=mean(Hs(Hs&gt;u(i)));
102 <span class="keyword">end</span>
103 plot(u,m-u)
104 xlabel(<span class="string">'u'</span>)
105 title(<span class="string">'Mean exceedance over level u'</span>)
106 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
107 pause(pstate)
108 
109 
110 <span class="comment">%<span class="comment">%</span></span>
111 <span class="comment">% Estimated distribution functions of monthly maxima with the POT method (solid),</span>
112 <span class="comment">% fitting a GEV (dashed) and the empirical distribution.</span>
113 
114 <span class="comment">% POT- method</span>
115 gpd7=<a href="../../../wafo/wstats/wgpdfit.html" class="code" title=" Parameter estimates for Generalized Pareto data">wgpdfit</a>(Hs(Hs&gt;7)-7,<span class="string">'pwm'</span>,0);
116 khat=gpd7(1);
117 sigmahat=gpd7(2);
118 muhat=length(Hs(Hs&gt;7))/(7*3*2);
119 bhat=sigmahat/muhat^khat;
120 ahat=7-(bhat-sigmahat)/khat;
121 x=linspace(5,15,200);
122 plot(x,<a href="../../../wafo/wstats/wgevcdf.html" class="code" title=" Generalized Extreme Value cumulative distribution function">wgevcdf</a>(x,khat,bhat,ahat))
123 
124 hold on,
125 
126 
127 
128 
129 <span class="comment">% Since we have data to compute the monthly maxima mm over 42 months we can also try to fit a</span>
130 <span class="comment">% GEV distribution directly:</span>
131 <span class="keyword">for</span> i=1:41
132   mm(i)=max(Hs(((i-1)*14+1):i*14)); 
133 <span class="keyword">end</span>
134 
135 gev=<a href="../../../wafo/wstats/wgevfit.html" class="code" title=" Parameter estimates for GEV data">wgevfit</a>(mm,[],[],0);
136 
137 <a href="../../../wafo/wstats/empdistr.html" class="code" title=" Computes and plots the empirical CDF ">empdistr</a>(mm)
138 hold on
139 plot(x,<a href="../../../wafo/wstats/wgevcdf.html" class="code" title=" Generalized Extreme Value cumulative distribution function">wgevcdf</a>(x,gev(1),gev(2),gev(3)),<span class="string">'--'</span>)
140 
141 hold off
142 <a href="../../../wafo/misc/wafostamp.html" class="code" title=" Prints a caption "made by WAFO" in current figure.">wafostamp</a>([],<span class="string">'(ER)'</span>)
143 pause(pstate)
144 
145</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>