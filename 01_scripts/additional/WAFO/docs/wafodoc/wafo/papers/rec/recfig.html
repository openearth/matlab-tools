<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of recfig</title>
  <meta name="keywords" content="recfig">
  <meta name="description" content="  callback implementing functions of RecDemo">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">wafo</a> &gt; <a href="../index.html">papers</a> &gt; <a href="index.html">rec</a> &gt; recfig.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\papers\rec&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>recfig
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>  callback implementing functions of RecDemo</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong> recfig(ix) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">  <a href="recfig.html" class="code" title="  callback implementing functions of RecDemo">RECFIG</a>  callback implementing functions of <a href="recdemo.html" class="code" title="  Show Rec figures with point and click interface">RecDemo</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="recinit.html" class="code" title=" recinit">recinit</a></li></TD>
<TD>  setup all global variables of the RECDEMO</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\cell.m">cell</a></li></TD>
<TD>          Create cell array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\iofun\clc.m">clc</a></li></TD>
<TD>           Clear command window.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\deal.m">deal</a></li></TD>
<TD>          Deal inputs to outputs.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\deblank.m">deblank</a></li></TD>
<TD>       Remove trailing blanks.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\drawnow.m">drawnow</a></li></TD>
<TD>       Flush pending graphics events.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\figure.m">figure</a></li></TD>
<TD>        Create figure window.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\gcf.m">gcf</a></li></TD>
<TD>           Get handle to current figure.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\simulink\simcoverage\@cvtest\help.m">help</a></li></TD>
<TD>          Display help text in Command Window.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\iofun\home.m">home</a></li></TD>
<TD>          Send the cursor home.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\uitools\inputdlg.m">inputdlg</a></li></TD>
<TD>      Input dialog box.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\isnumeric.m">isnumeric</a></li></TD>
<TD>     True for numeric arrays.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\uitools\menu.m">menu</a></li></TD>
<TD>          Generate a menu of choices for user input.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\num2str.m">num2str</a></li></TD>
<TD>       Convert number to string. (Fast version)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\sprintf.m">sprintf</a></li></TD>
<TD>       Write formatted data to string.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\str2num.m">str2num</a></li></TD>
<TD>       Convert string matrix to numeric array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmpi.bi">strcmpi</a></li></TD>
<TD>       Compare strings ignoring case.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<TABLE BORDER=0>

</TABLE>

</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code"> changesettingsmenu</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> <a name="_sub0" href="#_subfunctions" class="code">recfig</a>(ix)
002 <span class="comment">% RECFIG  callback implementing functions of RecDemo</span>
003 <span class="keyword">global</span> RECFIGNUM 
004 <span class="keyword">if</span> isempty(RECFIGNUM)
005   disp(<span class="string">'You must start recdemo in order to run this script'</span>)
006   <span class="keyword">return</span>
007 <span class="keyword">end</span>
008 Nfigs=13;
009 <span class="keyword">global</span> recmenulabels
010 
011 
012 <span class="keyword">switch</span> ix
013   <span class="keyword">case</span> -1,  <span class="comment">% change default settings</span>
014     RECFIGNUM=0;
015     <a href="#_sub1" class="code" title="sub  changesettingsmenu">changesettingsmenu</a>; <span class="comment">% local function    </span>
016   <span class="keyword">case</span> -2, <span class="comment">% make all figures</span>
017     RECFIGNUM=Nfigs;
018     <a href="recinit.html" class="code" title="  setup all global variables of the RECDEMO">recinit</a>
019     cfig=gcf;
020     <span class="keyword">for</span> iy=1:Nfigs,
021       figure(cfig-1+iy)
022       figname = [<span class="string">'recfig'</span>,num2str(iy)];
023       <span class="comment">%clc; home;</span>
024       help(figname);
025       eval(figname);
026       drawnow;
027     <span class="keyword">end</span>
028     <span class="keyword">for</span> iy=1:Nfigs,
029       figure(cfig-1+iy)
030       figname = [<span class="string">'recfig'</span>,num2str(iy)];
031       help(figname);
032     <span class="keyword">end</span>
033    <span class="keyword">case</span> -3, <span class="comment">% select a figure</span>
034      <span class="keyword">if</span> isempty(recmenulabels), <a href="recinit.html" class="code" title="  setup all global variables of the RECDEMO">recinit</a>; <span class="keyword">end</span>
035      iy = menu(<span class="string">'Choose a figure'</span>,recmenulabels{:},<span class="string">'Cancel'</span>);
036      <span class="keyword">if</span> ~isempty(iy) &amp; (1 &lt;= iy &amp; iy &lt;=Nfigs) ,
037        RECFIGNUM = iy;
038        <a href="recinit.html" class="code" title="  setup all global variables of the RECDEMO">recinit</a>
039        figname = [<span class="string">'recfig'</span>,num2str(iy)];
040        
041        clc; home; help(figname);
042        eval(figname);
043        drawnow;
044      <span class="keyword">end</span>
045    <span class="keyword">otherwise</span>
046      disp(<span class="string">'Unknown Input argument to recfig'</span>) 
047      disp(sprintf(<span class="string">'num =%g'</span>,ix))
048 <span class="keyword">end</span>
049      
050    
051 <span class="keyword">function</span> <a name="_sub1" href="#_subfunctions" class="code">changesettingsmenu</a>
052 <span class="comment">% Local function implementing </span>
053 <span class="comment">%</span>
054 
055 <span class="keyword">global</span> RECFIGNUM  recfilename xn xr ft2 fkde V H
056 <span class="comment">%Reconstruction parameters</span>
057 <span class="keyword">global</span> zcrit dcrit ddcrit Nsim L csm1 csm2 
058 <span class="comment">% distribution fitting parameters</span>
059 <span class="keyword">global</span> rate  res noverlap CSMA CSMB
060 <span class="comment">% kernel density estimation parameters</span>
061 <span class="keyword">global</span> kernel hs L2
062 
063 RECFIGNUM=0;
064 <a href="recinit.html" class="code" title="  setup all global variables of the RECDEMO">recinit</a> <span class="comment">% initialize global variables</span>
065         <span class="comment">% and put them into the cellarray of default values </span>
066 def=cell(3,1);
067 def{1}={zcrit,dcrit,ddcrit,Nsim,L,csm1,csm2};
068 def{2}={rate,res,noverlap,CSMA,CSMB};
069 def{3}={kernel,hs,L2};
070 <span class="comment">% Convert def to strdef containing only strings</span>
071 strdef=def;
072 <span class="keyword">for</span> ix=1:length(def)
073   <span class="keyword">for</span> iy=1:length(def{ix})
074     <span class="keyword">if</span> isnumeric(def{ix}{iy})
075       strdef{ix}{iy}=num2str(def{ix}{iy});
076     <span class="keyword">end</span>
077   <span class="keyword">end</span>
078 <span class="keyword">end</span>
079 lineNo=1;
080 
081 answer=inputdlg({<span class="string">'Enter name of data set to reconstruct:'</span>},<span class="string">'Change data set'</span>,lineNo,{recfilename},<span class="string">'on'</span>);
082 Na=length(answer);
083 <span class="keyword">if</span> Na&gt;0
084   <span class="keyword">if</span> (~strcmp(deblank(answer{ix}),deblank(recfilename))),
085     recfilename = answer{ix};
086     xn=[];
087     xr=[];V=[];H=[];phat=[];sphat=[]; <span class="comment">% all must be calculated again</span>
088     ft2=[];fkde=[];inds=[];
089     sphat=[]; ft2=[];           
090     phat=[];V=[];H=[]; fkde=[];
091   <span class="keyword">end</span>
092 <span class="keyword">end</span>  
093 
094 title1=<span class="string">'Change Reconstruction parameters (See findoutliers, reconstruct)'</span>;
095 <span class="comment">%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
096 prompt1 ={ <span class="keyword">...</span>
097 <span class="string">'Enter critical distance between consecutive points. (zcrit):'</span>,<span class="keyword">...</span>
098 <span class="string">'Enter critical distance of diff(xn(:,2)) (dcrit):'</span>,<span class="keyword">...</span>
099 <span class="string">'Enter critical distance of diff(xn(:,2),2) (ddcrit):'</span>,<span class="keyword">...</span>
100 <span class="string">'Enter maximum number of iterations of the reconstruction (Nsim):'</span>, <span class="keyword">...</span>
101 <span class="string">'Enter lag size of the window function (default the lag where  ACF&lt;2 stdev, maximum 200):'</span>,<span class="keyword">...</span>
102 <span class="string">'Enter a value for csm1 which defines smoothing  of log(crossing intensity):'</span>,<span class="keyword">...</span>
103 <span class="string">'Enter a value for csm2 which defines smoothing  of transformation g:'</span>};
104 answer=inputdlg(prompt1,title1,lineNo,strdef{1},<span class="string">'on'</span>);
105 Na=length(answer);
106 <span class="keyword">if</span> Na&gt;0
107   ind1=zeros(1,Na); <span class="comment">% index to changed variables</span>
108   <span class="keyword">for</span> ix=1:Na, ind1(ix)=~isempty(answer(ix));  <span class="keyword">end</span>
109   ind2=find(ind1&gt;0); 
110   <span class="keyword">for</span> ix=ind2(:).',
111     answer{ix}=str2num(answer{ix});
112     <span class="keyword">if</span> (isempty(answer{ix})|answer{ix}==def{1}{ix}), ind1(ix)=0; <span class="keyword">else</span>, def{1}{ix}=answer{ix}; <span class="keyword">end</span>
113   <span class="keyword">end</span>
114   ind2=find(ind1&gt;0); 
115   <span class="keyword">if</span> any(ind2) <span class="comment">% set variables  that must be calculated again to empty.</span>
116     xr=[];V=[];H=[];phat=[];sphat=[]; <span class="comment">% some or all of def{1} is changed</span>
117     ft2=[];fkde=[];                      
118     <span class="keyword">if</span> (any(ind2&lt;4)),inds=[];<span class="keyword">end</span>      <span class="comment">% some or all of zcrit,dcrit or ddcrit is changed</span>
119     [zcrit,dcrit,ddcrit,Nsim,L,csm1,csm2]=deal(def{1}{:});
120   <span class="keyword">end</span>
121 <span class="keyword">end</span>
122 
123 
124 
125 title2=<span class="string">'Change distribution fitting parameters (See dat2steep dist2dfit dist2dsmfun2)'</span>;
126 <span class="comment">%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  </span>
127 prompt2 ={<span class="keyword">...</span>
128 <span class="string">'Enter interpolation rate of the data before extracting data (rate):'</span>,<span class="keyword">...</span>
129 <span class="string">'Enter a value for res  which defines the bin size used in the conditional fitting:'</span>,<span class="keyword">...</span>
130 <span class="string">'Enter a value for noverlap which defines the number of groups overlapping in the conditional fitting:'</span>,<span class="keyword">...</span>
131 <span class="string">'Enter a value for CSMA which defines smoothing of Weibull scale parameter:'</span>,<span class="keyword">...</span>
132 <span class="string">'Enter a value for CSMB which defines smoothing of Weibull shape parameter:'</span>};
133 answer=inputdlg(prompt2,title2,lineNo,strdef{2},<span class="string">'on'</span>);    
134 Na=length(answer);
135 <span class="keyword">if</span> Na&gt;0
136   ind1=zeros(1,Na); <span class="comment">% index to changed variables</span>
137   <span class="keyword">for</span> ix=1:Na, ind1(ix)=~isempty(answer(ix));  <span class="keyword">end</span>
138   ind2=find(ind1&gt;0);
139   <span class="keyword">for</span> ix=ind2(:).',
140     answer{ix}=str2num(answer{ix});
141     <span class="keyword">if</span> (isempty(answer{ix})|answer{ix}==def{2}{ix}), ind1(ix)=0; <span class="keyword">else</span>, def{2}{ix}=answer{ix}; <span class="keyword">end</span>
142   <span class="keyword">end</span>
143   ind2=find(ind1&gt;0); 
144   <span class="keyword">if</span> any(ind2) <span class="comment">% set variables  that must be calculated again to empty.</span>
145     sphat=[]; ft2=[];                <span class="comment">% some or all of def{2} is changed</span>
146     <span class="keyword">if</span> (any(ind2&lt;2)), phat=[];V=[];H=[]; fkde=[];<span class="keyword">end</span> <span class="comment">% rate is changed</span>
147     <span class="keyword">if</span> (any(ind2==2 | ind2==3)), phat=[];        <span class="keyword">end</span> <span class="comment">% res or  noverlap  changed</span>
148     [rate,res,noverlap,CSMA,CSMB]=deal(def{2}{:});
149   <span class="keyword">end</span>
150 <span class="keyword">end</span>
151 
152 
153 
154 title3=<span class="string">'Change Kernel Density Estimation parameters (See kdebin)'</span>;
155 <span class="comment">%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
156 prompt3={<span class="keyword">...</span>
157 <span class="string">'Enter name for kernel:'</span>,<span class="keyword">...</span>
158 <span class="string">'Enter a smoothing parameter vector for hs (default 1D optimal value using hns):'</span>,<span class="keyword">...</span>
159 <span class="string">'Enter vector of transformation parameters (L2):'</span>};
160 answer=inputdlg(prompt3,title3,lineNo,strdef{3},<span class="string">'on'</span>);    
161 Na=length(answer);
162 <span class="keyword">if</span> Na&gt;0,
163   ind1=zeros(1,Na); <span class="comment">% index to changed variables</span>
164   <span class="keyword">for</span> ix=1:Na, ind1(ix)=~isempty(answer(ix));  <span class="keyword">end</span>
165   ind2=find(ind1&gt;0);
166   <span class="keyword">for</span> ix=ind2(:).',
167     <span class="keyword">if</span> (ix~=1), <span class="comment">% ix==1 ==&gt; kernel string nothing to do</span>
168       answer{ix}=str2num(answer{ix});
169       <span class="keyword">if</span> (isempty(answer{ix})|answer{ix}==def{3}{ix}), ind1(ix)=0; <span class="keyword">else</span>, def{3}{ix}=answer{ix}; <span class="keyword">end</span>
170     <span class="keyword">else</span>
171       <span class="keyword">if</span> (strcmpi(answer{ix},def{3}{ix})), ind1(ix)=0; <span class="keyword">else</span>, def{3}{ix}=answer{ix}; <span class="keyword">end</span>
172     <span class="keyword">end</span>
173   <span class="keyword">end</span>
174   ind2=find(ind1&gt;0); 
175   <span class="keyword">if</span> any(ind2) <span class="comment">% set variables  that must be calculated again to empty.</span>
176     fkde=[]; <span class="comment">% some or all of def{3} is changed    </span>
177     [kernel,hs,L2]=deal(def{3}{:});
178   <span class="keyword">end</span>
179 <span class="keyword">end</span></pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>