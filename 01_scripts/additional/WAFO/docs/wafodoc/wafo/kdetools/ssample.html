<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of ssample</title>
  <meta name="keywords" content="ssample">
  <meta name="description" content="  Random sampling from a smoothed empirical distribution">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">kdetools</a> &gt; ssample.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\kdetools&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>ssample
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>  Random sampling from a smoothed empirical distribution</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> s=ssample(A,m,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="ssample.html" class="code" title="  Random sampling from a smoothed empirical distribution ">SSAMPLE</a>  Random sampling from a smoothed empirical distribution 
  
  CALL: s = <a href="ssample.html" class="code" title="  Random sampling from a smoothed empirical distribution ">ssample</a>(data,m,options) 
    
    s      = sampled selection from data,  size m x D 
    data   = data matrix, size N x D (D = # dimensions) 
    m      = sampling size  
   options = kdeoptions-structure or cellvector of named parameters with 
             corresponding values, see <a href="kdeoptset.html" class="code" title=" Create or alter KDE OPTIONS structure. ">kdeoptset</a> for details.   
   
   <a href="ssample.html" class="code" title="  Random sampling from a smoothed empirical distribution ">SSAMPLE</a>(DATA,M) selects a random <a href="sample.html" class="code" title="  Random sampling of points from a data-set ">sample</a> of M data points from the 
   multivariate data-set in the matrix DATA. 
  
  Example: 
      data=<a href="../../wafo/wstats/wnormrnd.html" class="code" title=" Random matrices from a Normal distribution.">wnormrnd</a>(0,1,500,1); 
      s = <a href="ssample.html" class="code" title="  Random sampling from a smoothed empirical distribution ">ssample</a>(data,100,'kernel','gauss'); 
      f = <a href="kdebin.html" class="code" title=" Binned Kernel Density Estimator. ">kdebin</a>(s);   
      <a href="../../wafo/trgauss/pdfplot.html" class="code" title=" Plot contents of pdf structures">pdfplot</a>(f),hold on, 
      x = linspace(-5,5); 
      plot(x,<a href="../../wafo/wstats/wnormpdf.html" class="code" title=" Normal probability density function ">wnormpdf</a>(x),'r')</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="kdefun.html" class="code" title=" [f, hs,lambda]= kdefun(A,options,varargin)">kdefun</a></li></TD>
<TD>  Kernel Density Estimator.</TD>
</TR>
<TR>
<TD><li><a href="kdeoptset.html" class="code" title=" options = kdeoptset(varargin)">kdeoptset</a></li></TD>
<TD> Create or alter KDE OPTIONS structure.</TD>
</TR>
<TR>
<TD><li><a href="mkernelrnd.html" class="code" title=" R=mkernelrnd(kernel,N,D)">mkernelrnd</a></li></TD>
<TD> Random numbers from the Multivariate Kernel Function.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/tranproc.html" class="code" title=" y = tranproc(x,ff)">tranproc</a></li></TD>
<TD> Transforms process X and up to four derivatives</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\@scribehandle\class.m">class</a></li></TD>
<TD>         Create object or return object class.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\signal\signal\@spectrum\cov.m">cov</a></li></TD>
<TD>           Covariance matrix.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\deal.m">deal</a></li></TD>
<TD>          Deal inputs to outputs.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\matfun\@single\det.bi">det</a></li></TD>
<TD>           Determinant.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\iscell.m">iscell</a></li></TD>
<TD>        True for cell array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\iofun\@timer\isequal.m">isequal</a></li></TD>
<TD>       True if arrays are numerically equal.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\mean.m">mean</a></li></TD>
<TD>          Average or mean value.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\num2cell.m">num2cell</a></li></TD>
<TD>      Convert numeric array into cell array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\robust\robust\@lti\sqrtm.m">sqrtm</a></li></TD>
<TD>         Matrix square root.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="">x</a></li></TD>
<TD></TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> s=<a name="_sub0" href="#_subfunctions" class="code">ssample</a>(A,m,varargin) 
002 <span class="comment">%SSAMPLE  Random sampling from a smoothed empirical distribution </span>
003 <span class="comment">% </span>
004 <span class="comment">% CALL: s = ssample(data,m,options) </span>
005 <span class="comment">%   </span>
006 <span class="comment">%   s      = sampled selection from data,  size m x D </span>
007 <span class="comment">%   data   = data matrix, size N x D (D = # dimensions) </span>
008 <span class="comment">%   m      = sampling size  </span>
009 <span class="comment">%  options = kdeoptions-structure or cellvector of named parameters with </span>
010 <span class="comment">%            corresponding values, see kdeoptset for details.   </span>
011 <span class="comment">%  </span>
012 <span class="comment">%  SSAMPLE(DATA,M) selects a random sample of M data points from the </span>
013 <span class="comment">%  multivariate data-set in the matrix DATA. </span>
014 <span class="comment">% </span>
015 <span class="comment">% Example: </span>
016 <span class="comment">%     data=wnormrnd(0,1,500,1); </span>
017 <span class="comment">%     s = ssample(data,100,'kernel','gauss'); </span>
018 <span class="comment">%     f = kdebin(s);   </span>
019 <span class="comment">%     pdfplot(f),hold on, </span>
020 <span class="comment">%     x = linspace(-5,5); </span>
021 <span class="comment">%     plot(x,wnormpdf(x),'r')   </span>
022    
023 <span class="comment">%  Reference:   </span>
024 <span class="comment">%  B. W. Silverman (1986)  </span>
025 <span class="comment">% 'Density estimation for statistics and data analysis'   </span>
026 <span class="comment">%  Chapman and Hall, pp. 143  </span>
027 <span class="comment">%   </span>
028 <span class="comment">%  Wand, M. P. and Jones, M. C. (1995)  </span>
029 <span class="comment">% 'Density estimation for statistics and data analysis'   </span>
030 <span class="comment">%  Chapman and Hall,  </span>
031  
032 <span class="comment">% History: </span>
033 <span class="comment">% revised pab dec2003   </span>
034 <span class="comment">% Revised by gl 13.07.2000 </span>
035 <span class="comment">%    changed ind generation to avoid stats </span>
036 <span class="comment">% by pab 10.12.1999 </span>
037  
038 <span class="comment">% TODO <span class="comment">% Needs further checking  </span></span>
039    
040    defaultoptions = <a href="kdeoptset.html" class="code" title=" Create or alter KDE OPTIONS structure. ">kdeoptset</a>(<span class="string">'kernel'</span>,<span class="string">'gauss'</span>);   
041 <span class="comment">% If just 'defaults' passed in, return the default options in g </span>
042 <span class="keyword">if</span> ((nargin==1) &amp; (nargout &lt;= 1) &amp;  isequal(A,<span class="string">'defaults'</span>)), 
043   s = defaultoptions; 
044   <span class="keyword">return</span> 
045 <span class="keyword">end</span>    
046  
047 error(nargchk(2,inf, nargin)) 
048 [n d]=size(A); 
049  
050 <span class="keyword">if</span> (nargin&lt;3) 
051   options  = defaultoptions; 
052 <span class="keyword">else</span> 
053   <span class="keyword">switch</span> lower(class(varargin{1})) 
054    <span class="keyword">case</span> {<span class="string">'char'</span>,<span class="string">'struct'</span>}, 
055     options = <a href="kdeoptset.html" class="code" title=" Create or alter KDE OPTIONS structure. ">kdeoptset</a>(defaultoptions,varargin{:}); 
056    <span class="keyword">case</span> {<span class="string">'cell'</span>} 
057     
058       options = <a href="kdeoptset.html" class="code" title=" Create or alter KDE OPTIONS structure. ">kdeoptset</a>(defaultoptions,varargin{1}{:}); 
059    <span class="keyword">otherwise</span> 
060     error(<span class="string">'Invalid options'</span>) 
061   <span class="keyword">end</span> 
062 <span class="keyword">end</span> 
063 kernel   = options.kernel; 
064 h        = options.hs; 
065 alpha    = options.alpha; 
066 L2       = options.L2; 
067 hsMethod = options.hsMethod; 
068 <span class="keyword">if</span> isempty(h)  
069   h=zeros(1,d); 
070 <span class="keyword">end</span> 
071  
072 k3 = []; 
073 <span class="keyword">if</span> isempty(L2) 
074   L2=ones(1,d); <span class="comment">% default no transformation </span>
075   <span class="keyword">elseif</span> iscell(L2)   <span class="comment">% cellarray of non-parametric and parametric transformations </span>
076   Nl2 = length(L2); 
077   <span class="keyword">if</span> ~(Nl2==1|Nl2==d), error(<span class="string">'Wrong size of L2'</span>), <span class="keyword">end</span> 
078   [L22{1:d}] = deal(L2{1:min(Nl2,d)}); 
079   L2 = ones(1,d); <span class="comment">% default no transformation </span>
080   <span class="keyword">for</span> ix=1:d, 
081     <span class="keyword">if</span> length(L22{ix})&gt;1, 
082       k3=[k3 ix];       <span class="comment">% Non-parametric transformation </span>
083     <span class="keyword">else</span>  
084      L2(ix) = L22{ix};  <span class="comment">% Parameter to the Box-Cox transformation </span>
085     <span class="keyword">end</span> 
086   <span class="keyword">end</span> 
087 <span class="keyword">elseif</span> length(L2)==1 
088   L2=L2(:,ones(1,d)); 
089 <span class="keyword">end</span> 
090  
091 amin=min(A); 
092 <span class="keyword">if</span> any((amin(L2~=1)&lt;=0))  , 
093   error(<span class="string">'DATA cannot be negative or zero when L2~=1'</span>) 
094 <span class="keyword">end</span> 
095  
096 <span class="comment">%new call </span>
097 lA = A;   
098  
099 k1=find(L2==0); <span class="comment">% logaritmic transformation </span>
100 <span class="keyword">if</span> any(k1) 
101   lA(:,k1)=log(A(:,k1)); 
102 <span class="keyword">end</span> 
103 k2=find(L2~=0 &amp; L2~=1); <span class="comment">% power transformation </span>
104 <span class="keyword">if</span> any(k2) 
105   lA(:,k2)=sign(L2(ones(n,1),k2)).*A(:,k2).^L2(ones(n,1),k2); 
106 <span class="keyword">end</span> 
107 <span class="keyword">for</span> ix = k3, 
108   lA(:,ix) = <a href="../../wafo/trgauss/tranproc.html" class="code" title=" Transforms process X and up to four derivatives  ">tranproc</a>(A(:,ix),L22{ix}); 
109   lX(:,ix) = <a href="../../wafo/trgauss/tranproc.html" class="code" title=" Transforms process X and up to four derivatives  ">tranproc</a>(X(:,ix),L22{ix}); 
110 <span class="keyword">end</span> 
111  
112 hsiz=size(h); 
113 <span class="keyword">if</span> (min(hsiz)==1)|(d==1) 
114   <span class="keyword">if</span> max(hsiz)==1, 
115     h=h*ones(1,d); 
116   <span class="keyword">else</span> 
117     h=reshape(h,[1 d]); <span class="comment">% make sure it has the correct shape </span>
118   <span class="keyword">end</span> 
119  
120   ind=find(h&lt;=0); 
121   <span class="keyword">if</span> any(ind)      <span class="comment">% If no value of h has been specified by the user then  </span>
122     h(ind)=feval(hsMethod,lA(:,ind),kernel); <span class="comment">% calculate automatic values.   </span>
123   <span class="keyword">end</span> 
124   hmat=diag(h); 
125 <span class="keyword">else</span> 
126   deth=det(h); 
127   <span class="keyword">if</span> deth&lt;=0, 
128     error(<span class="string">'bandwidth matrix h must be positive definit'</span>) 
129   <span class="keyword">end</span> 
130   hmat=h; 
131 <span class="keyword">end</span> 
132  
133 ma=mean(lA); 
134 sa=cov(lA);  
135  
136 E=<a href="mkernelrnd.html" class="code" title=" Random numbers from the Multivariate Kernel Function. ">mkernelrnd</a>(kernel,m,d); 
137 <span class="comment">% ind = unidrnd(n,m,1);   </span>
138 <span class="comment">% new generation of random sample </span>
139 ind = floor(n*rand(m,1))+1; 
140 <span class="keyword">if</span> alpha&gt;0, 
141   tmp=num2cell(lA,1); 
142   opt1 = <a href="kdeoptset.html" class="code" title=" Create or alter KDE OPTIONS structure. ">kdeoptset</a>(<span class="string">'kernel'</span>,kernel,<span class="string">'hs'</span>,h,<span class="string">'alpha'</span>,alpha,<span class="string">'L2'</span>,L2); 
143   [f, hs,lambda]= <a href="kdefun.html" class="code" title="  Kernel Density Estimator. ">kdefun</a>(lA,opt1,tmp{:}); 
144  E=E.*lambda(ind,ones(1,d)); 
145 <span class="keyword">end</span> 
146  
147  <span class="keyword">switch</span> lower(kernel(1:4)) 
148   <span class="keyword">case</span> <span class="string">'epa1'</span>, sk=eye(d)/5; 
149   <span class="keyword">case</span> {<span class="string">'norm'</span>,<span class="string">'gaus'</span>}, sk=eye(d); 
150   <span class="keyword">end</span> 
151  
152 s=ma(ones(m,1),:)+(lA(ind,:)-ma(ones(m,1),:)+ E*hmat)/sqrtm(eye(d)+hmat^2*sk/sa); 
153  
154 <span class="comment">% transforming back </span>
155 <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">% </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
156 <span class="keyword">if</span> any(k1), <span class="comment">% L2=0 i.e. logaritmic transformation </span>
157  s(:,k1)=exp(s(:,k1)); 
158 <span class="keyword">end</span> 
159 <span class="keyword">if</span> any(k2) <span class="comment">% L2~=0 i.e. power transformation </span>
160   <span class="keyword">for</span> ix=k2 
161     s(:,ix)=sign(L2(ix)).*(s(:,ix)).^(1/L2(ix)); 
162   <span class="keyword">end</span> 
163 <span class="keyword">end</span> 
164</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>