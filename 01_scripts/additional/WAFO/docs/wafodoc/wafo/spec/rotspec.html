<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of rotspec</title>
  <meta name="keywords" content="rotspec">
  <meta name="description" content=" Rotate spectrum anti-clockwise around the origin.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">spec</a> &gt; rotspec.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\spec&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>rotspec
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Rotate spectrum anti-clockwise around the origin.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Snew=rotspec(S,phi,rotateGrid) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="rotspec.html" class="code" title=" Rotate spectrum anti-clockwise around the origin. ">ROTSPEC</a> Rotate spectrum anti-clockwise around the origin. 
 
  CALL:  Snew=<a href="rotspec.html" class="code" title=" Rotate spectrum anti-clockwise around the origin. ">rotspec</a>(S,phi,rotateGrid)
 
        Snew = new rotated spectrum
           S = spectrum
         phi = rotation angle (default 0)
  rotateGrid = 1 if rotate grid of Snew physically (thus Snew.phi=0).
               0 if rotate so that only Snew.phi is changed  
                 (the grid is not physically rotated)  (default)
 
  <a href="rotspec.html" class="code" title=" Rotate spectrum anti-clockwise around the origin. ">ROTSPEC</a> Rotates a spectrum anti-clockwise around the origin.
  The spectrum can be of any of the two-dimensional types.
  For spectrum in polar representation:
     newtheta = theta+phi, but circulant such that -pi&lt;newtheta&lt;pi
  For spectrum in Cartesian representation:
     If the grid is rotated physically, the size of it is preserved
     (maybe it must be increased such that no nonzero points are
     affected, but this is not implemented yet: i.e. corners are cut off)
  The spectrum is assumed to be zero outside original grid.
  NB! The routine does not change the type of spectrum, use <a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>
      for this.
 
  Example
   S=<a href="demospec.html" class="code" title=" Loads a precreated spectrum of chosen type">demospec</a>('dir');
   <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S), hold on  
   <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(<a href="rotspec.html" class="code" title=" Rotate spectrum anti-clockwise around the origin. ">rotspec</a>(S,pi/2),'r'), hold off
   
  See also <a href="../../wafo/docs/datastructures.html" class="code" title=" of spectrum, covariance function and density (pdf) in WAFO">datastructures</a>, <a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specfun\cart2pol.m">cart2pol</a></li></TD>
<TD>      Transform Cartesian to polar coordinates.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\polyfun\interp2.m">interp2</a></li></TD>
<TD>       2-D interpolation (table lookup).</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\@fighandle\isfield.m">isfield</a></li></TD>
<TD>       True if field is in structure array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\meshgrid.m">meshgrid</a></li></TD>
<TD>      X and Y arrays for 3-D plots.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specfun\pol2cart.m">pol2cart</a></li></TD>
<TD>      Transform polar to Cartesian coordinates.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter3.html" class="code" title="This is a script file.">Chapter3</a></li></TD>
<TD> % CHAPTER3  Demonstrates distributions of wave characteristics</TD>
</TR>
<TR>
<TD><li><a href="spec2spec.html" class="code" title=" [Snew]=spec2spec(S,newtype,phi,v)">spec2spec</a></li></TD>
<TD> Transforms between different types of spectra</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> Snew=<a name="_sub0" href="#_subfunctions" class="code">rotspec</a>(S,phi,rotateGrid)
002 <span class="comment">%ROTSPEC Rotate spectrum anti-clockwise around the origin. </span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:  Snew=rotspec(S,phi,rotateGrid)</span>
005 <span class="comment">%</span>
006 <span class="comment">%       Snew = new rotated spectrum</span>
007 <span class="comment">%          S = spectrum</span>
008 <span class="comment">%        phi = rotation angle (default 0)</span>
009 <span class="comment">% rotateGrid = 1 if rotate grid of Snew physically (thus Snew.phi=0).</span>
010 <span class="comment">%              0 if rotate so that only Snew.phi is changed  </span>
011 <span class="comment">%                (the grid is not physically rotated)  (default)</span>
012 <span class="comment">%</span>
013 <span class="comment">% ROTSPEC Rotates a spectrum anti-clockwise around the origin.</span>
014 <span class="comment">% The spectrum can be of any of the two-dimensional types.</span>
015 <span class="comment">% For spectrum in polar representation:</span>
016 <span class="comment">%    newtheta = theta+phi, but circulant such that -pi&lt;newtheta&lt;pi</span>
017 <span class="comment">% For spectrum in Cartesian representation:</span>
018 <span class="comment">%    If the grid is rotated physically, the size of it is preserved</span>
019 <span class="comment">%    (maybe it must be increased such that no nonzero points are</span>
020 <span class="comment">%    affected, but this is not implemented yet: i.e. corners are cut off)</span>
021 <span class="comment">% The spectrum is assumed to be zero outside original grid.</span>
022 <span class="comment">% NB! The routine does not change the type of spectrum, use spec2spec</span>
023 <span class="comment">%     for this.</span>
024 <span class="comment">%</span>
025 <span class="comment">% Example</span>
026 <span class="comment">%  S=demospec('dir');</span>
027 <span class="comment">%  wspecplot(S), hold on  </span>
028 <span class="comment">%  wspecplot(rotspec(S,pi/2),'r'), hold off</span>
029 <span class="comment">%  </span>
030 <span class="comment">% See also datastructures, spec2spec</span>
031 
032 <span class="comment">% History:   </span>
033 <span class="comment">% Revised pab mar 2005</span>
034 <span class="comment">% Revised pab Jan 2005</span>
035 <span class="comment">% fixed an illegal else statement</span>
036 <span class="comment">% Revised pab Sept 2004:</span>
037 <span class="comment">%  -Removed old unused code</span>
038 <span class="comment">%  -Added: Example and rotateGrid to input  </span>
039 <span class="comment">% revised IR Aug 2004  </span>
040 <span class="comment">% revised IR, PAB</span>
041 <span class="comment">%  - BUG: Made sure  -pi&lt;newtheta&lt;pi</span>
042 <span class="comment">% by es 17.07.1999</span>
043   
044   
045 <span class="comment">% TODO <span class="comment">% Make physical grid rotation of cartesian coordinates more robust.</span></span>
046 
047 error(nargchk(1,3,nargin))
048 <span class="keyword">if</span> (nargin&lt;2 | isempty(phi))
049   phi =0;
050 <span class="keyword">end</span>
051 <span class="keyword">if</span> (nargin&lt;3 | isempty(rotateGrid))
052   rotateGrid = 0;
053 <span class="keyword">end</span>
054 
055 Snew=S;
056 
057 <span class="keyword">if</span> (~isfield(S,<span class="string">'phi'</span>) | isempty(S.phi)),
058   Snew.phi=0; 
059 <span class="keyword">end</span>
060 Snew.phi=mod(Snew.phi+phi+pi,2*pi)-pi;
061 
062 <span class="keyword">switch</span> lower(S.type(<span class="keyword">end</span>-2:<span class="keyword">end</span>))
063   <span class="keyword">case</span> <span class="string">'dir'</span>,
064    <span class="comment">% any of the directinal types </span>
065    <span class="comment">% Make sure theta is from -pi to pi</span>
066    phi0       = Snew.theta(1)+pi; 
067    Snew.theta = Snew.theta-phi0;
068    
069    <span class="comment">% make sure -pi&lt;phi&lt;pi</span>
070    Snew.phi   = mod(Snew.phi-phi0+pi,2*pi)-pi;
071    <span class="keyword">if</span> (rotateGrid &amp; (Snew.phi~=0))
072      <span class="comment">% Do a physical rotation of spectrum</span>
073      theta = Snew.theta;
074      ntOld = length(theta)
075      nt = ntOld-(theta(1)==theta(<span class="keyword">end</span>));
076      Snew.theta(1:nt) = mod(Snew.theta(1:nt)+Snew.phi+pi,2*pi)-pi;
077      Snew.phi = 0;
078      [Snew.theta,ind] = sort(Snew.theta(:));
079      Snew.S = Snew.S(ind,:);
080      
081      <span class="keyword">if</span> (Snew.theta(1)==-pi)
082         <span class="keyword">if</span> (nt&lt;ntOld)
083           Snew.S(ntOld,:) = Snew.S(1,:);
084         <span class="keyword">else</span>
085            Snew.S(nt+1,:) = Snew.S(1,:);
086         <span class="keyword">end</span>
087      <span class="keyword">elseif</span> (nt&lt;ntOld)
088         Snew.S(ntOld,:)   = []
089         Snew.theta(ntOld) = [];
090      <span class="keyword">end</span>
091    <span class="keyword">end</span>
092     
093  <span class="keyword">case</span> <span class="string">'k2d'</span>, 
094   <span class="comment">% any of the 2D wave number types</span>
095    <span class="comment">%Snew.phi   = mod(Snew.phi+phi+pi,2*pi)-pi;</span>
096   
097   
098   <span class="keyword">if</span> (rotateGrid &amp; (Snew.phi~=0))
099     <span class="comment">% Do a physical rotation of spectrum</span>
100     
101     [k,k2] = meshgrid(S.k,S.k2);
102     [th,r] = cart2pol(k,k2);
103     [k,k2] = pol2cart(th+Snew.phi,r);
104     Sn = interp2(S.k,S.k2,S.S,k,k2);
105     Sn(isnan(Sn))=0.;
106     Snew.S   = Sn;
107     Snew.phi = 0;
108   <span class="keyword">end</span>
109 <span class="keyword">otherwise</span>
110   <span class="comment">%disp('Can only rotate two dimensional spectra')</span>
111 <span class="keyword">end</span>
112   
113 <span class="keyword">return</span>
114 
115</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>