<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of spa2time</title>
  <meta name="keywords" content="spa2time">
  <meta name="description" content=" Transform of spectrum from wave no. to frequency (used in spec2spec)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">wafo</a> &gt; <a href="../index.html">spec</a> &gt; <a href="index.html">private</a> &gt; spa2time.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\spec\private&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>spa2time
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong> Transform of spectrum from wave no. to frequency (used in spec2spec)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong> Sf=spa2time(S,w,theta,g), </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">  <a href="spa2time.html" class="code" title=" Transform of spectrum from wave no. to frequency (used in spec2spec)">SPA2TIME</a> Transform of spectrum from wave no. to frequency (used in <a href="../../../wafo/spec/spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>)
 
  CALL:  Sf = <a href="spa2time.html" class="code" title=" Transform of spectrum from wave no. to frequency (used in spec2spec)">spa2time</a>(S,w,theta,g)
 
    Sf = frequency or directional spectrum, which depends on input
    S  = spectrum struct
   w,theta = lag of output (default depending on input spectrum)
    g  = constant of <a href="../../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a> (default see <a href="../../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>)
 
  Transforms a wave number spectrum to a frequency or directional spectrum 
  Input 1D gives output 1D, input 2D gives output 2D
  Rotation, transformation etc is preserved
 
  See also definitions, <a href="../../../wafo/spec/spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../../wafo/misc/gravity.html" class="code" title=" g=gravity(phi)">gravity</a></li></TD>
<TD>  returns the constant acceleration of gravity</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/k2w.html" class="code" title=" [w,th]=k2w(k,k2,h,g,u,u2)">k2w</a></li></TD>
<TD> Translates from wave number to frequency</TD>
</TR>
<TR>
<TD><li><a href="../../../wafo/spec/w2k.html" class="code" title=" [k,k2,ind]=w2k(w,th,h,g),">w2k</a></li></TD>
<TD> Translates from frequency to wave number</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\polyfun\interp1.m">interp1</a></li></TD>
<TD>       1-D interpolation (table lookup)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\polyfun\interp2.m">interp2</a></li></TD>
<TD>       2-D interpolation (table lookup).</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\@fighandle\isfield.m">isfield</a></li></TD>
<TD>       True if field is in structure array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\linspace.m">linspace</a></li></TD>
<TD>      Linearly spaced vector.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\rmfield.m">rmfield</a></li></TD>
<TD>       Remove fields from a structure array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmpi.bi">strcmpi</a></li></TD>
<TD>       Compare strings ignoring case.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../../wafo/spec/spec2spec.html" class="code" title=" [Snew]=spec2spec(S,newtype,phi,v)">spec2spec</a></li></TD>
<TD> Transforms between different types of spectra</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code"> dk=dkdw(w,k,h,g)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> Sf=<a name="_sub0" href="#_subfunctions" class="code">spa2time</a>(S,w,theta,g),
002 <span class="comment">% SPA2TIME Transform of spectrum from wave no. to frequency (used in spec2spec)</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:  Sf = spa2time(S,w,theta,g)</span>
005 <span class="comment">%</span>
006 <span class="comment">%   Sf = frequency or directional spectrum, which depends on input</span>
007 <span class="comment">%   S  = spectrum struct</span>
008 <span class="comment">%  w,theta = lag of output (default depending on input spectrum)</span>
009 <span class="comment">%   g  = constant of gravity (default see gravity)</span>
010 <span class="comment">%</span>
011 <span class="comment">% Transforms a wave number spectrum to a frequency or directional spectrum </span>
012 <span class="comment">% Input 1D gives output 1D, input 2D gives output 2D</span>
013 <span class="comment">% Rotation, transformation etc is preserved</span>
014 <span class="comment">%</span>
015 <span class="comment">% See also definitions, spec2spec</span>
016 
017 <span class="comment">% Tested on Matlab 5.3</span>
018 <span class="comment">% History: revised by es 29.11.1999: norm. in both x and y (length(g) 1 OR 2)</span>
019 <span class="comment">%          by es 99.08.17</span>
020 
021 <span class="keyword">if</span> nargin&lt;3
022   <span class="keyword">if</span> isfield(S,<span class="string">'g'</span>)
023     g=S.g;
024   <span class="keyword">else</span>
025     g=<a href="../../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>;
026   <span class="keyword">end</span>
027 <span class="keyword">end</span>
028 
029 <span class="keyword">if</span> ~(strcmpi(S.type(<span class="keyword">end</span>-2:<span class="keyword">end</span>),<span class="string">'k1d'</span>)|strcmpi(S.type(<span class="keyword">end</span>-2:<span class="keyword">end</span>),<span class="string">'k2d'</span>))
030   error(<span class="string">'Spectrum already in time domain'</span>)
031 <span class="keyword">end</span>
032 Sf=S;
033 k=S.k(:)';
034 Sk=S.S;
035 Sf=rmfield(Sf,<span class="string">'k'</span>);
036 <span class="comment">%if isfield(Sf,'phi')</span>
037 <span class="comment">%  Sf=rmfield(Sf,'phi'); <span class="comment">% a rotation has no sense in freq-spectrum</span></span>
038 <span class="comment">%end</span>
039 <span class="keyword">if</span> nargin&lt;2|isempty(w)
040   w=linspace(0,<a href="../../../wafo/spec/k2w.html" class="code" title=" Translates from wave number to frequency">k2w</a>(k(<span class="keyword">end</span>),0,S.h,g),length(k))';
041 <span class="keyword">else</span>
042   <span class="keyword">if</span> length(w)==1 <span class="comment">% then interpret w as dw (step length)</span>
043     w=(0:length(k)-1)*w;
044   <span class="keyword">end</span>
045 <span class="keyword">end</span>
046 w=w(:)'; <span class="comment">% row vector</span>
047 Sf.w=w;
048 
049 <span class="keyword">if</span> strcmpi(S.type(<span class="keyword">end</span>-2:<span class="keyword">end</span>),<span class="string">'k1d'</span>)
050 
051   kw=<a href="../../../wafo/spec/w2k.html" class="code" title=" Translates from frequency to wave number">w2k</a>(w,0,S.h,g(1));
052   in=(kw&gt;k(1))&amp;(kw&lt;=k(<span class="keyword">end</span>));
053   Gf=zeros(size(k));
054   Gf(in)=interp1(k,Sk,kw(in));
055   Sf.S=zeros(size(w));
056   Sf.S=Gf.*<a href="#_sub1" class="code" title="sub  dk=dkdw(w,k,h,g)">dkdw</a>(w,kw,S.h,g(1));
057   Sf.type=<span class="string">'freq'</span>;
058 <span class="keyword">else</span>
059   <span class="keyword">if</span> S.h&lt;inf
060     disp(<span class="string">'This transformation for finite depth is not available yet'</span>)
061     <span class="keyword">return</span>
062   <span class="keyword">end</span>
063   <span class="keyword">if</span> nargin&lt;3|isempty(theta)
064     <span class="keyword">if</span> S.k(1)&lt;0
065       theta=linspace(-pi,pi,2^7+1);
066     <span class="keyword">else</span>
067       theta=linspace(-pi/2,pi/2,2^6+1);
068     <span class="keyword">end</span>
069   <span class="keyword">end</span>
070   theta=theta(:);
071   Sf.theta=theta;
072   W=ones(size(theta))*w;
073   TH=theta*ones(size(w));
074   KW=W.^2;
075   K=KW.*cos(TH)/g(1);  <span class="comment">% non-equidistant K derived from (W,TH)</span>
076   K2=KW.*sin(TH)/g(<span class="keyword">end</span>); <span class="comment">% non-equidistant K2 derived from (W,TH)</span>
077   Gk=zeros(size(W));
078   in=(K&gt;k(1))&amp;(K&lt;=k(<span class="keyword">end</span>))&amp;(K2&gt;S.k2(1))&amp;(K2&lt;=S.k2(<span class="keyword">end</span>));
079   Gk(in)=interp2(k,S.k2,Sk,K(in),K2(in),<span class="string">'*linear'</span>);
080   Sf.S=Gk.*W.^3*2/g(1)/g(<span class="keyword">end</span>);  <span class="comment">% directional spectrum</span>
081   Sf=rmfield(Sf,<span class="string">'k2'</span>);
082   <span class="keyword">if</span> strcmpi(S.type,<span class="string">'rotk2d'</span>)
083     Sf.type=<span class="string">'rotdir'</span>;
084   <span class="keyword">else</span>
085     Sf.type=<span class="string">'dir'</span>;
086   <span class="keyword">end</span>
087 <span class="keyword">end</span>
088 <span class="keyword">return</span>
089 <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
090 
091 <span class="keyword">function</span> dk=<a name="_sub1" href="#_subfunctions" class="code">dkdw</a>(w,k,h,g)
092 
093 <span class="keyword">if</span> h==inf
094   dk=2*w/g;
095 <span class="keyword">else</span>
096   dk=zeros(size(w));
097   dk(k&gt;0)=2*w(k&gt;0)./(g*tanh(k(k&gt;0)*h)+g*h*k(k&gt;0).*(1-tanh(k(k&gt;0)*h).^2));
098 <span class="keyword">end</span>
099 <span class="keyword">return</span>
100</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>