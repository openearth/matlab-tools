<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of spec2spec</title>
  <meta name="keywords" content="spec2spec">
  <meta name="description" content=" Transforms between different types of spectra">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">spec</a> &gt; spec2spec.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\spec&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>spec2spec
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Transforms between different types of spectra</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [Snew]=spec2spec(S,newtype,phi,v) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">SPEC2SPEC</a> Transforms between different types of spectra
 
  CALL:  Snew = <a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(S,newtype,phi,v)
 
      Snew = spectrum with new type
         S = spectrum 
   newtype = new type given as a string, the allowed types: 
             'dir','freq','k2d','k1d','encdir','enc',
             (default S.type, i.e. no change)
           
   In special cases, specify also:
       phi = rotation angle of the cordinate system (x,y) counter-clockwise 
             (rotation of spectrum clockwise), e.g. direction of ship when
             encountered spectrum is to be computed; the wavenumber 
             spectrum along a line going through origin and with 
             angle phi (default 0).
         v = speed of ship, when transforming to an encountered spectrum
             (default 0)
   
  <a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">SPEC2SPEC</a> performs a change of variables from the type given in input
  spectrum S, to the given 'newtype', when possible.
  Remark1: the field .note is not changed, but may need an update by hand.
  Remark2: the encountered spectrum is derived by means of numerical
  variable change, hence dense spectrum is needed to get good accuracy of
  the transformation. For negative velocities the enc. spectrum has a
  singularity hence <a href="spec2mom.html" class="code" title=" Calculates spectral moments from spectrum">spec2mom</a> may give uncorrect values for the moments.
   
  Example: 
     S    = <a href="demospec.html" class="code" title=" Loads a precreated spectrum of chosen type">demospec</a>('dir')
     Snew = <a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(S,'enc',pi/6,10)
 
  See also  <a href="../../wafo/docs/datastructures.html" class="code" title=" of spectrum, covariance function and density (pdf) in WAFO">datastructures</a>, <a href="rotspec.html" class="code" title=" Rotate spectrum anti-clockwise around the origin. ">rotspec</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/spec/private/dir2enc.html" class="code" title=" Snew=dir2enc(S,d,v)">dir2enc</a></li></TD>
<TD> Transform a dir. spectrum to an encountered. (Used in spec2spec)</TD>
</TR>
<TR>
<TD><li><a href="rotspec.html" class="code" title=" Snew=rotspec(S,phi,rotateGrid)">rotspec</a></li></TD>
<TD> Rotate spectrum anti-clockwise around the origin.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/misc/simpson.html" class="code" title=" [area,epsi,a,b] = simpson(x,f,dim)">simpson</a></li></TD>
<TD> Numerical integration with the Simpson method</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/spec/private/spa2time.html" class="code" title=" Sf=spa2time(S,w,theta,g),">spa2time</a></li></TD>
<TD> Transform of spectrum from wave no. to frequency (used in spec2spec)</TD>
</TR>
<TR>
<TD><li><a href="spec2spec.html" class="code" title=" [Snew]=spec2spec(S,newtype,phi,v)">spec2spec</a></li></TD>
<TD> Transforms between different types of spectra</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/spec/private/time2spa.html" class="code" title=" Sk=time2spa(S,k,k2,g,rate)">time2spa</a></li></TD>
<TD> Transform of spectrum from frequency to wave no. (used in spec2spec)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\timefun\datestr.m">datestr</a></li></TD>
<TD>       String representation of date.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\timefun\now.m">now</a></li></TD>
<TD>           Current date and time as date number.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\rmfield.m">rmfield</a></li></TD>
<TD>       Remove fields from a structure array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmpi.bi">strcmpi</a></li></TD>
<TD>       Compare strings ignoring case.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter2.html" class="code" title="This is a script file.">Chapter2</a></li></TD>
<TD> % CHAPTER2 Modelling random loads and stochastic waves</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/spec/private/dir2enc.html" class="code" title=" Snew=dir2enc(S,d,v)">dir2enc</a></li></TD>
<TD> Transform a dir. spectrum to an encountered. (Used in spec2spec)</TD>
</TR>
<TR>
<TD><li><a href="dspec2char.html" class="code" title=" [ch,chtext] = dspec2char(S,varargin)">dspec2char</a></li></TD>
<TD> Evaluates directional spectral characteristics</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/spec/private/dspec2dcov.html" class="code" title=" R=dspec2dcov(S,nr,Nt,rate,Nx,Ny,dx,dy)">dspec2dcov</a></li></TD>
<TD> Return covariance function given a directional spectrum</TD>
</TR>
<TR>
<TD><li><a href="scalespec.html" class="code" title=" [Sn,mn,mom]=scalespec(So,m0n,m2n,plotflag)">scalespec</a></li></TD>
<TD>  Scale spectral density so that the moments equals m0,m2.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wsim/seasim.html" class="code" title=" [Y,Mv]=seasim(spec,Nx,Ny,Nt,dx,dy,dt,fftdim,plotflag);">seasim</a></li></TD>
<TD> Spectral simulation of a Gaussian sea, 2D (x,t) or 3D (x,y,t)</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2AcAt.html" class="code" title=" [f] = spec2AcAt(spec,utc,def,paramtc,paramtt,paramt,h1,h2,nit,speed,bound)">spec2AcAt</a></li></TD>
<TD>   Evaluates survival function R(h1,h2)=P(Ac>h1,At>h2).</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2Acdf.html" class="code" title=" [f] = spec2Acdf(spec,utc,def,paramt,h,nit,speed,bound)">spec2Acdf</a></li></TD>
<TD>  Evaluates cdf of crests P(Ac<=h) or troughs P(At<=h).</TD>
</TR>
<TR>
<TD><li><a href="spec2bw.html" class="code" title=" bw = spec2bw(S,fact)">spec2bw</a></li></TD>
<TD> Evaluates some spectral bandwidth and irregularity factors</TD>
</TR>
<TR>
<TD><li><a href="spec2char.html" class="code" title=" [ch,R1,chtext,R]=spec2char(S,fact,T)">spec2char</a></li></TD>
<TD>  Evaluates spectral characteristics and their covariance</TD>
</TR>
<TR>
<TD><li><a href="spec2cov.html" class="code" title=" R = spec2cov(S,nr,Nt,rate,Nx,Ny,dx,dy)">spec2cov</a></li></TD>
<TD> Computes covariance function and its derivatives</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2mmtpdf.html" class="code" title=" f = spec2mmtpdf(spec,utc,def,paramt,paramu,options,bound)">spec2mmtpdf</a></li></TD>
<TD> Calculates joint density of Maximum, minimum and period.</TD>
</TR>
<TR>
<TD><li><a href="spec2mom.html" class="code" title=" [m,mtext] = spec2mom(S,nr,vari,even)">spec2mom</a></li></TD>
<TD> Calculates spectral moments from spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2skew.html" class="code" title=" [skew, kurt, ma, sa, Hs ,Hd]=spec2skew(S,h,method)">spec2skew</a></li></TD>
<TD> Estimates the moments of 2'nd order non-linear waves</TD>
</TR>
<TR>
<TD><li><a href="spec2spec.html" class="code" title=" [Snew]=spec2spec(S,newtype,phi,v)">spec2spec</a></li></TD>
<TD> Transforms between different types of spectra</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2tccpdf.html" class="code" title=" [f] = spec2tccpdf(spec,utc,def,paramt,h1,h2,nit,speed,bound,plotflag)">spec2tccpdf</a></li></TD>
<TD> Evaluates densities of wave period Tcc, wave lenght Lcc.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2thpdf.html" class="code" title=" f = spec2thpdf(spec,utc,def,paramt,h,options,plotflag)">spec2thpdf</a></li></TD>
<TD> Joint density of amplitude and period/wave-length characteristics</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2tpdf.html" class="code" title=" [f] = spec2tpdf(spec,utc,def,paramt,h,nit,speed,bound,plotflag)">spec2tpdf</a></li></TD>
<TD> Evaluates densities for crest-,trough-period, length.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2tpdf2.html" class="code" title=" [f] = spec2tpdf2(spec,utc,def,paramt,varargin)">spec2tpdf2</a></li></TD>
<TD> Evaluates densities for various wave periods or wave lengths</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/wafodemo/wafofig7.html" class="code" title=" wafofig7">wafofig7</a></li></TD>
<TD>  Joint distribution (pdf) of crest wavelength, Lc, and crest amplitude, Ac</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/wafodemo/wafofig8.html" class="code" title=" wafofig8">wafofig8</a></li></TD>
<TD>  Joint distribution (pdf) of crest wavelength, Lc, and crest amplitude, Ac for extremal waves</TD>
</TR>
<TR>
<TD><li><a href="wnormspec.html" class="code" title=" [S,mn4,m0,m2,m4,m1]=wnormspec(spectrum,m0,m2,plotflag)">wnormspec</a></li></TD>
<TD> Normalize a spectral density such that m0=m2=1</TD>
</TR>
<TR>
<TD><li><a href="wspecplot.html" class="code" title=" wspecplot(S,varargin)">wspecplot</a></li></TD>
<TD> Plot a spectral density</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [Snew]=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra"><a name="_sub0" href="#_subfunctions" class="code">spec2spec</a>spec2spec</a>(S,newtype,phi,v)
002 <span class="comment">%SPEC2SPEC Transforms between different types of spectra</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:  Snew = spec2spec(S,newtype,phi,v)</span>
005 <span class="comment">%</span>
006 <span class="comment">%     Snew = spectrum with new type</span>
007 <span class="comment">%        S = spectrum </span>
008 <span class="comment">%  newtype = new type given as a string, the allowed types: </span>
009 <span class="comment">%            'dir','freq','k2d','k1d','encdir','enc',</span>
010 <span class="comment">%            (default S.type, i.e. no change)</span>
011 <span class="comment">%          </span>
012 <span class="comment">%  In special cases, specify also:</span>
013 <span class="comment">%      phi = rotation angle of the cordinate system (x,y) counter-clockwise </span>
014 <span class="comment">%            (rotation of spectrum clockwise), e.g. direction of ship when</span>
015 <span class="comment">%            encountered spectrum is to be computed; the wavenumber </span>
016 <span class="comment">%            spectrum along a line going through origin and with </span>
017 <span class="comment">%            angle phi (default 0).</span>
018 <span class="comment">%        v = speed of ship, when transforming to an encountered spectrum</span>
019 <span class="comment">%            (default 0)</span>
020 <span class="comment">%  </span>
021 <span class="comment">% SPEC2SPEC performs a change of variables from the type given in input</span>
022 <span class="comment">% spectrum S, to the given 'newtype', when possible.</span>
023 <span class="comment">% Remark1: the field .note is not changed, but may need an update by hand.</span>
024 <span class="comment">% Remark2: the encountered spectrum is derived by means of numerical</span>
025 <span class="comment">% variable change, hence dense spectrum is needed to get good accuracy of</span>
026 <span class="comment">% the transformation. For negative velocities the enc. spectrum has a</span>
027 <span class="comment">% singularity hence spec2mom may give uncorrect values for the moments.</span>
028 <span class="comment">%  </span>
029 <span class="comment">% Example: </span>
030 <span class="comment">%    S    = demospec('dir')</span>
031 <span class="comment">%    Snew = spec2spec(S,'enc',pi/6,10)</span>
032 <span class="comment">%</span>
033 <span class="comment">% See also  datastructures, rotspec</span>
034 
035 <span class="comment">% Tested on: Matlab 5.3  </span>
036 <span class="comment">% History: </span>
037 <span class="comment">% revised by pab 21.09.2004:</span>
038 <span class="comment">%  -Moved code to rotspec + small cosmetics fixes   </span>
039 <span class="comment">% revised by IR 27.06.2004: implemented freq -&gt; enc.</span>
040 <span class="comment">% revised by IR 03.04.2001: Major changes.</span>
041 <span class="comment">% revised by jr 31.03.2001</span>
042 <span class="comment">% - case 'freq' -&gt; 'enc': Changed text in error message</span>
043 <span class="comment">% revised by es 05.06.00: encdir -&gt; freq results in enc</span>
044 <span class="comment">% revised by es 25.05.00: return if nargin&lt;2 (default for newtype)  </span>
045 <span class="comment">% revised by es 24.05.00: removed Message: New type identical to old type</span>
046 <span class="comment">% revised by es 09.02.2000: more corrections of change to 'k1d'</span>
047 <span class="comment">% revised by es 28.01.2000: correction and improvement of change to 'k1d'  </span>
048 <span class="comment">% by es 13.08.99</span>
049 
050 error(nargchk(1,4,nargin))  
051 <span class="keyword">if</span> nargin&lt;0|isempty(S)
052   error(<span class="string">'Needs an input spectrum'</span>)
053 <span class="keyword">end</span>
054 
055 Snew = S; 
056 <span class="keyword">if</span> (nargin&lt;2|isempty(newtype))
057   <span class="keyword">return</span>
058 <span class="keyword">end</span>
059 <span class="keyword">if</span> (nargin&lt;3 | isempty(phi))
060   phi=0.;
061 <span class="keyword">end</span>
062 <span class="keyword">if</span> (nargin&lt;4|isempty(v))
063   v=0;
064 <span class="keyword">end</span>
065 
066 <span class="comment">% New call: pab 21Sep2004</span>
067 Snew = <a href="rotspec.html" class="code" title=" Rotate spectrum anti-clockwise around the origin. ">rotspec</a>(Snew,phi);
068 <span class="comment">% Old call: pab 21Sep2004</span>
069 <span class="comment">%if ~isfield(Snew,'phi') | isempty(Snew.phi), </span>
070 <span class="comment">%  Snew.phi=0;</span>
071 <span class="comment">%end</span>
072 <span class="comment">%</span>
073 <span class="comment">%Snew.phi=mod(Snew.phi+phi+pi,2*pi)-pi;  <span class="comment">%such that -pi&lt;phi&lt;pi</span></span>
074 
075 
076 newtype=lower(newtype);
077 <span class="keyword">if</span> strcmpi(S.type,newtype)
078 <span class="comment">%   disp(' Message: New type identical to old type')</span>
079   <span class="keyword">return</span>
080 <span class="keyword">end</span>
081 
082 <span class="keyword">if</span> ~any(strcmpi(newtype,{<span class="string">'dir'</span>,<span class="string">'freq'</span>,<span class="string">'k2d'</span>,<span class="string">'k1d'</span>,<span class="string">'encdir'</span>,<span class="string">'enc'</span>}))    
083   <span class="comment">% Check if newtype is a proper type</span>
084   error(<span class="string">'Not known new type, check spelling'</span>)
085 <span class="keyword">end</span>
086 
087 indim=sum(size(S.S)&gt;1); <span class="comment">%dimension of old spectrum</span>
088 <span class="keyword">if</span> indim==1 <span class="comment">%then new spectrum can not have dimension larger</span>
089   <span class="keyword">if</span> strcmp(newtype(<span class="keyword">end</span>-2:<span class="keyword">end</span>),<span class="string">'dir'</span>)|strcmp(newtype(<span class="keyword">end</span>-2:<span class="keyword">end</span>),<span class="string">'k2d'</span>)
090     error(<span class="string">'Impossible to transform from one dimension to two'</span>)
091   <span class="keyword">end</span>
092 <span class="keyword">end</span>
093 
094 
095 
096 <span class="keyword">switch</span> lower(Snew.type)
097   <span class="keyword">case</span> <span class="string">'dir'</span>
098    <span class="keyword">switch</span> newtype
099     <span class="keyword">case</span> <span class="string">'freq'</span> <span class="comment">% from 'dir'</span>
100      Snew.S=<a href="../../wafo/misc/simpson.html" class="code" title=" Numerical integration with the Simpson method">simpson</a>(Snew.theta(:),Snew.S); 
101      <span class="comment">%integrate out angle but if the spectrum is</span>
102      <span class="comment">%true directional spectrum then</span>
103      <span class="comment">%one should just take SS.S(1,:)</span>
104         Snew=rmfield(Snew,<span class="string">'theta'</span>);
105         Snew.type=<span class="string">'freq'</span>;
106       <span class="keyword">case</span> <span class="string">'k2d'</span> <span class="comment">% from 'dir'</span>
107         Snew=<a href="../../wafo/spec/private/time2spa.html" class="code" title=" Transform of spectrum from frequency to wave no. (used in spec2spec)">time2spa</a>(Snew);
108       <span class="keyword">case</span> <span class="string">'k1d'</span> <span class="comment">% from 'dir'</span>
109         Snew=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Snew,<span class="string">'k2d'</span>);
110         Snew=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Snew,<span class="string">'k1d'</span>);
111       <span class="keyword">case</span> <span class="string">'encdir'</span> <span class="comment">% from 'dir'</span>
112         Snew=<a href="../../wafo/spec/private/dir2enc.html" class="code" title=" Transform a dir. spectrum to an encountered. (Used in spec2spec)">dir2enc</a>(Snew,2,v);
113       <span class="keyword">case</span> <span class="string">'enc'</span> <span class="comment">% from 'dir'</span>
114         Snew=<a href="../../wafo/spec/private/dir2enc.html" class="code" title=" Transform a dir. spectrum to an encountered. (Used in spec2spec)">dir2enc</a>(Snew,1,v);
115     <span class="keyword">end</span>   
116    <span class="keyword">case</span> <span class="string">'freq'</span>
117     <span class="keyword">switch</span> newtype
118       <span class="keyword">case</span> <span class="string">'k1d'</span> <span class="comment">% from 'freq'</span>
119         Snew=<a href="../../wafo/spec/private/time2spa.html" class="code" title=" Transform of spectrum from frequency to wave no. (used in spec2spec)">time2spa</a>(Snew);
120       <span class="keyword">case</span> <span class="string">'enc'</span> <span class="comment">% from freq</span>
121           Snew=<a href="../../wafo/spec/private/dir2enc.html" class="code" title=" Transform a dir. spectrum to an encountered. (Used in spec2spec)">dir2enc</a>(Snew,1,v);
122       <span class="keyword">otherwise</span>
123         error(<span class="string">'Specified transformation not possible'</span>)
124     <span class="keyword">end</span>
125   <span class="keyword">case</span> <span class="string">'k2d'</span>
126    <span class="keyword">switch</span> newtype
127     <span class="keyword">case</span> <span class="string">'dir'</span> <span class="comment">% from 'k2d'</span>
128      Snew=<a href="../../wafo/spec/private/spa2time.html" class="code" title=" Transform of spectrum from wave no. to frequency (used in spec2spec)">spa2time</a>(Snew);
129     <span class="keyword">case</span> <span class="string">'freq'</span> <span class="comment">% from 'k2d'</span>
130      Snew=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Snew,<span class="string">'dir'</span>); <span class="comment">%transform via dir (k1d better???)</span>
131      Snew=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Snew,<span class="string">'freq'</span>);
132      
133     <span class="keyword">case</span> <span class="string">'k1d'</span> 
134      <span class="comment">% from 'k2d'</span>
135      <span class="comment">% For spectrum in Cartesian representation:</span>
136      <span class="comment">%    The grid is rotated, the size of it is preserved</span>
137      <span class="comment">%    (maybe it must be increased such that no nonzero points are</span>
138      <span class="comment">%    affected, but this is not inplemented yet: i.e. corners are cut off)</span>
139      <span class="comment">% The spectrum is assumed to be zero outside original grid.</span>
140 
141      <span class="comment">% PAB 2004: old calls kept just in case:</span>
142      <span class="comment">%[k,k2] = meshgrid(S.k,S.k2);</span>
143      <span class="comment">%[th,r] = cart2pol(k,k2);</span>
144      <span class="comment">%phi=Snew.phi;</span>
145      <span class="comment">%[k,k2] = pol2cart(th+phi,r);</span>
146      <span class="comment">%Sn     = interp2(S.k,S.k2,S.S,k,k2);</span>
147      <span class="comment">%Sn(isnan(Sn))=0.;</span>
148      <span class="comment">%Snew.S = Sn;</span>
149      
150      physicallyRotateGrid = 1;
151      Snew = <a href="rotspec.html" class="code" title=" Rotate spectrum anti-clockwise around the origin. ">rotspec</a>(Snew,0,physicallyRotateGrid);
152      
153      Snew.S = <a href="../../wafo/misc/simpson.html" class="code" title=" Numerical integration with the Simpson method">simpson</a>(Snew.k2(:),Snew.S).'; <span class="comment">%integrate out second variable</span>
154      Snew   = rmfield(Snew,<span class="string">'k2'</span>);
155      Snew.type = <span class="string">'k1d'</span>;
156      <span class="keyword">if</span> (Snew.k(1)&lt;0)
157        Snew.S = Snew.S(Snew.k&gt;=0)+flipud(Snew.S(Snew.k&lt;=0));
158        Snew.S = Snew.S';
159        Snew.k = Snew.k(Snew.k&gt;=0);
160      <span class="keyword">end</span>
161      Snew.type=<span class="string">'k1d'</span>;
162     <span class="keyword">case</span> <span class="string">'encdir'</span> <span class="comment">% from 'k2d'</span>
163      Snew=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Snew,<span class="string">'dir'</span>);
164      Snew=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Snew,<span class="string">'encdir'</span>,v);
165     <span class="keyword">case</span> <span class="string">'enc'</span> <span class="comment">% from 'k2d'</span>
166      Snew=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Snew,<span class="string">'dir'</span>);
167      Snew=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Snew,<span class="string">'enc'</span>,v);
168     <span class="keyword">otherwise</span> 
169      error(<span class="string">'Specified transformation not possible'</span>)
170    <span class="keyword">end</span>
171  <span class="keyword">case</span> <span class="string">'k1d'</span>
172   <span class="keyword">switch</span> newtype
173    <span class="keyword">case</span> <span class="string">'freq'</span> <span class="comment">% from 'k1d'</span>
174     Snew=<a href="../../wafo/spec/private/spa2time.html" class="code" title=" Transform of spectrum from wave no. to frequency (used in spec2spec)">spa2time</a>(Snew);
175    <span class="keyword">case</span> <span class="string">'enc'</span> <span class="comment">% from 'k1d'</span>
176     Snew=<a href="../../wafo/spec/private/spa2time.html" class="code" title=" Transform of spectrum from wave no. to frequency (used in spec2spec)">spa2time</a>(Snew);
177     Snew=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(Snew,<span class="string">'enc'</span>,v);
178    <span class="keyword">otherwise</span>      
179     error(<span class="string">'Specified transformation not possible'</span>)
180   <span class="keyword">end</span>
181 
182  <span class="keyword">case</span> <span class="string">'encdir'</span>
183   <span class="keyword">switch</span> newtype
184    <span class="keyword">case</span> <span class="string">'enc'</span> <span class="comment">% from 'encdir'</span>
185     Snew.S=<a href="../../wafo/misc/simpson.html" class="code" title=" Numerical integration with the Simpson method">simpson</a>(Snew.theta(:),Snew.S); <span class="comment">% integrate out direction</span>
186     Snew.type=<span class="string">'enc'</span>;
187     Snew=rmfield(Snew,<span class="string">'theta'</span>);
188    <span class="keyword">otherwise</span>
189     error(<span class="string">'Specified transformation not possible or not yet available'</span>)
190   <span class="keyword">end</span>
191  <span class="keyword">case</span> <span class="string">'enc'</span>
192   <span class="keyword">switch</span> newtype 
193    <span class="keyword">case</span> <span class="string">'freq'</span> <span class="comment">% from 'enc'  </span>
194     Snew.type=<span class="string">'freq'</span>;
195    <span class="keyword">otherwise</span>
196     error(<span class="string">'Specified transformation not possible or not yet available'</span>)
197   <span class="keyword">end</span>
198 <span class="keyword">end</span>
199 Snew.date=datestr(now);
200</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>