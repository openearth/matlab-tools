<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of wspecplot</title>
  <meta name="keywords" content="wspecplot">
  <meta name="description" content=" Plot a spectral density">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">spec</a> &gt; wspecplot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\spec&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>wspecplot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Plot a spectral density</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> wspecplot(S,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">WSPECPLOT</a> Plot a spectral density  
  
  CALL:  <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S,plotflag,linetype)  
  
     S       = an array of spectral density structs: 
               1D  (see <a href="../../wafo/onedim/dat2spec.html" class="code" title=" Estimate one-sided spectral density from data.">dat2spec</a>) 
               2D  (see <a href="createspec.html" class="code" title=" Spectrum structure constructor">createspec</a>) 
    1D: 
    plotflag = 1 plots the density, S, (default) 
               2 plot 10log10(S) 
            3 plots both the above plots  
    2D: 
    Directional spectra: S(w,theta), S(f,theta)              
    plotflag = 1 polar plot S (default) 
               2 plots spectral density and the directional  
                 <a href="spreading.html" class="code" title=" Directional spreading functions">spreading</a>, int S(w,theta) dw or int S(f,theta) df 
               3 plots spectral density and the directional  
                 <a href="spreading.html" class="code" title=" Directional spreading functions">spreading</a>, int S(w,theta)/S(w) dw or int S(f,theta)/S(f) df 
               4 mesh of S 
               5 mesh of S in polar coordinates   
               6 contour plot of S 
               7 filled contour plot of S 
    Wavenumber spectra: S(k1,k2) 
    plotflag = 1 contour plot of S (default) 
               2 filled contour plot of S 
    lintype : specify color and lintype, see PLOT for possibilities. 
  
  NOTE: - lintype may be given anywhere after S. 
        <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a> adds  point-and-click editing of all the text  
        objects (title, xlabel, ylabel, etc ) of the current figure 
  
  Examples 
   S = <a href="demospec.html" class="code" title=" Loads a precreated spectrum of chosen type">demospec</a>('dir'); S2 = <a href="mkdspec.html" class="code" title=" Make a directional spectrum">mkdspec</a>(<a href="jonswap.html" class="code" title=" Calculates (and plots) a JONSWAP spectral density">jonswap</a>,<a href="spreading.html" class="code" title=" Directional spreading functions">spreading</a>); 
   <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S,2), hold on 
   <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S,3,'g')  % Same as previous fig. due to frequency independent <a href="spreading.html" class="code" title=" Directional spreading functions">spreading</a> 
   <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S2,2,'r') % Not the same as previous figs. due to frequency dependent <a href="spreading.html" class="code" title=" Directional spreading functions">spreading</a> 
   <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S2,3,'m') 
   % transform from angular frequency and radians to frequency and degrees 
   Sf = <a href="ttspec.html" class="code" title=" Toggle Transform between angular frequency and frequency spectrum">ttspec</a>(S,'f','d'); clf 
   <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(Sf,2), 
  
  See also  <a href="../../wafo/onedim/dat2spec.html" class="code" title=" Estimate one-sided spectral density from data.">dat2spec</a>, <a href="createspec.html" class="code" title=" Spectrum structure constructor">createspec</a>, <a href="../../wafo/misc/simpson.html" class="code" title=" Numerical integration with the Simpson method">simpson</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/misc/clevels.html" class="code" title=" [CL,c]=clevels(c)">clevels</a></li></TD>
<TD>  Extract the contour levels from the contour matrix</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/misc/fcolorbar.html" class="code" title=" [h00,h1]=fcolorbar(D,L,label,W,hand)">fcolorbar</a></li></TD>
<TD>  Display colorbar with discrete color axis for filled contour plot</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/misc/figtext.html" class="code" title=" H = figtext(x,y,T,x_unit,y_unit,x_justify,y_justify,varargin)">figtext</a></li></TD>
<TD> Places text in figure window.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/misc/findpeaks.html" class="code" title=" [indx, indy] = findpeaks(S,Np,min_h,min_p)">findpeaks</a></li></TD>
<TD> find peaks of vector or matrix possibly rainflow filtered</TD>
</TR>
<TR>
<TD><li><a href="freqtype.html" class="code" title=" ftype=freqtype(S)">freqtype</a></li></TD>
<TD> returns the frequency type of a Spectral density struct.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/misc/simpson.html" class="code" title=" [area,epsi,a,b] = simpson(x,f,dim)">simpson</a></li></TD>
<TD> Numerical integration with the Simpson method</TD>
</TR>
<TR>
<TD><li><a href="spec2spec.html" class="code" title=" [Snew]=spec2spec(S,newtype,phi,v)">spec2spec</a></li></TD>
<TD> Transforms between different types of spectra</TD>
</TR>
<TR>
<TD><li><a href="wspecplot.html" class="code" title=" wspecplot(S,varargin)">wspecplot</a></li></TD>
<TD> Plot a spectral density</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\axis.m">axis</a></li></TD>
<TD>          Control axis scaling and appearance.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\scribe\colorbar.m">colorbar</a></li></TD>
<TD>      Display color bar (color scale)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph3d\colormap.m">colormap</a></li></TD>
<TD>      Color look-up table.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specgraph\contour.m">contour</a></li></TD>
<TD>       Contour plot.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specgraph\contourf.m">contourf</a></li></TD>
<TD>      Filled contour plot.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specgraph\contours.m">contours</a></li></TD>
<TD>      Contouring over non-rectangular surface.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="delete is a built-in method">delete</a></li></TD>
<TD>        Delete file or graphics object.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\@int16\diff.bi">diff</a></li></TD>
<TD>          Difference and approximate derivative.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\figure.m">figure</a></li></TD>
<TD>        Create figure window.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\uitools\findall.m">findall</a></li></TD>
<TD>       find all objects.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\gca.m">gca</a></li></TD>
<TD>           Get handle to current axis.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\gcf.m">gcf</a></li></TD>
<TD>           Get handle to current figure.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="get is a built-in method">get</a></li></TD>
<TD>           Get object properties.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\grid.m">grid</a></li></TD>
<TD>          Grid lines.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\hold.m">hold</a></li></TD>
<TD>          Hold current graph.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\ischar.m">ischar</a></li></TD>
<TD>        True for character array (string).</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\@fighandle\isfield.m">isfield</a></li></TD>
<TD>       True if field is in structure array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\ishold.m">ishold</a></li></TD>
<TD>        Return hold state.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\scribe\legend.m">legend</a></li></TD>
<TD>        Display legend.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph3d\lighting.m">lighting</a></li></TD>
<TD>      Lighting mode.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\mean.m">mean</a></li></TD>
<TD>          Average or mean value.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph3d\mesh.m">mesh</a></li></TD>
<TD>          3-D mesh surface.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\meshgrid.m">meshgrid</a></li></TD>
<TD>      X and Y arrays for 3-D plots.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\newplot.m">newplot</a></li></TD>
<TD>       M-file preamble for NextPlot property.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\num2str.m">num2str</a></li></TD>
<TD>       Convert number to string. (Fast version)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\ident\ident\@iddata\plot.m">plot</a></li></TD>
<TD>          Linear plot.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specfun\pol2cart.m">pol2cart</a></li></TD>
<TD>      Transform polar to Cartesian coordinates.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\polar.m">polar</a></li></TD>
<TD>         Polar coordinate plot.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specfun\rat.m">rat</a></li></TD>
<TD>           Rational approximation.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specgraph\rotate.m">rotate</a></li></TD>
<TD>        Rotate objects about specified origin and direction.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="set is a built-in method">set</a></li></TD>
<TD>           Set object properties.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\subplot.m">subplot</a></li></TD>
<TD>       Create axes in tiled positions.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\title.m">title</a></li></TD>
<TD>         Graph title.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\warning.m">warning</a></li></TD>
<TD>       Display warning message; disable or enable warning messages.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\xlabel.m">xlabel</a></li></TD>
<TD>        X-axis label.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\ylabel.m">ylabel</a></li></TD>
<TD>        Y-axis label.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph3d\zlabel.m">zlabel</a></li></TD>
<TD>        Z-axis label.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter1.html" class="code" title="This is a script file.">Chapter1</a></li></TD>
<TD> % CHAPTER1 demonstrates some applications of WAFO</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter2.html" class="code" title="This is a script file.">Chapter2</a></li></TD>
<TD> % CHAPTER2 Modelling random loads and stochastic waves</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/multidim/dat2dspec.html" class="code" title=" [Sd,D,Sw,Fcof,Gwt,Sxy,Sxy1] = dat2dspec2(xn,pos,h,nfft,nt,method,varargin)">dat2dspec</a></li></TD>
<TD> Estimates the directional wave spectrum from timeseries</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/onedim/dat2spec.html" class="code" title=" [S,fcut] = dat2spec(xn,varargin)">dat2spec</a></li></TD>
<TD> Estimate one-sided spectral density from data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/onedim/dat2spec2.html" class="code" title=" S = dat2spec2(xn,L,g,plotflag,wdef,dT,chopOffHighFreq)">dat2spec2</a></li></TD>
<TD> Estimate one-sided spectral density, version 2.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/spec/private/dir2k1d.html" class="code" title=" Snew=dir2k1d(S);">dir2k1d</a></li></TD>
<TD> Transforms directional spectrum to wavenumber spectrum.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/multidim/private/imlm.html" class="code" title=" DS = imlm(Sxy,Gwt,thetai,fi,k,opt)">imlm</a></li></TD>
<TD>  Iterated maximum likelihood method for estimating the directional distribution</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wdemos/itmkurs/itmkurs_lab1.html" class="code" title="This is a script file.">itmkurs_lab1</a></li></TD>
<TD> Script to computer exercises 1</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wdemos/itmkurs/itmkurs_lab3.html" class="code" title="This is a script file.">itmkurs_lab3</a></li></TD>
<TD> Script to computer exercises 3</TD>
</TR>
<TR>
<TD><li><a href="jonswap.html" class="code" title=" S1 = jonswap(w1,sdata,plotflag)">jonswap</a></li></TD>
<TD> Calculates (and plots) a JONSWAP spectral density</TD>
</TR>
<TR>
<TD><li><a href="mccormick.html" class="code" title=" S1=mccormick(w1,sdata,plotflag)">mccormick</a></li></TD>
<TD> Calculates (and plots) a McCormick spectral density.</TD>
</TR>
<TR>
<TD><li><a href="mkdspec.html" class="code" title=" Snew=mkdspec(S,D,plotflag)">mkdspec</a></li></TD>
<TD> Make a directional spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/multidim/private/mlm.html" class="code" title=" DS = mlm(Sxy,Gwt,thetai,fi,k,opt)">mlm</a></li></TD>
<TD>  maximum likelihood method for estimating the directional distribution</TD>
</TR>
<TR>
<TD><li><a href="ohspec.html" class="code" title=" S1=ohspec(w1,sdata,plotflag)">ohspec</a></li></TD>
<TD> Calculates (and plots) a Ochi-Hubble spectral density.</TD>
</TR>
<TR>
<TD><li><a href="ohspec2.html" class="code" title=" [S, S1] = ohspec2(w,sdata,plotflag)">ohspec2</a></li></TD>
<TD> Calculates and plots a bimodal Ochi-Hubble spectral density</TD>
</TR>
<TR>
<TD><li><a href="ohspec3.html" class="code" title=" [S, S1] = ohspec3(w,def,plotflag)">ohspec3</a></li></TD>
<TD> Calculates Bimodal Ochi-Hubble spectral densities</TD>
</TR>
<TR>
<TD><li><a href="pmspec.html" class="code" title=" S1=pmspec(w1,sdata,plotflag)">pmspec</a></li></TD>
<TD> Calculates (and plots) a Pierson-Moskowitz spectral density.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/rec/recfig4.html" class="code" title=" recfig4">recfig4</a></li></TD>
<TD> Estimated spectral density (solid) and 95% confidence intervals (dots)</TD>
</TR>
<TR>
<TD><li><a href="scalespec.html" class="code" title=" [Sn,mn,mom]=scalespec(So,m0n,m2n,plotflag)">scalespec</a></li></TD>
<TD>  Scale spectral density so that the moments equals m0,m2.</TD>
</TR>
<TR>
<TD><li><a href="torsethaugen.html" class="code" title=" [S, Sw, Ss]=torsethaugen(w1,sdata,plotflag)">torsethaugen</a></li></TD>
<TD> Calculates a double peaked (swell + wind) spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/wafodemo/wafofig2.html" class="code" title=" wafofig2">wafofig2</a></li></TD>
<TD>  Spectral densities:</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/wafodemo/wafofig4.html" class="code" title=" wafofig4">wafofig4</a></li></TD>
<TD>  Directional spectra using Thorsethaugen and cos2s spreading</TD>
</TR>
<TR>
<TD><li><a href="wallop.html" class="code" title=" S1=wallop(w1,sdata,plotflag)">wallop</a></li></TD>
<TD>  Calculates (and plots) a Wallop spectral density.</TD>
</TR>
<TR>
<TD><li><a href="wnormspec.html" class="code" title=" [S,mn4,m0,m2,m4,m1]=wnormspec(spectrum,m0,m2,plotflag)">wnormspec</a></li></TD>
<TD> Normalize a spectral density such that m0=m2=1</TD>
</TR>
<TR>
<TD><li><a href="wspecplot.html" class="code" title=" wspecplot(S,varargin)">wspecplot</a></li></TD>
<TD> Plot a spectral density</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code"> xtxt = num2pistr(x,N)</a></li><li><a href="#_sub2" class="code"> fixthetalabels(thmin,thmax,xy,dim)</a></li><li><a href="#_sub3" class="code"> cltext1(z_level,textstart_x,textstart_y)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="keyword">function</span> <a href="wspecplot.html" class="code" title=" Plot a spectral density  "><a name="_sub0" href="#_subfunctions" class="code">wspecplot</a>wspecplot</a>(S,varargin) 
0002 <span class="comment">%WSPECPLOT Plot a spectral density  </span>
0003 <span class="comment">% </span>
0004 <span class="comment">% CALL:  wspecplot(S,plotflag,linetype)  </span>
0005 <span class="comment">% </span>
0006 <span class="comment">%    S       = an array of spectral density structs: </span>
0007 <span class="comment">%              1D  (see dat2spec) </span>
0008 <span class="comment">%              2D  (see createspec) </span>
0009 <span class="comment">%   1D: </span>
0010 <span class="comment">%   plotflag = 1 plots the density, S, (default) </span>
0011 <span class="comment">%              2 plot 10log10(S) </span>
0012 <span class="comment">%           3 plots both the above plots  </span>
0013 <span class="comment">%   2D: </span>
0014 <span class="comment">%   Directional spectra: S(w,theta), S(f,theta)              </span>
0015 <span class="comment">%   plotflag = 1 polar plot S (default) </span>
0016 <span class="comment">%              2 plots spectral density and the directional  </span>
0017 <span class="comment">%                spreading, int S(w,theta) dw or int S(f,theta) df </span>
0018 <span class="comment">%              3 plots spectral density and the directional  </span>
0019 <span class="comment">%                spreading, int S(w,theta)/S(w) dw or int S(f,theta)/S(f) df </span>
0020 <span class="comment">%              4 mesh of S </span>
0021 <span class="comment">%              5 mesh of S in polar coordinates   </span>
0022 <span class="comment">%              6 contour plot of S </span>
0023 <span class="comment">%              7 filled contour plot of S </span>
0024 <span class="comment">%   Wavenumber spectra: S(k1,k2) </span>
0025 <span class="comment">%   plotflag = 1 contour plot of S (default) </span>
0026 <span class="comment">%              2 filled contour plot of S </span>
0027 <span class="comment">%   lintype : specify color and lintype, see PLOT for possibilities. </span>
0028 <span class="comment">% </span>
0029 <span class="comment">% NOTE: - lintype may be given anywhere after S. </span>
0030 <span class="comment">%       wspecplot adds  point-and-click editing of all the text  </span>
0031 <span class="comment">%       objects (title, xlabel, ylabel, etc ) of the current figure </span>
0032 <span class="comment">% </span>
0033 <span class="comment">% Examples </span>
0034 <span class="comment">%  S = demospec('dir'); S2 = mkdspec(jonswap,spreading); </span>
0035 <span class="comment">%  wspecplot(S,2), hold on </span>
0036 <span class="comment">%  wspecplot(S,3,'g')  <span class="comment">% Same as previous fig. due to frequency independent spreading </span></span>
0037 <span class="comment">%  wspecplot(S2,2,'r') <span class="comment">% Not the same as previous figs. due to frequency dependent spreading </span></span>
0038 <span class="comment">%  wspecplot(S2,3,'m') </span>
0039 <span class="comment">%  <span class="comment">% transform from angular frequency and radians to frequency and degrees </span></span>
0040 <span class="comment">%  Sf = ttspec(S,'f','d'); clf </span>
0041 <span class="comment">%  wspecplot(Sf,2), </span>
0042 <span class="comment">% </span>
0043 <span class="comment">% See also  dat2spec, createspec, simpson </span>
0044  
0045 <span class="comment">% tested on Matlab 5.3 </span>
0046 <span class="comment">% History: </span>
0047 <span class="comment">% Revised pab Apr2005 </span>
0048 <span class="comment">%  Fixed a bug when S is a multidimensional struct. </span>
0049 <span class="comment">% revised pab Feb2004 </span>
0050 <span class="comment">%  - fixed abug in fcolorbar   </span>
0051 <span class="comment">% revised pab dec2003 </span>
0052 <span class="comment">% replaced call to colorbarf with fcolorbar  </span>
0053 <span class="comment">% replaced call to findzlevel with clevels   </span>
0054 <span class="comment">% revised pab 29.06.2001 </span>
0055 <span class="comment">% directional spectra: </span>
0056 <span class="comment">% - added filled contour plot (made also for wave number spectra) </span>
0057 <span class="comment">% - clarified what is actually plotted for plotflag==2 and plotflag==3 </span>
0058 <span class="comment">%   + added examples on the subject </span>
0059 <span class="comment">% - ylabels for plotflag==5 and S.theta given in radians fixed. </span>
0060 <span class="comment">% revised pab 22.06.2001 </span>
0061 <span class="comment">%  -added contourplot for directional spectra + examples in help header. </span>
0062 <span class="comment">%  -Fixed bugs: S.phi was not taken into acount for plotflag 2:5 </span>
0063 <span class="comment">%               and also phi was not transformed to radians for </span>
0064 <span class="comment">%               plotflag=1 when spectrum was given in degrees. </span>
0065 <span class="comment">% revised by IR 02.04.2001: l 191. Before plot not worked when Fp=0. </span>
0066 <span class="comment">% revised by pab 15.01.2001 </span>
0067 <span class="comment">%  - fixed a bug: axis for plotflag==2 </span>
0068 <span class="comment">% revised by gl 12.07.2000 </span>
0069 <span class="comment">%  - added third argument 0 on line 125 to prevent warning from findrfc </span>
0070 <span class="comment">% revised pab 14.06.2000 </span>
0071 <span class="comment">% - added the possibility that S.theta is given in degrees </span>
0072 <span class="comment">% - fixed bug for plotflag 2 S.type = dir. (simpson integration) </span>
0073 <span class="comment">% - cleaned up some code and put it into separate functions: </span>
0074 <span class="comment">%        num2pistr, findzlevel cltext1 and fixthetalabels </span>
0075 <span class="comment">% revised pab 08.05.2000 </span>
0076 <span class="comment">%  - fixed a bug for S an array of structs </span>
0077 <span class="comment">% revised jr 10.04.2000 </span>
0078 <span class="comment">%  - made a comment of line 127 </span>
0079 <span class="comment">% revised pab 28.01.2000 </span>
0080 <span class="comment">%  - added plotflag 4 for dir. spec. 2D </span>
0081 <span class="comment">%  - added point-and-click editing of all the text objects (title, xlabel, ylabel) of the current figure </span>
0082 <span class="comment">% revised es 21.01.2000 lintype also for dir.spec.    </span>
0083 <span class="comment">% revised pab 20-01.2000 </span>
0084 <span class="comment">%  - added the possibility that S is a array of structs </span>
0085 <span class="comment">% revised pab 12-01.2000 </span>
0086 <span class="comment">%  - added plotflag 3 for dir. spec. i.e., meshplot </span>
0087 <span class="comment">%  - made the xticks and xticklabels print better  </span>
0088 <span class="comment">%    for dir. spec. when plotflag==2 (line 244-257) </span>
0089 <span class="comment">% revised pab 06.01.2000 </span>
0090 <span class="comment">%  - added checking for empty c from contourc line 190 </span>
0091 <span class="comment">% revised pab 22.10.1999 </span>
0092 <span class="comment">%  - fixed a bug: legend(txt) -&gt; legend(txt{:}) line 147   </span>
0093 <span class="comment">% revised pab 12.10.1999 </span>
0094 <span class="comment">% </span>
0095 <span class="comment">% by pab,es 17.09.1999 </span>
0096  
0097  
0098 LegendOn = 1; 
0099  
0100 P   = varargin; 
0101  
0102 ih=ishold; 
0103 Ns=length(S); 
0104 <span class="keyword">if</span> Ns&gt;1 
0105   cfig=gcf; 
0106   <span class="keyword">for</span> ix=1:Ns, 
0107     <span class="keyword">if</span> ih 
0108       newplot 
0109     <span class="keyword">else</span> 
0110       figure(cfig-1+ix) 
0111     <span class="keyword">end</span> 
0112     <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S(ix),P{:}) 
0113   <span class="keyword">end</span> 
0114   <span class="keyword">return</span> 
0115 <span class="keyword">end</span> 
0116  
0117 <span class="comment">% Default values:  </span>
0118 <span class="comment">%~~~~~~~~~~~~~~~ </span>
0119 plotflag = 1; 
0120 lintype  = <span class="string">'b-'</span>; 
0121 Nlevel   = 7; 
0122  
0123 Np    = length(P); 
0124 <span class="keyword">if</span> Np&gt;0 
0125   strix = zeros(1,Np); 
0126   <span class="keyword">for</span> ix=1:Np, <span class="comment">% finding symbol strings  </span>
0127     strix(ix)=ischar(P{ix}); 
0128   <span class="keyword">end</span> 
0129   k = find(strix); 
0130   <span class="keyword">if</span> any(k) 
0131     Nk = length(k); 
0132     <span class="keyword">if</span> Nk&gt;1 
0133       warning(<span class="string">'More than 1 strings are not allowed'</span>) 
0134     <span class="keyword">end</span> 
0135     lintype = P{k(1)}; 
0136     Np = Np-Nk; 
0137     P  = {P{find(~strix)}}; <span class="comment">% remove strings from input </span>
0138   <span class="keyword">end</span> 
0139   <span class="keyword">if</span> Np&gt;0 &amp; ~isempty(P{1}), plotflag=P{1};<span class="keyword">end</span> 
0140 <span class="keyword">end</span> 
0141  
0142  
0143 ftype = <a href="freqtype.html" class="code" title=" returns the frequency type of a Spectral density struct.">freqtype</a>(S); <span class="comment">%options are 'f' and 'w' and 'k' </span>
0144 <span class="keyword">switch</span> ftype 
0145 <span class="keyword">case</span> {<span class="string">'w'</span>}, 
0146   freq      = S.w;  
0147   xlbl_txt  = <span class="string">'Frequency [rad/s]'</span>;   
0148   ylbl1_txt = <span class="string">'S(w) [m^2 s / rad]'</span>; 
0149   ylbl3_txt = <span class="string">'Directional Spectrum'</span>; 
0150   zlbl_txt  = <span class="string">'S(w,\theta) [m^2 s / rad^2]'</span>; 
0151   funit     = <span class="string">' [rad/s]'</span>;   
0152   Sunit     = <span class="string">' [m^2 s / rad]'</span>;  
0153 <span class="keyword">case</span> {<span class="string">'f'</span>},  
0154   freq      = S.f;  
0155   xlbl_txt  = <span class="string">'Frequency [Hz]'</span>;      
0156   ylbl1_txt = <span class="string">'S(f) [m^2 s]'</span>; 
0157   ylbl3_txt = <span class="string">'Directional Spectrum'</span>; 
0158   zlbl_txt  = <span class="string">'S(f,\theta) [m^2 s / rad]'</span>; 
0159   funit     = <span class="string">' [Hz]'</span>;   
0160   Sunit     = <span class="string">' [m^2 s ]'</span>;  
0161 <span class="keyword">case</span> {<span class="string">'k'</span>}, 
0162   freq      = S.k;  
0163   xlbl_txt  = <span class="string">'Wave number [rad/m]'</span>; 
0164   ylbl1_txt = <span class="string">'S(k) [m^3/ rad]'</span>; 
0165   funit     = <span class="string">' [rad/m]'</span>;  
0166   Sunit     = <span class="string">' [m^3 / rad]'</span>; 
0167   <span class="keyword">if</span> isfield(S,<span class="string">'k2'</span>) 
0168     ylbl4_txt=<span class="string">'Wave Number Spectrum'</span>; 
0169   <span class="keyword">end</span> 
0170 <span class="keyword">otherwise</span>,  error(<span class="string">'Frequency type unknown'</span>) 
0171 <span class="keyword">end</span> 
0172  
0173 <span class="keyword">if</span> isfield(S,<span class="string">'norm'</span>) &amp; S.norm  
0174   Sunit=[];funit=[]; 
0175   ylbl1_txt = <span class="string">'Normalized Spectral density'</span>; 
0176   ylbl3_txt = <span class="string">'Normalized Directional Spectrum'</span>; 
0177   ylbl4_txt = <span class="string">'Normalized Wave Number Spectrum'</span>; 
0178   <span class="keyword">if</span> strcmp(ftype,<span class="string">'k'</span>) 
0179     xlbl_txt = <span class="string">'Normalized Wave number'</span>; 
0180   <span class="keyword">else</span> 
0181     xlbl_txt = <span class="string">'Normalized Frequency'</span>;  
0182   <span class="keyword">end</span> 
0183 <span class="keyword">end</span>     
0184  
0185 ylbl2_txt = <span class="string">'Power spectrum (dB)'</span>; 
0186  
0187 phi =0; 
0188 <span class="keyword">if</span> isfield(S,<span class="string">'phi'</span>) &amp; ~isempty(S.phi) 
0189   phi = S.phi; 
0190 <span class="keyword">end</span> 
0191  
0192  
0193 <span class="keyword">switch</span> lower(S.type(<span class="keyword">end</span>-2:<span class="keyword">end</span>)) 
0194   <span class="keyword">case</span> {<span class="string">'enc'</span>,<span class="string">'req'</span>,<span class="string">'k1d'</span>} <span class="comment">% 1D plot </span>
0195     S.S  = S.S(:); 
0196     Fn   = freq(<span class="keyword">end</span>); <span class="comment">% Nyquist frequency </span>
0197     indm = <a href="../../wafo/misc/findpeaks.html" class="code" title=" find peaks of vector or matrix possibly rainflow filtered">findpeaks</a>(S.S,4); 
0198     <span class="keyword">if</span> isempty(indm) 
0199       <span class="comment">%disp('indm empty')  <span class="comment">% Commented, 00.04.10  </span></span>
0200       [maxS,indm] = max(S.S);  <span class="comment">%to be removed when findpeaks works </span>
0201     <span class="keyword">end</span> 
0202     maxS = max(S.S(indm)); 
0203     <span class="keyword">if</span> isfield(S,<span class="string">'CI'</span>)&amp; ~isempty(S.CI), 
0204       maxS  = maxS*S.CI(2); 
0205       txtCI = [num2str(100*S.p), <span class="string">'% CI'</span>]; 
0206     <span class="keyword">end</span> 
0207      
0208     Fp = freq(indm); <span class="comment">%peak frequency/wave number </span>
0209      
0210     <span class="keyword">if</span> length(indm)==1 
0211       txt = {[<span class="string">'fp = '</span> num2str(Fp,2), funit];}; 
0212     <span class="keyword">else</span> 
0213       txt = {[<span class="string">'fp1 = '</span> num2str(Fp(1),2), funit]}; 
0214       <span class="keyword">for</span> j=2:length(indm) 
0215          txt(<span class="keyword">end</span>+1) = {[<span class="string">'fp'</span>,num2str(j),<span class="string">' = '</span>, num2str(Fp(j),2), funit]}; 
0216       <span class="keyword">end</span> 
0217     <span class="keyword">end</span> 
0218     <span class="keyword">if</span> (plotflag == 3), subplot(2,1,1),<span class="keyword">end</span>  
0219     <span class="keyword">if</span> (plotflag == 1) | (plotflag ==3),<span class="comment">% Plot in normal scale </span>
0220       plot([Fp(:) Fp(:)]',[zeros(length(indm),1) S.S(indm)]',<span class="string">':'</span>) 
0221       hold on 
0222       <span class="keyword">if</span> isfield(S,<span class="string">'CI'</span>), 
0223     plot(freq,S.S*S.CI(1), <span class="string">'r:'</span> ) 
0224     plot(freq,S.S*S.CI(2), <span class="string">'r:'</span> ) 
0225       <span class="keyword">end</span> 
0226       plot(freq,S.S,lintype)  ,<span class="keyword">if</span> ~ih, hold off,<span class="keyword">end</span> 
0227       <span class="keyword">if</span> ih, a=axis; <span class="keyword">else</span> a=zeros(1,4); <span class="keyword">end</span> 
0228       a1=Fn; 
0229       <span class="keyword">if</span> (Fp&gt;0)  
0230      a1=max(min(Fn,10*max(Fp)),a(2)); 
0231       <span class="keyword">end</span> 
0232       axis([0 a1 0 max(1.01*maxS,a(4))])  
0233       title(<span class="string">'Spectral density'</span>) 
0234       xlabel(xlbl_txt) 
0235       ylabel(ylbl1_txt ) 
0236     <span class="keyword">end</span> 
0237      
0238     <span class="keyword">if</span> (plotflag==3), subplot(2,1,2),<span class="keyword">end</span>     
0239      
0240     <span class="keyword">if</span> (plotflag == 2) | (plotflag ==3), <span class="comment">% Plot in logaritmic scale </span>
0241       ind=find(S.S&gt;0); 
0242        
0243       plot([Fp(:),Fp(:)]',[repmat(min(10*log10(S.S(ind)/maxS)),length(Fp),1) 10*log10(S.S(indm)/maxS)]',<span class="string">':'</span>) 
0244       hold on  
0245       <span class="keyword">if</span> isfield(S,<span class="string">'CI'</span>), 
0246     plot(freq(ind),10*log10(S.S(ind)*S.CI(1)/maxS), <span class="string">'r:'</span> ) 
0247     plot(freq(ind),10*log10(S.S(ind)*S.CI(2)/maxS), <span class="string">'r:'</span> ) 
0248       <span class="keyword">end</span> 
0249       plot(freq(ind),10*log10(S.S(ind)/maxS),lintype) 
0250       <span class="keyword">if</span> ~ih, hold off, <span class="keyword">end</span> 
0251       <span class="keyword">if</span> ih, a=axis; <span class="keyword">else</span> a=[0 0 0 0]; <span class="keyword">end</span> 
0252       axis([0 max(min(Fn,max(10*Fp)),a(2)) -20 max(1.01*10*log10(1),a(4))]) <span class="comment">% log10(maxS) </span>
0253       title(<span class="string">'Spectral density'</span>) 
0254       xlabel(xlbl_txt) 
0255       ylabel(ylbl2_txt ) 
0256     <span class="keyword">end</span>       
0257     <span class="keyword">if</span> LegendOn 
0258       <span class="keyword">if</span> isfield(S,<span class="string">'CI'</span>), 
0259     legend(txt{:},txtCI,1) 
0260       <span class="keyword">else</span> 
0261     legend(txt{:},1) 
0262       <span class="keyword">end</span> 
0263     <span class="keyword">end</span> 
0264   <span class="keyword">case</span> {<span class="string">'k2d'</span>} 
0265     <span class="keyword">if</span> plotflag==1, 
0266       [c, h] = contour(freq,S.k2,S.S,<span class="string">'b'</span>); 
0267       z_level = <a href="../../wafo/misc/clevels.html" class="code" title="  Extract the contour levels from the contour matrix">clevels</a>(c); 
0268      
0269       <span class="comment">% label the contour levels </span>
0270       textstart_x=0.05; textstart_y=0.94; 
0271       <a href="#_sub3" class="code" title="sub  cltext1(z_level,textstart_x,textstart_y)">cltext1</a>(z_level,textstart_x,textstart_y); 
0272     <span class="keyword">else</span> 
0273       [c,h] = contourf(freq,S.k2,S.S); 
0274       <span class="comment">%clabel(c,h), colorbar(c,h) </span>
0275       <a href="../../wafo/misc/fcolorbar.html" class="code" title="  Display colorbar with discrete color axis for filled contour plot ">fcolorbar</a>(c) <span class="comment">% alternative </span>
0276     <span class="keyword">end</span> 
0277     rotate(h,[0 0 1],-phi*180/pi) 
0278      
0279      
0280         
0281     xlabel(xlbl_txt) 
0282     ylabel(xlbl_txt) 
0283     title(ylbl4_txt) 
0284     <span class="comment">%return </span>
0285     km=max([-freq(1) freq(<span class="keyword">end</span>) S.k2(1) -S.k2(<span class="keyword">end</span>)]); 
0286     axis([-km km -km km]) 
0287     hold on 
0288     plot([0 0],[ -km km],<span class="string">':'</span>) 
0289     plot([-km km],[0 0],<span class="string">':'</span>) 
0290     axis(<span class="string">'square'</span>) 
0291      
0292      
0293     <span class="comment">%cltext(z_level); </span>
0294     <span class="comment">%axis('square') </span>
0295     <span class="keyword">if</span> ~ih, hold off,<span class="keyword">end</span> 
0296   <span class="keyword">case</span> {<span class="string">'dir'</span>} 
0297     thmin = S.theta(1)-phi;thmax=S.theta(<span class="keyword">end</span>)-phi; 
0298     <span class="keyword">if</span> plotflag==1 <span class="comment">% polar plot </span>
0299       <span class="keyword">if</span> 0, <span class="comment">% alternative but then z_level must be chosen beforehand </span>
0300     h = polar([0 2*pi],[0 freq(<span class="keyword">end</span>)]); 
0301     delete(h);hold on 
0302     [X,Y]=meshgrid(S.theta,freq); 
0303     [X,Y]=pol2cart(X,Y); 
0304     contour(X,Y,S.S',lintype) 
0305       <span class="keyword">else</span> 
0306     <span class="keyword">if</span> (abs(thmax-thmin)&lt;3*pi), <span class="comment">% angle given in radians </span>
0307       theta = S.theta; 
0308     <span class="keyword">else</span> 
0309       theta = S.theta*pi/180; <span class="comment">% convert to radians </span>
0310       phi  = phi*pi/180; 
0311     <span class="keyword">end</span> 
0312     c = contours(theta,freq,S.S');<span class="comment">%,Nlevel); <span class="comment">% calculate levels </span></span>
0313     <span class="keyword">if</span> isempty(c) 
0314       c = contours(theta,freq,S.S);<span class="comment">%,Nlevel); <span class="comment">% calculate levels </span></span>
0315     <span class="keyword">end</span> 
0316     [z_level c] = <a href="../../wafo/misc/clevels.html" class="code" title="  Extract the contour levels from the contour matrix">clevels</a>(c); <span class="comment">% find contour levels </span>
0317     h = polar(c(1,:),c(2,:),lintype); 
0318     rotate(h,[0 0 1],-phi*180/pi) 
0319       <span class="keyword">end</span> 
0320       title(ylbl3_txt) 
0321       <span class="comment">% label the contour levels </span>
0322       textstart_x = -0.1; textstart_y=1.00; 
0323       <a href="#_sub3" class="code" title="sub  cltext1(z_level,textstart_x,textstart_y)">cltext1</a>(z_level,textstart_x,textstart_y) <span class="comment">% a local variant of cltext </span>
0324       <span class="comment">%cltext(z_level) </span>
0325     <span class="keyword">elseif</span> (plotflag==2) | (plotflag==3), 
0326       <span class="comment">%ih = ishold; </span>
0327        
0328       subplot(211) 
0329        
0330       <span class="keyword">if</span> ih, hold on, <span class="keyword">end</span> 
0331        
0332       Sf = <a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(S,<span class="string">'freq'</span>); <span class="comment">% frequency spectrum </span>
0333       <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(Sf,1,lintype) 
0334  
0335       subplot(212) 
0336        
0337       Dtf        = S.S; 
0338       [Nt,Nf]    = size(S.S);  
0339       Sf         = Sf.S(:).'; 
0340       ind        = find(Sf); 
0341        
0342       <span class="keyword">if</span> plotflag==3, <span class="comment">%Directional distribution  D(theta,freq)) </span>
0343     Dtf(:,ind) = Dtf(:,ind)./Sf(ones(Nt,1),ind);  
0344       <span class="keyword">end</span> 
0345       Dtheta  = <a href="../../wafo/misc/simpson.html" class="code" title=" Numerical integration with the Simpson method">simpson</a>(freq,Dtf,2); <span class="comment">%Directional spreading, D(theta)  </span>
0346       Dtheta  = Dtheta/<a href="../../wafo/misc/simpson.html" class="code" title=" Numerical integration with the Simpson method">simpson</a>(S.theta,Dtheta); <span class="comment">% make sure int D(theta)dtheta = 1 </span>
0347       [y,ind] = max(Dtheta); 
0348       Wdir    = S.theta(ind)-phi; <span class="comment">% main wave direction </span>
0349       txtwdir = [<span class="string">'\thetap='</span> <a href="#_sub1" class="code" title="sub  xtxt = num2pistr(x,N)">num2pistr</a>(Wdir,3)]; <span class="comment">% convert to text string </span>
0350             
0351       plot([1 1]*S.theta(ind)-phi,[0 Dtheta(ind)],<span class="string">':'</span>), hold on 
0352       <span class="keyword">if</span> LegendOn 
0353     lh=legend(txtwdir,0); 
0354       <span class="keyword">end</span> 
0355       plot(S.theta-phi,Dtheta,lintype) 
0356        
0357       <a href="#_sub2" class="code" title="sub  fixthetalabels(thmin,thmax,xy,dim)">fixthetalabels</a>(thmin,thmax,<span class="string">'x'</span>,2)  <span class="comment">% fix xticklabel and xlabel for theta </span>
0358       ylabel(<span class="string">'D(\theta)'</span>) 
0359       title(<span class="string">'Spreading function'</span>) 
0360       <span class="keyword">if</span> ~ih, hold off, <span class="keyword">end</span> 
0361       <span class="comment">%legend(lh) <span class="comment">% refresh current legend </span></span>
0362     <span class="keyword">elseif</span> plotflag==4 <span class="comment">% mesh </span>
0363       mesh(freq,S.theta-phi,S.S) 
0364       xlabel(xlbl_txt); 
0365       <a href="#_sub2" class="code" title="sub  fixthetalabels(thmin,thmax,xy,dim)">fixthetalabels</a>(thmin,thmax,<span class="string">'y'</span>,3) <span class="comment">% fix yticklabel and ylabel for theta </span>
0366       zlabel(zlbl_txt) 
0367       title(ylbl3_txt) 
0368     <span class="keyword">elseif</span> plotflag==5 <span class="comment">% mesh </span>
0369       <span class="comment">%h=polar([0 2*pi],[0 freq(end)]); </span>
0370       <span class="comment">%delete(h);hold on </span>
0371       [X,Y]=meshgrid(S.theta-phi,freq); 
0372       [X,Y]=pol2cart(X,Y); 
0373       mesh(X,Y,S.S') 
0374       <span class="comment">% display the unit circle beneath the surface </span>
0375       hold on, mesh(X,Y,zeros(size(S.S'))),hold off 
0376       zlabel(zlbl_txt) 
0377       title(ylbl3_txt) 
0378       set(gca,<span class="string">'xticklabel'</span>,<span class="string">''</span>,<span class="string">'yticklabel'</span>,<span class="string">''</span>) 
0379       lighting phong 
0380       <span class="comment">%lighting gouraud </span>
0381       <span class="comment">%light </span>
0382     <span class="keyword">elseif</span> (plotflag==6) | (plotflag==7), 
0383       theta = S.theta-phi; 
0384       [c, h] = contour(freq,theta,S.S); <span class="comment">%,Nlevel); <span class="comment">% calculate levels </span></span>
0385       <a href="#_sub2" class="code" title="sub  fixthetalabels(thmin,thmax,xy,dim)">fixthetalabels</a>(thmin,thmax,<span class="string">'y'</span>,2) <span class="comment">% fix yticklabel and ylabel for theta </span>
0386       <span class="keyword">if</span> plotflag==7, 
0387     hold on 
0388     [c,h] =    contourf(freq,theta,S.S); <span class="comment">%,Nlevel); <span class="comment">% calculate levels </span></span>
0389     <span class="comment">%hold on </span>
0390       <span class="keyword">end</span> 
0391      
0392       title(ylbl3_txt) 
0393       xlabel(xlbl_txt); 
0394       <span class="keyword">if</span> 0, 
0395     [z_level] = <a href="../../wafo/misc/clevels.html" class="code" title="  Extract the contour levels from the contour matrix">clevels</a>(c); <span class="comment">% find contour levels </span>
0396     <span class="comment">% label the contour levels </span>
0397     textstart_x = 0.06; textstart_y=0.94; 
0398     <a href="#_sub3" class="code" title="sub  cltext1(z_level,textstart_x,textstart_y)">cltext1</a>(z_level,textstart_x,textstart_y) <span class="comment">% a local variant of cltext </span>
0399       <span class="keyword">else</span> 
0400     colormap(<span class="string">'jet'</span>) 
0401       
0402     <span class="keyword">if</span> plotflag==7, 
0403       <a href="../../wafo/misc/fcolorbar.html" class="code" title="  Display colorbar with discrete color axis for filled contour plot ">fcolorbar</a>(c) 
0404     <span class="keyword">else</span> 
0405       <span class="comment">%clabel(c,h), </span>
0406       hcb = colorbar; 
0407     <span class="keyword">end</span> 
0408     grid on 
0409       <span class="keyword">end</span> 
0410     <span class="keyword">else</span> 
0411       error(<span class="string">'Unknown plot option'</span>) 
0412     <span class="keyword">end</span> 
0413   <span class="keyword">otherwise</span>, error(<span class="string">'unknown spectral type'</span>) 
0414 <span class="keyword">end</span> 
0415  
0416 <span class="keyword">if</span> ~ih, hold off, <span class="keyword">end</span> 
0417  
0418 <span class="comment">%  The following two commands install point-and-click editing of </span>
0419 <span class="comment">%   all the text objects (title, xlabel, ylabel) of the current figure: </span>
0420  
0421 set(findall(gcf,<span class="string">'type'</span>,<span class="string">'text'</span>),<span class="string">'buttondownfcn'</span>,<span class="string">'edtext'</span>) 
0422 set(gcf,<span class="string">'windowbuttondownfcn'</span>,<span class="string">'edtext('<span class="string"></span>'hide'<span class="string"></span>')'</span>) 
0423  
0424 <span class="keyword">return</span> 
0425  
0426 <span class="keyword">function</span>  xtxt = <a name="_sub1" href="#_subfunctions" class="code">num2pistr</a>(x,N) 
0427 <span class="comment">% NUM2PISTR convert a scalar x to a text string in fractions of pi </span>
0428 <span class="comment">%           if the numerator is less than 10 and not equal 0  </span>
0429 <span class="comment">%           and if the denominator is less than 10. </span>
0430 <span class="comment">% </span>
0431 <span class="comment">%  CALL xtxt = num2pistr(x,n) </span>
0432 <span class="comment">%  </span>
0433 <span class="comment">% xtxt = a text string in fractions of pi </span>
0434 <span class="comment">%  x   = a scalar </span>
0435 <span class="comment">%  n   = maximum digits of precision. (default 3) </span>
0436  
0437  
0438 <span class="keyword">if</span> nargin&lt;2|isempty(N) 
0439   N=3; 
0440 <span class="keyword">end</span> 
0441 [num den]=rat(x/pi); 
0442 <span class="keyword">if</span> (den&lt;10)&amp; (num&lt;10)&amp;(num~=0), 
0443   <span class="keyword">if</span> abs(den)==1, dtxt=[]; <span class="keyword">else</span>, dtxt=[<span class="string">'/'</span> num2str(den)]; <span class="keyword">end</span> <span class="comment">% denominator </span>
0444   <span class="keyword">if</span> abs(num)==1, <span class="comment">% numerator </span>
0445     <span class="keyword">if</span> num==-1, ntxt=<span class="string">'-'</span>; <span class="keyword">else</span>, ntxt=[];<span class="keyword">end</span>  
0446   <span class="keyword">else</span>  
0447     ntxt=num2str(num);  
0448   <span class="keyword">end</span> 
0449   xtxt= [ntxt <span class="string">'\pi'</span> dtxt]; 
0450 <span class="keyword">else</span> 
0451   xtxt = num2str(x,N); 
0452 <span class="keyword">end</span> 
0453 <span class="keyword">return</span>   
0454    
0455 <span class="keyword">function</span> <a name="_sub2" href="#_subfunctions" class="code">fixthetalabels</a>(thmin,thmax,xy,dim) 
0456 <span class="comment">%FIXTHETALABELS pretty prints the ticklabels and x or y labels for theta   </span>
0457 <span class="comment">%   </span>
0458 <span class="comment">% CALL fixthetalabels(thmin,thmax,xy,dim) </span>
0459 <span class="comment">% </span>
0460 <span class="comment">%  thmin, thmax = minimum and maximum value for theta (wave direction) </span>
0461 <span class="comment">%  xy           = 'x' if theta is plotted on the x-axis  </span>
0462 <span class="comment">%                 'y' if theta is plotted on the y-axis  </span>
0463 <span class="comment">%  dim          = specifies the dimension of the plot (ie number of axes shown 2 or 3) </span>
0464 <span class="comment">%  If abs(thmax-thmin)&lt;3*pi it is assumed that theta is given in radians  </span>
0465 <span class="comment">%  otherwise degrees </span>
0466  
0467 ind = [(<span class="string">'x'</span> == xy)  (<span class="string">'y'</span> == xy) ]; 
0468 yx = <span class="string">'yx'</span>; 
0469 yx = yx(ind); 
0470 <span class="keyword">if</span> nargin&lt;4|isempty(dim), 
0471   dim=2; 
0472 <span class="keyword">end</span> 
0473 <span class="comment">%drawnow </span>
0474 <span class="comment">%pause </span>
0475  
0476 <span class="keyword">if</span> abs(thmax-thmin)&lt;3*pi, <span class="comment">%Radians given. Want xticks given as fractions  of pi </span>
0477   <span class="comment">%Trick to update the axis  </span>
0478   <span class="keyword">if</span> xy==<span class="string">'x'</span>     
0479     <span class="keyword">if</span> dim&lt;3, axis([thmin,thmax 0 inf ]),<span class="keyword">else</span>,axis([thmin,thmax 0 inf 0 inf]),<span class="keyword">end</span> 
0480   <span class="keyword">else</span> 
0481     <span class="keyword">if</span> dim&lt;3, axis([0 inf thmin,thmax ]),<span class="keyword">else</span>,axis([0 inf thmin,thmax 0 inf]),<span class="keyword">end</span> 
0482   <span class="keyword">end</span> 
0483    
0484   set(gca,[xy <span class="string">'tick'</span>],pi*(thmin/pi:0.25:thmax/pi)); 
0485   set(gca,[xy <span class="string">'ticklabel'</span>],[]); 
0486   x    = get(gca,[xy <span class="string">'tick'</span>]); 
0487   y    = get(gca,[yx <span class="string">'tick'</span>]); 
0488   y1 = y(1); 
0489   dy = y(2)-y1; 
0490   yN = y(<span class="keyword">end</span>)+dy; 
0491   ylim = [y1 yN]; 
0492   dy1 = diff(ylim)/40; 
0493   <span class="comment">%ylim=get(gca,[yx 'lim'])<span class="comment">%,ylim=ylim(2); </span></span>
0494    
0495   <span class="keyword">if</span> xy==<span class="string">'x'</span> 
0496     <span class="keyword">for</span> j=1:length(x) 
0497       xtxt = <a href="#_sub1" class="code" title="sub  xtxt = num2pistr(x,N)">num2pistr</a>(x(j)); 
0498       <a href="../../wafo/misc/figtext.html" class="code" title=" Places text in figure window.">figtext</a>(x(j),y1-dy1,xtxt,<span class="string">'data'</span>,<span class="string">'data'</span>,<span class="string">'center'</span>,<span class="string">'top'</span>); 
0499     <span class="keyword">end</span> 
0500    <span class="comment">% ax = [thmin thmax 0 inf]; </span>
0501     ax = [thmin thmax ylim]; 
0502     <span class="keyword">if</span> dim&lt;3, 
0503       <a href="../../wafo/misc/figtext.html" class="code" title=" Places text in figure window.">figtext</a>(mean(x),y1-7*dy1,<span class="string">'Wave directions (rad)'</span>,<span class="string">'data'</span>,<span class="string">'data'</span>,<span class="string">'center'</span>,<span class="string">'top'</span>) 
0504     <span class="keyword">else</span> 
0505       ax = [ax  0 inf];       
0506       xlabel(<span class="string">'Wave directions (rad)'</span>) 
0507     <span class="keyword">end</span> 
0508   <span class="keyword">else</span> 
0509     <span class="comment">%ax = [0 inf thmin thmax]; </span>
0510     ax = [ylim thmin thmax]; 
0511     
0512     <span class="keyword">if</span> dim&lt;3, 
0513       <span class="keyword">for</span> j=1:length(x) 
0514     xtxt = <a href="#_sub1" class="code" title="sub  xtxt = num2pistr(x,N)">num2pistr</a>(x(j)); 
0515     <a href="../../wafo/misc/figtext.html" class="code" title=" Places text in figure window.">figtext</a>(y1-dy1/2,x(j),xtxt,<span class="string">'data'</span>,<span class="string">'data'</span>,<span class="string">'right'</span>); 
0516       <span class="keyword">end</span> 
0517       set(gca,<span class="string">'DefaultTextRotation'</span>,90) 
0518       <span class="comment">%ylabel('Wave directions (rad)') </span>
0519       <a href="../../wafo/misc/figtext.html" class="code" title=" Places text in figure window.">figtext</a>(y1-3*dy1,mean(x),<span class="string">'Wave directions (rad)'</span>,<span class="string">'data'</span>,<span class="string">'data'</span>,<span class="string">'center'</span>,<span class="string">'bottom'</span>) 
0520       set(gca,<span class="string">'DefaultTextRotation'</span>,0) 
0521     <span class="keyword">else</span> 
0522       <span class="keyword">for</span> j=1:length(x) 
0523     xtxt = <a href="#_sub1" class="code" title="sub  xtxt = num2pistr(x,N)">num2pistr</a>(x(j)); 
0524     <a href="../../wafo/misc/figtext.html" class="code" title=" Places text in figure window.">figtext</a>(y1-3*dy1,x(j),xtxt,<span class="string">'data'</span>,<span class="string">'data'</span>,<span class="string">'right'</span>); 
0525       <span class="keyword">end</span> 
0526       ax = [ax 0 inf]; 
0527       ylabel(<span class="string">'Wave directions (rad)'</span>) 
0528     <span class="keyword">end</span> 
0529   <span class="keyword">end</span> 
0530   <span class="comment">%xtxt = num2pistr(x(j)); </span>
0531   <span class="comment">%for j=2:length(x) </span>
0532   <span class="comment">%  xtxt = strvcat(xtxt,num2pistr(x(j))); </span>
0533   <span class="comment">%end </span>
0534   <span class="comment">%set(gca,[xy 'ticklabel'],xtxt) </span>
0535 <span class="keyword">else</span> <span class="comment">% Degrees given </span>
0536   set(gca,[xy <span class="string">'tick'</span>],thmin:45:thmax) 
0537   <span class="keyword">if</span> xy==<span class="string">'x'</span> 
0538     ax=[thmin thmax 0 inf]; 
0539     <span class="keyword">if</span> dim&gt;=3,      ax=[ax 0 inf];    <span class="keyword">end</span> 
0540     xlabel(<span class="string">'Wave directions (deg)'</span>) 
0541   <span class="keyword">else</span> 
0542     ax=[0 inf thmin thmax ]; 
0543     <span class="keyword">if</span> dim&gt;=3,      ax=[ax 0 inf];    <span class="keyword">end</span> 
0544     ylabel(<span class="string">'Wave directions (deg)'</span>) 
0545   <span class="keyword">end</span> 
0546 <span class="keyword">end</span> 
0547 axis(ax) 
0548 <span class="keyword">return</span> 
0549  
0550 <span class="keyword">function</span> <a name="_sub3" href="#_subfunctions" class="code">cltext1</a>(z_level,textstart_x,textstart_y) 
0551 <span class="comment">%CLTEXT1 Places contour level text in the current window </span>
0552 <span class="comment">% </span>
0553 <span class="comment">%  [h,ax] = cltext1(levels,x,y) </span>
0554 <span class="comment">% </span>
0555 <span class="comment">%         x       = the starting x-coordinate of the text. </span>
0556 <span class="comment">%         y       = the starting y-coordinate of the text. </span>
0557 <span class="comment">% </span>
0558  
0559 <span class="comment">%  textstart_x = -0.07; textstart_y=1.00; </span>
0560  
0561 <span class="keyword">if</span> (nargin&lt;4)|isempty(x_unit), 
0562   x_unit=<span class="string">'data'</span>; 
0563 <span class="keyword">end</span> 
0564  
0565  
0566 delta_y     = 1/33; 
0567 <span class="comment">%dir: </span>
0568 <span class="comment">%h = figtext(textstart_x-0.07,textstart_y,' Level curves at:','norm'); </span>
0569  
0570 <span class="comment">% k2d: </span>
0571 h = <a href="../../wafo/misc/figtext.html" class="code" title=" Places text in figure window.">figtext</a>(textstart_x-0.05,textstart_y,<span class="string">' Level curves at:'</span>,<span class="string">'norm'</span>); 
0572 set(h,<span class="string">'FontWeight'</span>,<span class="string">'Bold'</span>) 
0573  
0574 <span class="comment">%z_level = sort(z_level); </span>
0575 <span class="comment">%z_level = z_level(diff([0 z_level])~=0) </span>
0576  
0577 textstart_y = textstart_y-delta_y; 
0578 <span class="keyword">for</span> ix=1:length(z_level) 
0579   textstart_y = textstart_y-delta_y; 
0580   <a href="../../wafo/misc/figtext.html" class="code" title=" Places text in figure window.">figtext</a>(textstart_x,textstart_y,num2str(z_level(ix),4),<span class="string">'norm'</span>); 
0581 <span class="keyword">end</span> 
0582 <span class="keyword">return</span> 
0583</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>