<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of ttspec</title>
  <meta name="keywords" content="ttspec">
  <meta name="description" content=" Toggle Transform between angular frequency and frequency spectrum">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">spec</a> &gt; ttspec.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\spec&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>ttspec
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Toggle Transform between angular frequency and frequency spectrum</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Snew = ttspec(S,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="ttspec.html" class="code" title=" Toggle Transform between angular frequency and frequency spectrum">TTSPEC</a> Toggle Transform between angular frequency and frequency spectrum
 
  CALL:  Snew = <a href="ttspec.html" class="code" title=" Toggle Transform between angular frequency and frequency spectrum">ttspec</a>(S,ftype,thtype)
 
      Snew = spectrum with new frequency type
         S = spectrum 
     ftype = 'f' if Snew should be given with frequency in Hz
             'w' if Snew should be given with angular frequency in rad/s
             (default is the opposite of what is given in S)
    thtype = 'radians' if Snew.theta should be given in radians (default)
             'degrees' if Snew.theta should be given in degrees 
             
 
  If ftype is the same frequency type as for S then Snew = S
  If S is a wavenumber spectrum then Snew = S.
  
  Note: The order of ftype and thtype is arbitrary and only the
        letters 'f','w','r' or 'd' is needed for unique identification
 
  Examples: Change from angular frequency to frequency in Hz and from
           angle in radians to angle in degrees.  
          S   = <a href="demospec.html" class="code" title=" Loads a precreated spectrum of chosen type">demospec</a>('dir');
          Sf  = <a href="ttspec.html" class="code" title=" Toggle Transform between angular frequency and frequency spectrum">ttspec</a>(S);
          Sf1 = <a href="ttspec.html" class="code" title=" Toggle Transform between angular frequency and frequency spectrum">ttspec</a>(Sf,'f','d'); % = <a href="ttspec.html" class="code" title=" Toggle Transform between angular frequency and frequency spectrum">ttspec</a>(Sf,'f','degrees'); 
          <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S,3), figure(2)
          <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(Sf,3), figure(3)
          <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(Sf1,3)
 
  See also  <a href="../../wafo/docs/datastructures.html" class="code" title=" of spectrum, covariance function and density (pdf) in WAFO">datastructures</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="createspec.html" class="code" title=" S=createspec(stype,freqtype)">createspec</a></li></TD>
<TD> Spectrum structure constructor</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\iofun\@timer\fieldnames.m">fieldnames</a></li></TD>
<TD>    Get structure field names.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\getfield.m">getfield</a></li></TD>
<TD>      Get structure field contents.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\@fighandle\isfield.m">isfield</a></li></TD>
<TD>       True if field is in structure array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\isstruct.m">isstruct</a></li></TD>
<TD>      True for structures.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\setfield.m">setfield</a></li></TD>
<TD>      Set structure field contents.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmpi.bi">strcmpi</a></li></TD>
<TD>       Compare strings ignoring case.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@opaque\strmatch.m">strmatch</a></li></TD>
<TD>      Find possible matches for string.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/multidim/dat2dspec.html" class="code" title=" [Sd,D,Sw,Fcof,Gwt,Sxy,Sxy1] = dat2dspec2(xn,pos,h,nfft,nt,method,varargin)">dat2dspec</a></li></TD>
<TD> Estimates the directional wave spectrum from timeseries</TD>
</TR>
<TR>
<TD><li><a href="dspec2char.html" class="code" title=" [ch,chtext] = dspec2char(S,varargin)">dspec2char</a></li></TD>
<TD> Evaluates directional spectral characteristics</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/rec/recfig4.html" class="code" title=" recfig4">recfig4</a></li></TD>
<TD> Estimated spectral density (solid) and 95% confidence intervals (dots)</TD>
</TR>
<TR>
<TD><li><a href="spec2char.html" class="code" title=" [ch,R1,chtext,R]=spec2char(S,fact,T)">spec2char</a></li></TD>
<TD>  Evaluates spectral characteristics and their covariance</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wsim/spec2linspec.html" class="code" title=" [SL,SN]=spec2linspec(S,np,dt,iseed,fnLimit)">spec2linspec</a></li></TD>
<TD>  Separates the linear component of the Spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2skew.html" class="code" title=" [skew, kurt, ma, sa, Hs ,Hd]=spec2skew(S,h,method)">spec2skew</a></li></TD>
<TD> Estimates the moments of 2'nd order non-linear waves</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> Snew = <a name="_sub0" href="#_subfunctions" class="code">ttspec</a>(S,varargin)
002 <span class="comment">%TTSPEC Toggle Transform between angular frequency and frequency spectrum</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:  Snew = ttspec(S,ftype,thtype)</span>
005 <span class="comment">%</span>
006 <span class="comment">%     Snew = spectrum with new frequency type</span>
007 <span class="comment">%        S = spectrum </span>
008 <span class="comment">%    ftype = 'f' if Snew should be given with frequency in Hz</span>
009 <span class="comment">%            'w' if Snew should be given with angular frequency in rad/s</span>
010 <span class="comment">%            (default is the opposite of what is given in S)</span>
011 <span class="comment">%   thtype = 'radians' if Snew.theta should be given in radians (default)</span>
012 <span class="comment">%            'degrees' if Snew.theta should be given in degrees </span>
013 <span class="comment">%            </span>
014 <span class="comment">%</span>
015 <span class="comment">% If ftype is the same frequency type as for S then Snew = S</span>
016 <span class="comment">% If S is a wavenumber spectrum then Snew = S.</span>
017 <span class="comment">% </span>
018 <span class="comment">% Note: The order of ftype and thtype is arbitrary and only the</span>
019 <span class="comment">%       letters 'f','w','r' or 'd' is needed for unique identification</span>
020 <span class="comment">%</span>
021 <span class="comment">% Examples: Change from angular frequency to frequency in Hz and from</span>
022 <span class="comment">%          angle in radians to angle in degrees.  </span>
023 <span class="comment">%         S   = demospec('dir');</span>
024 <span class="comment">%         Sf  = ttspec(S);</span>
025 <span class="comment">%         Sf1 = ttspec(Sf,'f','d'); <span class="comment">% = ttspec(Sf,'f','degrees'); </span></span>
026 <span class="comment">%         wspecplot(S,3), figure(2)</span>
027 <span class="comment">%         wspecplot(Sf,3), figure(3)</span>
028 <span class="comment">%         wspecplot(Sf1,3)</span>
029 <span class="comment">%</span>
030 <span class="comment">% See also  datastructures</span>
031 
032 
033 
034 <span class="comment">%Tested on: Matlab 5.3, 5.2</span>
035 <span class="comment">% History: </span>
036 <span class="comment">% revised pab 22.06.2001</span>
037 <span class="comment">% - fixed a bug: S.phi field was not checked when 'd', or 'r' option was used.</span>
038 <span class="comment">% revised pab 13.06.2000</span>
039 <span class="comment">%  - added more checks on input</span>
040 <span class="comment">%  - added thtype</span>
041 <span class="comment">%  - removed recursive call to itself =&gt; more efficient code.</span>
042 <span class="comment">% revised pab 08.02.2000</span>
043 <span class="comment">%  - S can now be an array of structs</span>
044 <span class="comment">% revised pab 24.01.2000</span>
045 <span class="comment">%  -added ftype</span>
046 <span class="comment">% by pab 13.11.99</span>
047 
048 
049 
050 <span class="comment">% Error checking</span>
051 <span class="comment">%~~~~~~~~~~~~~~~</span>
052 <span class="keyword">if</span> ~isstruct(S)
053   error(<span class="string">'Input must be a spectral density struct)'</span>)
054 <span class="keyword">end</span>
055 <span class="keyword">if</span> ~(strcmpi(S(1).type(<span class="keyword">end</span>-2:<span class="keyword">end</span>),<span class="string">'req'</span>) |strcmpi(S(1).type(<span class="keyword">end</span>-2:<span class="keyword">end</span>),<span class="string">'dir'</span>))
056   disp(<span class="string">'This is not a frequency spectrum. Nothing is changed.'</span>)
057   Snew = S; <span class="comment">% return old if not a freq</span>
058   <span class="keyword">return</span>
059 <span class="keyword">end</span>
060 
061 ind = [isfield(S,<span class="string">'f'</span>), isfield(S,<span class="string">'w'</span>)];
062 <span class="keyword">if</span> all(ind==0),
063   error(<span class="string">'This is not a correct spectral density struct: w and f field does not exist'</span>)
064 <span class="keyword">elseif</span> all(ind==1),
065   error(<span class="string">'This is not a correct spectral density struct: w and f field can not both exist'</span>)
066 <span class="keyword">end</span>
067 
068 <span class="comment">% Setting default values</span>
069 <span class="comment">%~~~~~~~~~~~~~~~~~~~~~~~~~</span>
070 ftypeold = <span class="string">'wf'</span>;
071 ftype    = ftypeold(ind); 
072 ftypeold = ftypeold(~ind);
073 thtype   = <span class="string">'radians'</span>; 
074 
075 P = varargin; Np = length(P);
076 <span class="keyword">for</span> ix=1:Np,
077   <span class="keyword">switch</span> lower(P{ix}(1)),
078     <span class="keyword">case</span> {<span class="string">'f'</span>,<span class="string">'w'</span>}, ftype = lower(P{ix});
079     <span class="keyword">case</span> {<span class="string">'d'</span>,<span class="string">'r'</span>}, thtype = lower(P{ix});
080   <span class="keyword">end</span>
081 <span class="keyword">end</span>
082 
083 
084 <span class="comment">% Main computations</span>
085 <span class="comment">%~~~~~~~~~~~~~~~~~~~</span>
086 isphi = isfield(S , <span class="string">'theta'</span>);
087 Ns       = length(S(:));
088 <span class="keyword">if</span> strcmp(ftypeold,ftype)
089   Snew = S; <span class="comment">% nothing is changed</span>
090   
091   <span class="keyword">if</span> isfield(S , <span class="string">'theta'</span>)
092     <span class="keyword">for</span> iy=1:Ns,
093       <span class="keyword">if</span> strcmpi(S(iy).type(<span class="keyword">end</span>-2:<span class="keyword">end</span>),<span class="string">'dir'</span>),  <span class="comment">% Directional spectrum </span>
094     <span class="keyword">if</span> (abs(max(S(iy).theta)-min(S(iy).theta))&gt;3*pi)  <span class="comment">% theta given in degrees</span>
095       <span class="keyword">if</span> strcmpi(thtype(1),<span class="string">'r'</span>),  <span class="comment">% radians wanted</span>
096         Snew(iy).theta = S(iy).theta*pi/180;
097         Snew(iy).S     = S(iy).S*180/pi;
098         <span class="keyword">if</span> isphi,  Snew(iy).phi     = S(iy).phi*pi/180;<span class="keyword">end</span>
099       <span class="keyword">end</span> 
100     <span class="keyword">else</span>                             <span class="comment">% theta given in radians</span>
101       <span class="keyword">if</span> strcmpi(thtype(1),<span class="string">'d'</span>),  <span class="comment">% degrees wanted </span>
102         Snew(iy).theta = S(iy).theta*180/pi; 
103         Snew(iy).S     = S(iy).S*pi/180;
104         <span class="keyword">if</span> isphi,  Snew(iy).phi     = S(iy).phi*180/pi;<span class="keyword">end</span>
105       <span class="keyword">end</span> 
106     <span class="keyword">end</span>
107       <span class="keyword">end</span>
108     <span class="keyword">end</span>
109   <span class="keyword">end</span>
110 <span class="keyword">else</span> <span class="comment">% change to new type</span>
111   fnames   = fieldnames(S(1));
112   ind      = strmatch(ftypeold,fnames);
113   fnames   = {fnames{[1:ind-1, ind+1:<span class="keyword">end</span>] }};
114   
115   Snew  = <a href="createspec.html" class="code" title=" Spectrum structure constructor">createspec</a>(S(1).type,ftype);
116   <span class="keyword">for</span> ix = 1:length(fnames),             <span class="comment">% make sure all non-standard elements of S</span>
117                                          <span class="comment">% are also transfeered to Snew</span>
118     Snew = setfield(Snew,fnames{ix},[]);
119   <span class="keyword">end</span>
120   Snew(Ns) = Snew(1); <span class="comment">% make sure it is an array of structs</span>
121   
122   <span class="keyword">for</span> iy=1:Ns,
123     <span class="keyword">for</span> ix = 1:length(fnames),
124       Snew(iy) = setfield(Snew(iy),fnames{ix},getfield(S(iy),fnames{ix}));
125     <span class="keyword">end</span>
126     <span class="keyword">if</span> strcmp(ftypeold,<span class="string">'f'</span>)    
127       Snew(iy).w = S(iy).f*2*pi;
128       Snew(iy).S = S(iy).S/(2*pi);
129     <span class="keyword">else</span>
130       Snew(iy).f = S(iy).w/(2*pi);
131       Snew(iy).S = S(iy).S*(2*pi);
132     <span class="keyword">end</span>
133     
134     <span class="keyword">if</span> strcmpi(S(iy).type(<span class="keyword">end</span>-2:<span class="keyword">end</span>),<span class="string">'dir'</span>),  <span class="comment">% Directional spectrum </span>
135       <span class="keyword">if</span> (abs(max(S(iy).theta)-min(S(iy).theta))&gt;3*pi)  <span class="comment">% theta given in degrees</span>
136     <span class="keyword">if</span> strcmpi(thtype(1),<span class="string">'r'</span>), <span class="comment">% radians wanted</span>
137       Snew(iy).theta = S(iy).theta*pi/180; 
138       Snew(iy).S     = Snew(iy).S*180/pi;
139        <span class="keyword">if</span> isphi,  Snew(iy).phi     = S(iy).phi*pi/180;<span class="keyword">end</span>
140     <span class="keyword">end</span> 
141       <span class="keyword">else</span>                            <span class="comment">% theta given in radians</span>
142     <span class="keyword">if</span> strcmpi(thtype(1),<span class="string">'d'</span>), <span class="comment">% degrees wanted </span>
143       Snew(iy).theta = S(iy).theta*180/pi;
144       Snew(iy).S     = Snew(iy).S*pi/180;
145        <span class="keyword">if</span> isphi,  Snew(iy).phi     = S(iy).phi*180/pi;<span class="keyword">end</span>
146     <span class="keyword">end</span> 
147       <span class="keyword">end</span>
148     <span class="keyword">end</span>
149   <span class="keyword">end</span> <span class="comment">% iy</span>
150 <span class="keyword">end</span>
151 
152</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>