<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of wnormspec</title>
  <meta name="keywords" content="wnormspec">
  <meta name="description" content=" Normalize a spectral density such that m0=m2=1">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">spec</a> &gt; wnormspec.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\spec&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>wnormspec
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Normalize a spectral density such that m0=m2=1</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [S,mn4,m0,m2,m4,m1]=wnormspec(spectrum,m0,m2,plotflag) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="wnormspec.html" class="code" title=" Normalize a spectral density such that m0=m2=1">WNORMSPEC</a> Normalize a spectral density such that m0=m2=1
 
  CALL:  [<a href="../../wafo/data/sn.html" class="code" title=" Fatigue experiment, constant-amplitude loading.">Sn</a>,mn4,m0,m2,m4,m1]=<a href="wnormspec.html" class="code" title=" Normalize a spectral density such that m0=m2=1">wnormspec</a>(S,m0,m2,plotflag);
 
         <a href="../../wafo/data/sn.html" class="code" title=" Fatigue experiment, constant-amplitude loading.">Sn</a>  = the normalized spectrum struct
         mn4 = the fourth spectral moment of <a href="../../wafo/data/sn.html" class="code" title=" Fatigue experiment, constant-amplitude loading.">Sn</a>.
         mi  = the i'th spectral moment of S.
         S   = the original spectrum struct
    plotflag = 0, do not plot the normalized spectrum (default).
               1, plot the normalized spectrum.
            
  Normalization performed such that
     INT S(freq) dfreq = 1       INT freq^2  S(freq) dfreq = 1
  where integration limits are given by  freq  and  S(freq)  is the 
  spectral density; freq can be frequency or wave number.
  The normalization is defined by
  A=sqrt(m0/m2); B=1/A/m0; freq'=freq*A; S(freq')=S(freq)*B;
 
  If S is a directional spectrum then a normalized <a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a> (.g) is added
  to <a href="../../wafo/data/sn.html" class="code" title=" Fatigue experiment, constant-amplitude loading.">Sn</a>, such that mxx normalizes to 1, as well as m0 and mtt.
  (See <a href="spec2mom.html" class="code" title=" Calculates spectral moments from spectrum">spec2mom</a> for notation of moments)
 
  If S is complex-valued cross spectral density which has to be
  normalized, then m0, m2 (suitable spectral moments) should be given.
 
  Example: 
    S = <a href="jonswap.html" class="code" title=" Calculates (and plots) a JONSWAP spectral density">jonswap</a>;
    [<a href="../../wafo/data/sn.html" class="code" title=" Fatigue experiment, constant-amplitude loading.">Sn</a>,mn4] = <a href="wnormspec.html" class="code" title=" Normalize a spectral density such that m0=m2=1">wnormspec</a>(S);
    mts = <a href="spec2mom.html" class="code" title=" Calculates spectral moments from spectrum">spec2mom</a>(S,2)     % Should be equal to one!
  
  See also  <a href="spec2mom.html" class="code" title=" Calculates spectral moments from spectrum">spec2mom</a>, <a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/misc/gravity.html" class="code" title=" g=gravity(phi)">gravity</a></li></TD>
<TD>  returns the constant acceleration of gravity</TD>
</TR>
<TR>
<TD><li><a href="spec2spec.html" class="code" title=" [Snew]=spec2spec(S,newtype,phi,v)">spec2spec</a></li></TD>
<TD> Transforms between different types of spectra</TD>
</TR>
<TR>
<TD><li><a href="wspecplot.html" class="code" title=" wspecplot(S,varargin)">wspecplot</a></li></TD>
<TD> Plot a spectral density</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\timefun\datestr.m">datestr</a></li></TD>
<TD>       String representation of date.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\@double\exist.bi">exist</a></li></TD>
<TD>         Check if variables or functions are defined.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\@fighandle\isfield.m">isfield</a></li></TD>
<TD>       True if field is in structure array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\timefun\now.m">now</a></li></TD>
<TD>           Current date and time as date number.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\trapz.m">trapz</a></li></TD>
<TD>         Trapezoidal numerical integration.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/onedim/dat2spec.html" class="code" title=" [S,fcut] = dat2spec(xn,varargin)">dat2spec</a></li></TD>
<TD> Estimate one-sided spectral density from data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/onedim/dat2spec2.html" class="code" title=" S = dat2spec2(xn,L,g,plotflag,wdef,dT,chopOffHighFreq)">dat2spec2</a></li></TD>
<TD> Estimate one-sided spectral density, version 2.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2AcAt.html" class="code" title=" [f] = spec2AcAt(spec,utc,def,paramtc,paramtt,paramt,h1,h2,nit,speed,bound)">spec2AcAt</a></li></TD>
<TD>   Evaluates survival function R(h1,h2)=P(Ac>h1,At>h2).</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2Acdf.html" class="code" title=" [f] = spec2Acdf(spec,utc,def,paramt,h,nit,speed,bound)">spec2Acdf</a></li></TD>
<TD>  Evaluates cdf of crests P(Ac<=h) or troughs P(At<=h).</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2cmat.html" class="code" title=" [f, fmm] = spec2cmat(spec,utc,def,paramt,paramu,nit)">spec2cmat</a></li></TD>
<TD> Joint intensity matrix for cycles (max,min)-, rainflow- and (crest,trough)</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2mmtpdf.html" class="code" title=" f = spec2mmtpdf(spec,utc,def,paramt,paramu,options,bound)">spec2mmtpdf</a></li></TD>
<TD> Calculates joint density of Maximum, minimum and period.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wsim/spec2sdat.html" class="code" title=" [x,xder]=spec2sdat(S,np,dt,iseed,method)">spec2sdat</a></li></TD>
<TD> Simulates a Gaussian process and its derivative from spectrum</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2tccpdf.html" class="code" title=" [f] = spec2tccpdf(spec,utc,def,paramt,h1,h2,nit,speed,bound,plotflag)">spec2tccpdf</a></li></TD>
<TD> Evaluates densities of wave period Tcc, wave lenght Lcc.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2thpdf.html" class="code" title=" f = spec2thpdf(spec,utc,def,paramt,h,options,plotflag)">spec2thpdf</a></li></TD>
<TD> Joint density of amplitude and period/wave-length characteristics</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2tpdf.html" class="code" title=" [f] = spec2tpdf(spec,utc,def,paramt,h,nit,speed,bound,plotflag)">spec2tpdf</a></li></TD>
<TD> Evaluates densities for crest-,trough-period, length.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/spec2tpdf2.html" class="code" title=" [f] = spec2tpdf2(spec,utc,def,paramt,varargin)">spec2tpdf2</a></li></TD>
<TD> Evaluates densities for various wave periods or wave lengths</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [S,mn4,m0,m2,m4,m1]=<a name="_sub0" href="#_subfunctions" class="code">wnormspec</a>(spectrum,m0,m2,plotflag)
002 <span class="comment">%WNORMSPEC Normalize a spectral density such that m0=m2=1</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:  [Sn,mn4,m0,m2,m4,m1]=wnormspec(S,m0,m2,plotflag);</span>
005 <span class="comment">%</span>
006 <span class="comment">%        Sn  = the normalized spectrum struct</span>
007 <span class="comment">%        mn4 = the fourth spectral moment of Sn.</span>
008 <span class="comment">%        mi  = the i'th spectral moment of S.</span>
009 <span class="comment">%        S   = the original spectrum struct</span>
010 <span class="comment">%   plotflag = 0, do not plot the normalized spectrum (default).</span>
011 <span class="comment">%              1, plot the normalized spectrum.</span>
012 <span class="comment">%           </span>
013 <span class="comment">% Normalization performed such that</span>
014 <span class="comment">%    INT S(freq) dfreq = 1       INT freq^2  S(freq) dfreq = 1</span>
015 <span class="comment">% where integration limits are given by  freq  and  S(freq)  is the </span>
016 <span class="comment">% spectral density; freq can be frequency or wave number.</span>
017 <span class="comment">% The normalization is defined by</span>
018 <span class="comment">% A=sqrt(m0/m2); B=1/A/m0; freq'=freq*A; S(freq')=S(freq)*B;</span>
019 <span class="comment">%</span>
020 <span class="comment">% If S is a directional spectrum then a normalized gravity (.g) is added</span>
021 <span class="comment">% to Sn, such that mxx normalizes to 1, as well as m0 and mtt.</span>
022 <span class="comment">% (See spec2mom for notation of moments)</span>
023 <span class="comment">%</span>
024 <span class="comment">% If S is complex-valued cross spectral density which has to be</span>
025 <span class="comment">% normalized, then m0, m2 (suitable spectral moments) should be given.</span>
026 <span class="comment">%</span>
027 <span class="comment">% Example: </span>
028 <span class="comment">%   S = jonswap;</span>
029 <span class="comment">%   [Sn,mn4] = wnormspec(S);</span>
030 <span class="comment">%   mts = spec2mom(S,2)     <span class="comment">% Should be equal to one!</span></span>
031 <span class="comment">% </span>
032 <span class="comment">% See also  spec2mom, spec2spec </span>
033 
034 <span class="comment">% Tested on: Matlab 5.3</span>
035 <span class="comment">%</span>
036 <span class="comment">% History:</span>
037 <span class="comment">% revised ir 31.08.01, introducing normalizing  g for w-spectrum</span>
038 <span class="comment">% Revised by jr 20.04.2001</span>
039 <span class="comment">% - Condition on nargout related to calculation of mn4; minor change</span>
040 <span class="comment">% - Updated information, added example</span>
041 <span class="comment">% By es 28.09.1999</span>
042 
043 <span class="keyword">if</span>  nargin==2 &amp; ~isempty(m0)
044   plotflag=m0;
045 <span class="keyword">end</span>
046 <span class="keyword">if</span> (nargin&lt;4 &amp; nargin ~=2)|isempty(plotflag)
047   <span class="keyword">if</span> nargout==0,
048     plotflag=1;
049   <span class="keyword">else</span>
050     plotflag=0;
051   <span class="keyword">end</span>
052 <span class="keyword">end</span>
053 
054 <span class="keyword">if</span> strcmp(lower(spectrum.type(<span class="keyword">end</span>-2:<span class="keyword">end</span>)),<span class="string">'k2d'</span>)
055   intype=spectrum.type;
056   spectrum=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(spectrum,<span class="string">'dir'</span>);
057 <span class="keyword">end</span>
058   
059 S=spectrum.S;   <span class="comment">% size np x nf</span>
060 
061 <span class="keyword">if</span> isfield(spectrum,<span class="string">'w'</span>)
062   f=spectrum.w(:); <span class="comment">% length nf</span>
063 <span class="keyword">elseif</span> isfield(spectrum,<span class="string">'k'</span>)
064   f=spectrum.k(:);
065 <span class="keyword">else</span>
066   f=2*pi*spectrum.f(:);
067   S=S/2/pi;
068 <span class="keyword">end</span>
069 
070 <span class="keyword">if</span> (nargin&lt;3)|isempty(m0)|isempty(m2)
071   S1=abs(S);
072   <span class="keyword">if</span> strcmp(lower(spectrum.type(<span class="keyword">end</span>-2:<span class="keyword">end</span>)),<span class="string">'dir'</span>)
073     <span class="comment">% integrate out theta:</span>
074     S2=trapz(spectrum.theta(:),<span class="keyword">...</span>
075          S1.*(cos(spectrum.theta(:)*ones(size(f'))).^2),1);
076    
077     m20=trapz(f,f.^4/<a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>^2.*S2.',1); <span class="comment">% second order moment in x</span>
078     m02=trapz(f,f.^4/<a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>^2.*trapz(spectrum.theta(:),S1.*<span class="keyword">...</span>
079     (sin(spectrum.theta(:)*ones(size(f'))).^2),1).',1); <span class="comment">% second order moment in y</span>
080     S1=trapz(spectrum.theta(:),S1,1).'; <span class="comment">% integrate out theta</span>
081     mom=trapz(f,[S1  f.*S1 f.^2.*S1 f.^4.*S1] ,1);
082     m0=mom(1); m1=mom(2); m2=mom(3);  m4=mom(4);
083   <span class="keyword">else</span>
084     S1=S1(:);
085     mom=trapz(f,[S1  f.*S1 f.^2.*S1 f.^4.*S1] ,1);
086     m0=mom(1); m1=mom(2); m2=mom(3);  m4=mom(4);
087     <span class="keyword">if</span> isfield(spectrum,<span class="string">'w'</span>)
088        m02=m4/<a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>^2;
089         m20=m02;
090     <span class="keyword">end</span>    
091   <span class="keyword">end</span>
092 <span class="keyword">end</span>
093  
094 SM0=sqrt(m0); SM2=sqrt(m2);
095 A=SM0/SM2;
096 B=SM2/(SM0*m0);
097 
098 f=f*A;
099 S1=S*B;
100 
101 <span class="keyword">if</span> (nargout &gt;= 2)&amp;nargin&lt;3
102   mn4 = m4*A^5*B;
103 <span class="keyword">elseif</span> (nargout &gt;= 2)&amp; (nargin&gt;3)
104   mn4=trapz(f,[f.^4.*S1] );
105 <span class="keyword">end</span>
106 
107 S=spectrum;
108 S.S=S1;
109 <span class="keyword">if</span> isfield(spectrum,<span class="string">'w'</span>)
110   S.w=f;
111 <span class="keyword">elseif</span> isfield(spectrum,<span class="string">'k'</span>)
112   S.k=f;
113 <span class="keyword">else</span>
114   S.f=f/2/pi;
115   S.S=S.S*2*pi;
116 <span class="keyword">end</span>
117 <span class="keyword">if</span> strcmp(lower(spectrum.type(<span class="keyword">end</span>-2:<span class="keyword">end</span>)),<span class="string">'dir'</span>)
118   S.g=[<a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>*sqrt(m0*m20)/m2 <a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>*sqrt(m0*m02)/m2];
119   <span class="comment">% normalization gravity in x and y, resp.</span>
120 <span class="keyword">end</span>
121 <span class="keyword">if</span> isfield(spectrum,<span class="string">'w'</span>)
122   S.g=[<a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>*sqrt(m0*m20)/m2];
123 <span class="keyword">end</span>
124 
125 S.norm=1;
126 S.date=datestr(now);
127 <span class="keyword">if</span> exist(<span class="string">'intype'</span>)
128   S=<a href="spec2spec.html" class="code" title=" Transforms between different types of spectra">spec2spec</a>(S,intype);
129 <span class="keyword">end</span>  
130 <span class="keyword">if</span> plotflag
131   <a href="wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S)
132 <span class="keyword">end</span>
133</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>