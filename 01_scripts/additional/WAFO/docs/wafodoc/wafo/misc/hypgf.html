<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of hypgf</title>
  <meta name="keywords" content="hypgf">
  <meta name="description" content="  Hypergeometric function F(a,b,c,x)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">misc</a> &gt; hypgf.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\misc&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>hypgf
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>  Hypergeometric function F(a,b,c,x)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [y ,abserr] = hypgf(a,b,c,x,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="hypgf.html" class="code" title="  Hypergeometric function F(a,b,c,x) ">HYPGF</a>  Hypergeometric function F(a,b,c,x) 
 
  CALL:   [y ,abserr] = <a href="hypgf.html" class="code" title="  Hypergeometric function F(a,b,c,x) ">hypgf</a>(a,b,c,x,abseps,releps) 
 
        y = F(a,b,c,x)
   abserr = absolute error estimate
  a,b,c,x = input parameters
  abseps  = requested absolute error
  releps  = requested relative error  
 
  <a href="hypgf.html" class="code" title="  Hypergeometric function F(a,b,c,x) ">HYPGF</a> calculates one solution to Gauss's hypergeometric differential
  equation:
 
     x*(1-x)Y''(x)+[c-(a+b+1)*x]*Y'(x)-a*b*Y(x) = 0
  where
    F(a,b,c,x) = Y1(x) = 1 + a*b*x/c + a*(a+1)*b*(b+1)*x^2/(c*(c+1))+.... 
 
    
  Many elementary functions are special cases of F(a,b,c,x):
  1/(1-x) = F(1,1,1,x) = F(1,b,b,x) = F(a,1,a,x)
  (1+x)^n = F(-n,b,b,-x)
  atan(x) = x*F(.5,1,1.5,-x^2)
  asin(x) = x*F(.5,.5,1.5,x^2)
  log(x)  = x*F(1,1,2,-x)
  log(1+x)-log(1-x) = 2*x*F(.5,1,1.5,x^2)
   
   NOTE: only real x, abs(x) &lt; 1 and c~=0,-1,-2,... are allowed.
 
  Examples:
  x = linspace(-.99,.99)';
  [Sn1,err1] = <a href="hypgf.html" class="code" title="  Hypergeometric function F(a,b,c,x) ">hypgf</a>(1,1,1,x);   
  plot(x,abs(Sn1-1./(1-x)),'b',x,err1,'r'),set(gca,'yscale','log')
  [Sn2,err2] = <a href="hypgf.html" class="code" title="  Hypergeometric function F(a,b,c,x) ">hypgf</a>(.5,.5,1.5,x.^2);  
  plot(x,abs(x.*Sn2-asin(x)),'b',x,abs(x.*err2),'r'),set(gca,'yscale','log')</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="comnsize.html" class="code" title=" [errorcode,varargout] = comnsize(varargin)">comnsize</a></li></TD>
<TD> Check if all input arguments are either scalar or of common size.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\cell.m">cell</a></li></TD>
<TD>          Create cell array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specfun\gamma.dll">gamma</a></li></TD>
<TD>         Gamma function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\specfun\gammaln.m">gammaln</a></li></TD>
<TD>       Logarithm of gamma function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\nan.m">nan</a></li></TD>
<TD>           Not-a-Number.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\sprintf.m">sprintf</a></li></TD>
<TD>       Write formatted data to string.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strncmpi.bi">strncmpi</a></li></TD>
<TD>      Compare first N characters of strings ignoring case.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\warning.m">warning</a></li></TD>
<TD>       Display warning message; disable or enable warning messages.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/wstats/weib2dfit.html" class="code" title=" [phat, cov,pci]=weib2dfit(data1,data2,method,given,gparam,alpha)">weib2dfit</a></li></TD>
<TD> Parameter estimates for 2D Weibull data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wstats/weib2dstat.html" class="code" title=" [M ,V ,Tm ,cvar, tolm, tolv] = weib2dstat(a1,b1,a2,b2,c12,condon,cvar,tol)">weib2dstat</a></li></TD>
<TD>  Mean and variance for the 2D Weibull distribution</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code"> [fsum, err]=gethgf(a,b,c,x,absEps,relEps,Kmax)</a></li><li><a href="#_sub2" class="code"> [result,abserr] =dea3(E0,E1,E2)</a></li><li><a href="#_sub3" class="code"> [fsum, delta]=gethgf2(a,b,c,z)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [y ,abserr] = <a name="_sub0" href="#_subfunctions" class="code">hypgf</a>(a,b,c,x,varargin)
002 <span class="comment">%HYPGF  Hypergeometric function F(a,b,c,x) </span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:   [y ,abserr] = hypgf(a,b,c,x,abseps,releps) </span>
005 <span class="comment">%</span>
006 <span class="comment">%       y = F(a,b,c,x)</span>
007 <span class="comment">%  abserr = absolute error estimate</span>
008 <span class="comment">% a,b,c,x = input parameters</span>
009 <span class="comment">% abseps  = requested absolute error</span>
010 <span class="comment">% releps  = requested relative error  </span>
011 <span class="comment">%</span>
012 <span class="comment">% HYPGF calculates one solution to Gauss's hypergeometric differential</span>
013 <span class="comment">% equation:</span>
014 <span class="comment">%</span>
015 <span class="comment">%    x*(1-x)Y''(x)+[c-(a+b+1)*x]*Y'(x)-a*b*Y(x) = 0</span>
016 <span class="comment">% where</span>
017 <span class="comment">%   F(a,b,c,x) = Y1(x) = 1 + a*b*x/c + a*(a+1)*b*(b+1)*x^2/(c*(c+1))+.... </span>
018 <span class="comment">%</span>
019 <span class="comment">%   </span>
020 <span class="comment">% Many elementary functions are special cases of F(a,b,c,x):</span>
021 <span class="comment">% 1/(1-x) = F(1,1,1,x) = F(1,b,b,x) = F(a,1,a,x)</span>
022 <span class="comment">% (1+x)^n = F(-n,b,b,-x)</span>
023 <span class="comment">% atan(x) = x*F(.5,1,1.5,-x^2)</span>
024 <span class="comment">% asin(x) = x*F(.5,.5,1.5,x^2)</span>
025 <span class="comment">% log(x)  = x*F(1,1,2,-x)</span>
026 <span class="comment">% log(1+x)-log(1-x) = 2*x*F(.5,1,1.5,x^2)</span>
027 <span class="comment">%  </span>
028 <span class="comment">%  NOTE: only real x, abs(x) &lt; 1 and c~=0,-1,-2,... are allowed.</span>
029 <span class="comment">%</span>
030 <span class="comment">% Examples:</span>
031 <span class="comment">% x = linspace(-.99,.99)';</span>
032 <span class="comment">% [Sn1,err1] = hypgf(1,1,1,x);   </span>
033 <span class="comment">% plot(x,abs(Sn1-1./(1-x)),'b',x,err1,'r'),set(gca,'yscale','log')</span>
034 <span class="comment">% [Sn2,err2] = hypgf(.5,.5,1.5,x.^2);  </span>
035 <span class="comment">% plot(x,abs(x.*Sn2-asin(x)),'b',x,abs(x.*err2),'r'),set(gca,'yscale','log')</span>
036 <span class="comment">%</span>
037 
038 
039 
040 <span class="comment">% Reference:</span>
041 <span class="comment">% Kreyszig, Erwin (1988)</span>
042 <span class="comment">% Advanced engineering mathematics</span>
043 <span class="comment">% John Wiley &amp; Sons, sixth edition, pp 204.</span>
044 
045 <span class="comment">% Revised pab 30.08.2004</span>
046 <span class="comment">% -added dea3 for more stable error estimation</span>
047 <span class="comment">% revised pab 18.04.2001</span>
048 <span class="comment">% - updated help header</span>
049 <span class="comment">% - added example</span>
050 <span class="comment">% - added reference</span>
051 <span class="comment">% By Per A. Brodtkorb 17.11.98</span>
052 [errorcode,  x, a, b, c] = <a href="comnsize.html" class="code" title=" Check if all input arguments are either scalar or of common size.">comnsize</a>(x,a,b ,c);
053 <span class="keyword">if</span> errorcode &gt; 0
054   error(<span class="string">'Requires non-scalar arguments to match in size.'</span>);
055 <span class="keyword">end</span>
056   
057 [y,abserr] = <a href="#_sub1" class="code" title="sub  [fsum, err]=gethgf(a,b,c,x,absEps,relEps,Kmax)">gethgf</a>(a,b,c,x,varargin{:});
058  
059 <span class="keyword">return</span>
060 
061 <span class="keyword">function</span>  [fsum, err]=<a name="_sub1" href="#_subfunctions" class="code">gethgf</a>(a,b,c,x,absEps,relEps,Kmax)
062   error(nargchk(4,7,nargin))
063   <span class="keyword">if</span> (nargin&lt;7|isempty(Kmax))
064     Kmax  = 10000;  
065   <span class="keyword">end</span>
066   Kmin = 2;
067   <span class="keyword">if</span> (nargin&lt;6 | isempty(relEps)),
068     relEps   = eps*10;
069   <span class="keyword">end</span>
070   <span class="keyword">if</span> (nargin&lt;5|isempty(absEps))
071     absEps   = 0;<span class="comment">%eps*10;</span>
072   <span class="keyword">end</span>
073   useDEA = 1;
074   <span class="comment">%abseps = max(abseps,eps*10); </span>
075    
076   fsum  = zeros(size(x));   
077   delta = fsum;
078   err   = fsum;
079   
080   ok    = ~((round(c)==c &amp; c&lt;=0) | abs(x)&gt;1);
081   k1=find(~ok);
082   <span class="keyword">if</span> any(k1), 
083     warning(<span class="string">'Illegal input: c = 0,-1,-2,... or abs(x)&gt;1'</span>)
084     fsum(k1) = NaN;
085     err(k1)  = NaN;
086   <span class="keyword">end</span>
087   k0=find(ok &amp; abs(x)==1);
088   <span class="keyword">if</span> any(k0)
089     cmab = c(k0)-a(k0)-b(k0);
090     fsum(k0) = exp(gammaln(c(k0))+gammaln(cmab)-<span class="keyword">...</span>
091            gammaln(c(k0)-a(k0))-gammaln(c(k0)-b(k0)));
092     err(k0) = eps;
093     k00 = find(real(cmab)&lt;=0);
094     <span class="keyword">if</span> any(k00)
095       err(k0(k00)) = nan;
096       fsum(k0(k00)) = nan;
097     <span class="keyword">end</span>
098   <span class="keyword">end</span>
099   k=find(ok &amp; abs(x)&lt;1);
100   <span class="keyword">if</span> any(k),
101     delta(k) = ones(size(k));
102     fsum(k)  = delta(k);
103     
104     k1 = k;
105     E = cell(1,3);
106     E{3} = fsum(k);
107     converge = <span class="string">'n'</span>;
108     <span class="keyword">for</span>  ix=0:Kmax-1,
109       delta(k1) = delta(k1).*((a(k1)+ix)./(ix+1)).*((b(k1)+ix)./(c(k1)+ <span class="keyword">...</span>
110                           ix)).*x(k1);
111       fsum(k1) = fsum(k1)+delta(k1);
112       
113       E(1:2) = E(2:3);
114       E{3}   = fsum(k1);
115       
116       <span class="keyword">if</span> ix&gt;Kmin
117     <span class="keyword">if</span> useDEA,
118       [Sn, err(k1)] = <a href="#_sub2" class="code" title="sub  [result,abserr] =dea3(E0,E1,E2)">dea3</a>(E{:});
119       k00 = find((abs(err(k1))) &lt;= max(absEps,abs(relEps.*fsum(k1))));
120       <span class="keyword">if</span> any(k00)
121         fsum(k1(k00)) = Sn(k00);
122       <span class="keyword">end</span>
123       <span class="keyword">if</span> (ix==Kmax-1)
124         fsum(k1) = Sn;
125       <span class="keyword">end</span>
126       k0 = (find((abs(err(k1))) &gt; max(absEps,abs(relEps.*fsum(k1)))));
127        <span class="keyword">if</span> any(k0),<span class="comment">% compute more terms</span>
128          nk=length(k0);<span class="comment">%# of values we have to compute again</span>
129          E{2} = E{2}(k0);
130          E{3} = E{3}(k0);
131        <span class="keyword">else</span>
132          converge=<span class="string">'y'</span>;
133          <span class="keyword">break</span>;
134        <span class="keyword">end</span>
135     <span class="keyword">else</span>
136       err(k1) = 10*abs(delta(k1));
137        k0 = (find((abs(err(k1))) &gt; max(absEps,abs(relEps.* <span class="keyword">...</span>
138                             fsum(k1)))));
139        <span class="keyword">if</span> any(k0),<span class="comment">% compute more terms</span>
140          nk=length(k0);<span class="comment">%# of values we have to compute again</span>
141        <span class="keyword">else</span>
142          converge=<span class="string">'y'</span>;
143          <span class="keyword">break</span>;
144        <span class="keyword">end</span>
145     <span class="keyword">end</span>
146     k1 = k1(k0);
147       <span class="keyword">end</span>
148     <span class="keyword">end</span>
149     <span class="keyword">if</span> ~strncmpi(converge,<span class="string">'y'</span>,1)
150       disp(sprintf(<span class="string">'#%d values did not converge'</span>,length(k1)))
151     <span class="keyword">end</span>
152   <span class="keyword">end</span>
153   <span class="comment">%ix</span>
154   <span class="keyword">return</span>
155 <span class="keyword">function</span> [result,abserr]  =<a name="_sub2" href="#_subfunctions" class="code">dea3</a>(E0,E1,E2)
156 <span class="comment">%DEA3 Extrapolate a slowly convergent sequence</span>
157 <span class="comment">%</span>
158 <span class="comment">%  CALL: [result,abserr]  =dea3(E0,E1,E2)</span>
159 <span class="comment">%</span>
160 <span class="comment">%  result   = extrapolated value</span>
161 <span class="comment">%  abserr   = absolute error estimate  </span>
162 <span class="comment">%  E0,E1,E2 = 3 values of a convergent sequence to extrapolate</span>
163 <span class="comment">%  </span>
164 <span class="comment">% DEA3  attempts to extrapolate nonlinearly to a better estimate of the</span>
165 <span class="comment">%      sequence's limiting value, thus improving the rate of</span>
166 <span class="comment">%       convergence. Routine is based on the epsilon algorithm</span>
167 <span class="comment">%            of P. Wynn. </span>
168 <span class="comment">% </span>
169 <span class="comment">% Example <span class="comment">% integrate sin(x) from 0 to pi/2</span></span>
170 <span class="comment">%   for I = 5:7</span>
171 <span class="comment">%      NPARTS = 2.^I;</span>
172 <span class="comment">%      x = linspace(0,pi/2,2.^I+1);</span>
173 <span class="comment">%      Ei(I-4) = trapz(x,sin(x))  </span>
174 <span class="comment">%   end</span>
175 <span class="comment">%   [En, err] = dea3(Ei(1),Ei(2),Ei(3))  </span>
176 <span class="comment">%   truErr = Ei-1  </span>
177   
178 <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">% -*- Mode: Matlab -*- <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
179 <span class="comment">%<span class="comment">% dea3.m --- </span></span>
180 <span class="comment">%<span class="comment">% Author          : Per Andreas Brodtkorb</span></span>
181 <span class="comment">%<span class="comment">% Created On      : Wed Aug 18 12:40:23 2004</span></span>
182 <span class="comment">%<span class="comment">% Last Modified By: Per Andreas Brodtkorb</span></span>
183 <span class="comment">%<span class="comment">% Last Modified On: Wed Aug 18 12:51:49 2004</span></span>
184 <span class="comment">%<span class="comment">% Update Count    : 3</span></span>
185 <span class="comment">%<span class="comment">% Status          : Unknown, Use with caution!</span></span>
186 <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
187 
188 <span class="comment">% REFERENCES  &quot;Acceleration de la convergence en analyse numerique&quot;,</span>
189 <span class="comment">%                 C. Brezinski, &quot;Lecture Notes in Math.&quot;, vol. 584,</span>
190 <span class="comment">%                 Springer-Verlag, New York, 1977.</span>
191   
192   
193 error(nargchk(3,3,nargin))
194 ten = 10.0d0;
195 one = 1.0d0;
196 small  = eps; <span class="comment">%spacing(one)</span>
197 delta2 = E2 - E1;
198 delta1 = E1 - E0;
199 err2   = abs(delta2);
200 err1   = abs(delta1);
201 tol2   = max(abs(E2),abs(E1)) * small;
202 tol1   = max(abs(E1),abs(E0)) * small;
203 
204 result = zeros(size(E0));
205 abserr = result;
206 
207 k0 = find( ( err1 &lt;= tol1 ) | (err2 &lt;= tol2));
208 <span class="keyword">if</span> any(k0)
209   <span class="comment">%C           IF E0, E1 AND E2 ARE EQUAL TO WITHIN MACHINE</span>
210   <span class="comment">%C           ACCURACY, CONVERGENCE IS ASSUMED.</span>
211   result(k0) = E2(k0);
212   abserr(k0) = err1(k0) + err2(k0) + E2(k0)*small*ten;
213 <span class="keyword">end</span>
214 k1 = find(~(( err1 &lt;= tol1 ) | (err2 &lt;= tol2)));
215 <span class="keyword">if</span> any(k1)
216   ss = one./delta2(k1) - one./delta1(k1);
217   k2 = k1(find((abs(ss.*E1(k1)) &lt;= 1.0d-3)));
218   <span class="keyword">if</span> any(k2)
219     result(k2) = E2(k2);
220     abserr(k2) = err1(k2) + err2(k2) + E2(k2)*small*ten;
221   <span class="keyword">end</span>
222   k3 = find(~(abs(ss.*E1(k1)) &lt;= 1.0d-3));
223   <span class="keyword">if</span> any(k3)
224     k33 = k1(k3);
225     result(k33) = E1(k33) + one./ss(k3);
226     abserr(k33) = err1(k33) + err2(k33) + abs(result(k33)-E2(k33));
227   <span class="keyword">end</span>
228 <span class="keyword">end</span>
229 <span class="keyword">return</span>
230    <span class="comment">%   end subroutine dea3</span>
231    
232    
233 <span class="keyword">function</span>  [fsum, delta]=<a name="_sub3" href="#_subfunctions" class="code">gethgf2</a>(a,b,c,z)
234    Kmax=10000;   fac=1;   tmps=0;
235    tmp   = (gamma(a).*gamma(b))./(fac.*gamma(c));
236    delta=tmp;
237    tol=eps;
238    <span class="keyword">for</span>  ix=1:Kmax
239      fac   = fac*ix;
240      tmp   = (gamma(a+ix).*gamma(b+ix))./(fac.*gamma(c+ix));
241      delta = tmp*(z.^ix); 
242 
243      <span class="comment">%                              don't bother with more terms than we use</span>
244      <span class="keyword">if</span> (max(abs(delta)) &lt;= tol) , <span class="keyword">break</span> ,<span class="keyword">end</span>
245      <span class="comment">%                            update</span>
246      tmps  = tmps + delta 
247    
248    <span class="keyword">end</span>
249    <span class="keyword">if</span> ix&gt;=Kmax, disp(<span class="string">'Some values did not converge'</span>), <span class="keyword">end</span>
250     fsum=(gamma(c)./(gamma(a).*gamma(b))).*tmps;
251      delta=(gamma(c)./(gamma(a).*gamma(b))).*delta;
252    <span class="keyword">return</span>
253 
254    
255     
256 
257   
258 
259 
260</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>