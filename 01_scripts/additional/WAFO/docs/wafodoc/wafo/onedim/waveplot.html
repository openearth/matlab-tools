<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of waveplot</title>
  <meta name="keywords" content="waveplot">
  <meta name="description" content=" Plots the surface elevation of timeseries.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">onedim</a> &gt; waveplot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\onedim&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>waveplot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Plots the surface elevation of timeseries.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Nf1 = waveplot(x,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="waveplot.html" class="code" title=" Plots the surface elevation of timeseries.">WAVEPLOT</a> Plots the surface elevation of timeseries.
 
  CALL:  <a href="waveplot.html" class="code" title=" Plots the surface elevation of timeseries.">waveplot</a>(x1,x2,Nsub,Nf,Sm0,v_fact,sym1,sym2)
 
      x1, x2 = two-column timeseries 
               first column sampling times [sec]
               second column surface elevation [m]
               x2 is by default zero-separated troughs and crests.
        Nsub = Number of subplots in each figure. By default 
               Nsub is such that there are about 20 mean down 
               crossing waves in each subplot. If Nf is not 
               given and Nsub is larger than 6 then Nsub is           
               changed to Nsub=min(6,ceil(Nsub/Nf))
         Nf  = Number of figures. By default Nf=ceil(Nsub/6). 
        Sm0  = standard deviation of x1. 
      v_fact = how large in stdev the vertical scale should be (default 3)
  sym1, sym2 = plot symbol and color for x1 and x2, respectively 
               (see PLOT)  (default 'k.' and 'k+') 
 
   Note: - sym1 and sym2 can be given anywhere after x1.
           if omitted default values are used.
         - x2 can  be omitted, but if given it must appear 
           before the scalars Nsub,Nf,Sm0 and v_fact. 
         - if [] is given for any of the scalars default values are used.
 
  Example: Plot x1 with red lines and mark troughs and crests with 
  blue circles.
    x = load('sea.dat');
    x1 = x(1:50,:);
    <a href="waveplot.html" class="code" title=" Plots the surface elevation of timeseries.">waveplot</a>(x1,'r-','bo')
 
  See also  <a href="dat2tc.html" class="code" title=" Extracts troughs and crests from data.">dat2tc</a>, plot</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="dat2tc.html" class="code" title=" [tc, ind, l_ind]=dat2tc(x,v,wdef)">dat2tc</a></li></TD>
<TD> Extracts troughs and crests from data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/misc/figtext.html" class="code" title=" H = figtext(x,y,T,x_unit,y_unit,x_justify,y_justify,varargin)">figtext</a></li></TD>
<TD> Places text in figure window.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\axis.m">axis</a></li></TD>
<TD>          Control axis scaling and appearance.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\figure.m">figure</a></li></TD>
<TD>        Create figure window.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\gca.m">gca</a></li></TD>
<TD>           Get handle to current axis.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\gcf.m">gcf</a></li></TD>
<TD>           Get handle to current figure.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\hold.m">hold</a></li></TD>
<TD>          Hold current graph.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\ischar.m">ischar</a></li></TD>
<TD>        True for character array (string).</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\ishold.m">ishold</a></li></TD>
<TD>        Return hold state.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\num2str.m">num2str</a></li></TD>
<TD>       Convert number to string. (Fast version)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\ident\ident\@iddata\plot.m">plot</a></li></TD>
<TD>          Linear plot.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="set is a built-in method">set</a></li></TD>
<TD>           Set object properties.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\std.m">std</a></li></TD>
<TD>           Standard deviation.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\subplot.m">subplot</a></li></TD>
<TD>       Create axes in tiled positions.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\title.m">title</a></li></TD>
<TD>         Graph title.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\xlabel.m">xlabel</a></li></TD>
<TD>        X-axis label.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\ylabel.m">ylabel</a></li></TD>
<TD>        Y-axis label.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter1.html" class="code" title="This is a script file.">Chapter1</a></li></TD>
<TD> % CHAPTER1 demonstrates some applications of WAFO</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter2.html" class="code" title="This is a script file.">Chapter2</a></li></TD>
<TD> % CHAPTER2 Modelling random loads and stochastic waves</TD>
</TR>
<TR>
<TD><li><a href="findoutliers.html" class="code" title=" [ind, indg]=findoutliers(xx,zcrit,dcrit,ddcrit,plotflag)">findoutliers</a></li></TD>
<TD> Finds the indices to spurious points in a timeseries</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/rec/recfig3.html" class="code" title=" recfig3">recfig3</a></li></TD>
<TD> Example of the reconstructed (solid) and original data set (pluses)</TD>
</TR>
<TR>
<TD><li><a href="reconstruct.html" class="code" title=" [y,g,g2,test,tobs,mu1o, mu1oStd]=reconstruct(x,inds,Nsim,L,def,varargin)">reconstruct</a></li></TD>
<TD> reconstruct the spurious/missing points of timeseries</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/wafodemo/wafofig1.html" class="code" title=" wafofig1">wafofig1</a></li></TD>
<TD>  Linear simulation from a Torsethaugen spectrum.</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code"> [x2,Nsub,Nf,Sm0,sym1,sym2, vfact] = wavechk(P,x1)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> Nf1 = <a name="_sub0" href="#_subfunctions" class="code">waveplot</a>(x,varargin)
002 <span class="comment">%WAVEPLOT Plots the surface elevation of timeseries.</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:  waveplot(x1,x2,Nsub,Nf,Sm0,v_fact,sym1,sym2)</span>
005 <span class="comment">%</span>
006 <span class="comment">%     x1, x2 = two-column timeseries </span>
007 <span class="comment">%              first column sampling times [sec]</span>
008 <span class="comment">%              second column surface elevation [m]</span>
009 <span class="comment">%              x2 is by default zero-separated troughs and crests.</span>
010 <span class="comment">%       Nsub = Number of subplots in each figure. By default </span>
011 <span class="comment">%              Nsub is such that there are about 20 mean down </span>
012 <span class="comment">%              crossing waves in each subplot. If Nf is not </span>
013 <span class="comment">%              given and Nsub is larger than 6 then Nsub is           </span>
014 <span class="comment">%              changed to Nsub=min(6,ceil(Nsub/Nf))</span>
015 <span class="comment">%        Nf  = Number of figures. By default Nf=ceil(Nsub/6). </span>
016 <span class="comment">%       Sm0  = standard deviation of x1. </span>
017 <span class="comment">%     v_fact = how large in stdev the vertical scale should be (default 3)</span>
018 <span class="comment">% sym1, sym2 = plot symbol and color for x1 and x2, respectively </span>
019 <span class="comment">%              (see PLOT)  (default 'k.' and 'k+') </span>
020 <span class="comment">%</span>
021 <span class="comment">%  Note: - sym1 and sym2 can be given anywhere after x1.</span>
022 <span class="comment">%          if omitted default values are used.</span>
023 <span class="comment">%        - x2 can  be omitted, but if given it must appear </span>
024 <span class="comment">%          before the scalars Nsub,Nf,Sm0 and v_fact. </span>
025 <span class="comment">%        - if [] is given for any of the scalars default values are used.</span>
026 <span class="comment">%</span>
027 <span class="comment">% Example: Plot x1 with red lines and mark troughs and crests with </span>
028 <span class="comment">% blue circles.</span>
029 <span class="comment">%   x = load('sea.dat');</span>
030 <span class="comment">%   x1 = x(1:50,:);</span>
031 <span class="comment">%   waveplot(x1,'r-','bo')</span>
032 <span class="comment">%</span>
033 <span class="comment">% See also  dat2tc, plot</span>
034 
035 <span class="comment">%Tested on: Matlab 6.0, 5.3, 5.2, 5.1</span>
036 <span class="comment">% History:</span>
037 <span class="comment">% revised jr 02.04.2001</span>
038 <span class="comment">%  - added example, updated info.</span>
039 <span class="comment">% revised pab 11.10.2000</span>
040 <span class="comment">%  - bug fix: disabled subplot when Nsub=1 =&gt; may use waveplot to</span>
041 <span class="comment">%             overplot other figures </span>
042 <span class="comment">% revised pab 01.02.2000</span>
043 <span class="comment">%  - fixed a bug in hour scale</span>
044 <span class="comment">%  - temporarily disabled this function</span>
045 <span class="comment">% revised pab 03.12.1999</span>
046 <span class="comment">%  - changed input to varargin, removed Nw</span>
047 <span class="comment">%  - added hour and minute scale for horizontal axis i.e. dT</span>
048 <span class="comment">% last modified Per A. Brodtkorb 01.10.98 </span>
049 <span class="comment">%    to accept missing values NaN's</span>
050 <span class="comment">% revised pab 15.08.98</span>
051 <span class="comment">% </span>
052 xn=x;
053 
054 [n m]= size(xn);
055 <span class="keyword">if</span> n&lt;m
056  b=m;m=n;n=b; 
057  xn=xn';
058 <span class="keyword">end</span>
059 
060 <span class="keyword">if</span> n&lt;2, 
061   error(<span class="string">'The vector must have more than 2 elements!'</span>)
062 <span class="keyword">end</span>
063 
064 istime=1;
065 
066 <span class="keyword">switch</span> m
067  <span class="keyword">case</span> 1, xn=[ (1:n)' xn(:)];istime=0;
068  <span class="keyword">case</span> 2, <span class="comment">% dimension OK!</span>
069  <span class="keyword">otherwise</span>, error(<span class="string">'Wrong dimension of input! dim must be 2xN, 1xN, Nx2 or Nx1 '</span>)          
070 <span class="keyword">end</span>
071 
072 [TP1,Nsub,Nf,Sm0,sym1,sym2, v_fact] = <a href="#_sub1" class="code" title="sub  [x2,Nsub,Nf,Sm0,sym1,sym2, vfact] = wavechk(P,x1)">wavechk</a>(varargin,xn);
073 
074 Ns = floor(n/(Nf*Nsub));
075 ind = [1:Ns];
076 <span class="keyword">if</span> all(xn(:,2)&gt;=0)
077   v_scale = [0 2*Sm0]*v_fact;
078 <span class="keyword">else</span>
079    v_scale = [-Sm0 Sm0]*v_fact;
080 <span class="keyword">end</span>
081 <span class="keyword">if</span> istime
082   XlblTxt=<span class="string">'Time (sec) '</span>;dT=1;
083   <span class="keyword">if</span> 1, <span class="comment">% disable other scalings pab 01.02.2000</span>
084     <span class="keyword">if</span> abs(xn(ind(1),1)-xn(ind(Ns),1))&gt;18000, <span class="comment">% more than 5 hours</span>
085       dT=1/(60*60);
086       XlblTxt=<span class="string">'Time (hours) '</span>;
087     <span class="keyword">elseif</span> abs(xn(ind(1),1)-xn(ind(Ns),1))&gt;300,<span class="comment">% more than 5 minutes</span>
088       dT=1/60;
089       XlblTxt=<span class="string">'Time (minutes) '</span>;
090     <span class="keyword">end</span>
091   <span class="keyword">end</span>   
092 <span class="keyword">else</span>
093   dT=1;
094   XlblTxt=<span class="string">'Step '</span>;
095 <span class="keyword">end</span> 
096 
097 indmiss=isnan(xn(:,2)); <span class="comment">% indices to missing points</span>
098 <span class="keyword">if</span> max(abs(xn(~indmiss,2)))&gt;5*Sm0,
099     XlblTxt=[ XlblTxt <span class="string">'(Spurious data since max &gt; 5 std.)'</span>];
100 <span class="keyword">end</span>
101 start=gcf-1; <span class="comment">%  start at current figure</span>
102 hstate = ishold;
103 
104 <span class="keyword">for</span> iz=1:Nf
105   <span class="keyword">if</span> Nf&gt;1,figure(start+iz);<span class="keyword">end</span>
106   <span class="keyword">for</span> ix=1:Nsub,
107     <span class="keyword">if</span> Nsub&gt;1,subplot(Nsub,1,ix),<span class="keyword">end</span>
108     <span class="keyword">if</span> hstate, hold on; <span class="keyword">end</span>
109     h_scale=[xn(ind(1),1) xn(ind(Ns),1)]*dT;
110     plot(xn(ind,1)*dT,xn(ind,2:<span class="keyword">end</span>),sym1) , hold on
111     plot(TP1(:,1)*dT,TP1(:,2:<span class="keyword">end</span>),sym2) 
112     plot(h_scale,[0 0],<span class="string">'k'</span>)
113     axis([h_scale v_scale])
114   
115     <span class="keyword">for</span> iy=[-2 2],
116       plot(h_scale,iy*Sm0*[1 1],<span class="string">'--'</span>)
117       <span class="keyword">switch</span> sign(iy)
118       <span class="keyword">case</span> -1, sign1=<span class="string">'-'</span>;
119       <span class="keyword">case</span>  0, sign1=<span class="string">' '</span>;
120       <span class="keyword">case</span>  1, sign1=<span class="string">'+'</span>;
121       <span class="keyword">end</span>
122       <a href="../../wafo/misc/figtext.html" class="code" title=" Places text in figure window.">figtext</a>(0.99,iy*Sm0,[<span class="string">'- '</span> sign1 num2str(abs(iy)) ],<span class="string">'norm'</span>,<span class="string">'data'</span>)
123     
124     <span class="keyword">end</span>, hold off
125   
126     ind = ind + Ns; 
127   <span class="keyword">end</span>
128 
129   xlabel(XlblTxt)
130 
131   <span class="keyword">if</span> Nsub&gt;1,subplot(Nsub,1,1),<span class="keyword">end</span>
132 
133   title(<span class="string">'Surface elevation from mean water level (MWL).'</span>)
134 
135   <span class="keyword">if</span> Nsub&gt;1,subplot(Nsub,1,floor((Nsub+1)/2)),<span class="keyword">end</span>
136   <span class="keyword">if</span> (Sm0 &gt;1.1)|(Sm0&lt;0.9), <span class="comment">% surface elevation is probably not standardized </span>
137     ylabel(<span class="string">'Distance from MWL.(m)'</span>)
138   <span class="keyword">end</span>
139   set(gca,<span class="string">'DefaultTextRotation'</span>,90)
140   <a href="../../wafo/misc/figtext.html" class="code" title=" Places text in figure window.">figtext</a>(1.05,0,<span class="string">'Standard Deviation'</span>,<span class="string">'norm'</span>,<span class="string">'data'</span>,<span class="string">'center'</span>)
141   set(gca,<span class="string">'DefaultTextRotation'</span>,0)
142   
143 <span class="keyword">end</span>
144 
145 <span class="keyword">if</span> nargout&gt;0,
146   Nf1=Nf
147 <span class="keyword">end</span>
148 
149 <span class="comment">%subplot(111)</span>
150 <span class="keyword">return</span>
151 
152 
153 <span class="keyword">function</span> [x2,Nsub,Nf,Sm0,sym1,sym2, vfact] = <a name="_sub1" href="#_subfunctions" class="code">wavechk</a>(P,x1)
154 <span class="comment">%WAVECHK Helper function for waveplot.</span>
155 <span class="comment">%</span>
156 <span class="comment">% CALL  [x2, Nsub,Nf,Sm0,sym1,sym2, vfact]=wavechk(P,x1) </span>
157 <span class="comment">%</span>
158 <span class="comment">%   P = the cell array P of input arguments (between 0 and 7 elements)</span>
159 <span class="comment">%  x1 = must be a two column vector.</span>
160 
161 
162 Nw=20;
163 Np=length(P);
164 strix=zeros(1,Np);
165 <span class="keyword">for</span> ix=1:Np, <span class="comment">% finding symbol strings </span>
166  strix(ix)=ischar(P{ix});
167 <span class="keyword">end</span>
168 sym1=<span class="string">'k.'</span>; <span class="comment">% Black dots is default</span>
169 sym2=<span class="string">'k+'</span>; <span class="comment">% Black plus is default</span>
170 k=find(strix);
171 <span class="keyword">if</span> any(k)
172   sym1=P{k(1)};
173   Np=Np-1;
174   <span class="keyword">if</span> length(k)&gt;1
175     sym2=P{k(2)};
176     Np=Np-1;
177   <span class="keyword">end</span>
178 <span class="keyword">end</span>
179 
180 P={P{find(~strix)}};
181 
182 indmiss=isnan(x1(:,2)); <span class="comment">% indices to missing points</span>
183 <span class="keyword">if</span> (Np&gt;0) &amp; (prod(size(P{1}))&gt;1)
184   x2=P{1};
185   P={P{2:Np}};
186   Np=Np-1;
187 <span class="keyword">else</span>
188   x2=<a href="dat2tc.html" class="code" title=" Extracts troughs and crests from data.">dat2tc</a>(x1(~indmiss,:),0,<span class="string">'tw'</span>); <span class="comment">% Finding mean separated turning points </span>
189   <span class="comment">%TP1=data2tp(xn,0.2,'mw'); <span class="comment">% Finding rf waves</span></span>
190   <span class="comment">%TP1=dat2tp(xn,0.2);</span>
191 <span class="keyword">end</span>
192 
193 <span class="keyword">if</span> (Np &gt;= 1) &amp; ~isempty(P{1})
194 <span class="comment">% waveplot(x1,x2,Nsub)</span>
195   Nsub=P{1};
196 <span class="keyword">else</span>
197   Nsub=floor(length(x2)/(2*Nw))+1; <span class="comment">% about Nw mdc waves in each plot</span>
198 <span class="keyword">end</span>
199 
200 <span class="keyword">if</span> (Np &gt;= 2) &amp; ~isempty(P{2})
201   <span class="comment">% waveplot(x1,x2,Nsub,Nf)</span>
202   Nf=P{2};
203 <span class="keyword">else</span>
204   Nf=ceil(Nsub/6); 
205   Nsub=min(6,ceil(Nsub/Nf));
206 <span class="keyword">end</span>
207 <span class="keyword">if</span> (Np &gt;= 3) &amp; ~isempty(P{3})
208   <span class="comment">% waveplot(x1,x2,Nsub,Nf,Sm0)</span>
209   Sm0=P{3};
210 <span class="keyword">else</span>
211   Sm0=std(x1(~indmiss,2));
212 <span class="keyword">end</span>
213 <span class="keyword">if</span> (Np &gt;= 4) &amp; ~isempty(P{4})
214    <span class="comment">% waveplot(x1,x2,Nsub,Nf,Sm0,v_fact)</span>
215  vfact=P{4};
216 <span class="keyword">else</span>
217   vfact=3; <span class="comment">% 3 std default</span>
218 <span class="keyword">end</span>
219</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>