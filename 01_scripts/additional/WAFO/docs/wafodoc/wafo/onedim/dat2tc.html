<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of dat2tc</title>
  <meta name="keywords" content="dat2tc">
  <meta name="description" content=" Extracts troughs and crests from data.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">onedim</a> &gt; dat2tc.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\onedim&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>dat2tc
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Extracts troughs and crests from data.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [tc, ind, l_ind]=dat2tc(x,v,wdef) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="dat2tc.html" class="code" title=" Extracts troughs and crests from data.">DAT2TC</a> Extracts troughs and crests from data.
 
  CALL:  [TC, tc_ind, v_ind] = <a href="dat2tc.html" class="code" title=" Extracts troughs and crests from data.">dat2tc</a>(x,v,wdef);
 
       TC     = a two-column matrix with the trough and crest turning
                 points, times in first column, values in second.
 
       tc_ind = indices to the trough and crest turningpoints 
         of the original sequence x.
 
       v_ind  = indices to the level v crossings of the original 
         sequence x. (d,u)
 
         x    = the surface elevation.
 
         v    = the reference level (default  v = mean of  x).
 
     wdef   = defines the type of wave. Possible options are
         'dw', 'uw', 'tw', 'cw' or 'none'. Default is 'none'.
         If wdef='none' all troughs and crests will be returned,
         otherwise only the paired ones will be returned
         according to the wavedefinition.
          
  Example:
    x = load('sea.dat'); x1 = x(1:200,:);
    tc = <a href="dat2tc.html" class="code" title=" Extracts troughs and crests from data.">dat2tc</a>(x1,0,'dw');
    plot(x1(:,1),x1(:,2),tc(:,1),tc(:,2),'ro',x1(:,1),zeros(1,200),':')
  
  See also  <a href="dat2crossind.html" class="code" title=" Finds indices to level v down and/or upcrossings from data">dat2crossind</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="dat2crossind.html" class="code" title=" [ind , Nc]= dat2crossind(x,v,wdef)">dat2crossind</a></li></TD>
<TD> Finds indices to level v down and/or upcrossings from data</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\mean.m">mean</a></li></TD>
<TD>          Average or mean value.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\num2str.m">num2str</a></li></TD>
<TD>       Convert number to string. (Fast version)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter3.html" class="code" title="This is a script file.">Chapter3</a></li></TD>
<TD> % CHAPTER3  Demonstrates distributions of wave characteristics</TD>
</TR>
<TR>
<TD><li><a href="dat2steep.html" class="code" title=" [S , H,AC1,AT1,TFRONT1,TREAR1,z_ind2,xn2]=dat2steep(xx,rate,method)">dat2steep</a></li></TD>
<TD> Extracts waveheights and steepnesses from data.</TD>
</TR>
<TR>
<TD><li><a href="dat2wa.html" class="code" title=" [T, index,ind] = dat2wa(xn,h,pdef,wdef,rate)">dat2wa</a></li></TD>
<TD> Extracts sequence of wavelengths from data.</TD>
</TR>
<TR>
<TD><li><a href="spwaveplot.html" class="code" title=" spwaveplot(xx,varargin)">spwaveplot</a></li></TD>
<TD> Plots specified waves from a timeseries</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/wafodemo/wafofig10.html" class="code" title=" wafofig10">wafofig10</a></li></TD>
<TD> Intensity of trough-crest cycles computed from  St</TD>
</TR>
<TR>
<TD><li><a href="waveplot.html" class="code" title=" Nf1 = waveplot(x,varargin)">waveplot</a></li></TD>
<TD> Plots the surface elevation of timeseries.</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [tc, ind, l_ind]=<a name="_sub0" href="#_subfunctions" class="code">dat2tc</a>(x,v,wdef)
002 <span class="comment">%DAT2TC Extracts troughs and crests from data.</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:  [TC, tc_ind, v_ind] = dat2tc(x,v,wdef);</span>
005 <span class="comment">%</span>
006 <span class="comment">%      TC     = a two-column matrix with the trough and crest turning</span>
007 <span class="comment">%                points, times in first column, values in second.</span>
008 <span class="comment">%</span>
009 <span class="comment">%      tc_ind = indices to the trough and crest turningpoints </span>
010 <span class="comment">%        of the original sequence x.</span>
011 <span class="comment">%</span>
012 <span class="comment">%      v_ind  = indices to the level v crossings of the original </span>
013 <span class="comment">%        sequence x. (d,u)</span>
014 <span class="comment">%</span>
015 <span class="comment">%        x    = the surface elevation.</span>
016 <span class="comment">%</span>
017 <span class="comment">%        v    = the reference level (default  v = mean of  x).</span>
018 <span class="comment">%</span>
019 <span class="comment">%    wdef   = defines the type of wave. Possible options are</span>
020 <span class="comment">%        'dw', 'uw', 'tw', 'cw' or 'none'. Default is 'none'.</span>
021 <span class="comment">%        If wdef='none' all troughs and crests will be returned,</span>
022 <span class="comment">%        otherwise only the paired ones will be returned</span>
023 <span class="comment">%        according to the wavedefinition.</span>
024 <span class="comment">%         </span>
025 <span class="comment">% Example:</span>
026 <span class="comment">%   x = load('sea.dat'); x1 = x(1:200,:);</span>
027 <span class="comment">%   tc = dat2tc(x1,0,'dw');</span>
028 <span class="comment">%   plot(x1(:,1),x1(:,2),tc(:,1),tc(:,2),'ro',x1(:,1),zeros(1,200),':')</span>
029 <span class="comment">% </span>
030 <span class="comment">% See also  dat2crossind</span>
031 
032 <span class="comment">% Tested on: Matlab 6.0, 5.3, 5.2, 5.1</span>
033 <span class="comment">%</span>
034 <span class="comment">% History: </span>
035 <span class="comment">% revised pab Feb2004  </span>
036 <span class="comment">% Revised by jr 02.04.2001</span>
037 <span class="comment">% - Added example, updated info. </span>
038 <span class="comment">% Modified by Per A Brodtkorb 27.07.98</span>
039 <span class="comment">% Modified version of the old tp2tc routine which is significantly faster </span>
040 <span class="comment">% if you use it to extract trough and crest turningpoints from the surface </span>
041 <span class="comment">% elevation. If you use it to extract trough and crest turningpoints from a </span>
042 <span class="comment">% sequence of turningpoints the gain in computational time is smaller. </span>
043 <span class="comment">%</span>
044 <span class="comment">% However, this new version is more flexible. It is able to return the </span>
045 <span class="comment">% indices to all the trough and crest turningpoints and </span>
046 <span class="comment">% level v - crossings of the original sequence x or just those </span>
047 <span class="comment">% turningpoints and crossings according to the wave definition. </span>
048 <span class="comment">% (This is useful in a zero down cross analysis). </span>
049 
050 
051 error(nargchk(1,3,nargin))
052 
053 xn = x;
054 [n m]= size(xn);
055 <span class="keyword">if</span> n&lt;m
056  b=m;m=n;n=b; 
057  xn=xn';
058 <span class="keyword">end</span>
059 
060 <span class="keyword">if</span> n&lt;2, 
061   error(<span class="string">'The vector must have more than 2 elements!'</span>)
062 <span class="keyword">end</span>
063 
064 istime=1;
065 
066 <span class="keyword">switch</span> m
067  <span class="keyword">case</span> 1, xn=[ (1:n)' xn(:)];istime=0;
068  <span class="keyword">case</span> 2, <span class="comment">% dimension OK!</span>
069  <span class="keyword">otherwise</span>, error(<span class="string">'Wrong dimension of input! dim must be 2xN, 1xN, Nx2 or Nx1 '</span>)          
070 <span class="keyword">end</span>
071 
072 <span class="keyword">if</span> ((nargin&lt;3) | isempty(wdef)),
073   wdef=<span class="string">'none'</span>;
074 <span class="keyword">end</span>
075 
076 <span class="keyword">if</span> ((nargin&lt;2) | isempty(v)),
077   v=mean(xn(:,2));
078   disp([<span class="string">'   The level v is set to: '</span>, num2str(v)])
079 <span class="keyword">end</span>
080 
081 n = length(xn);
082 
083 <span class="comment">% find level v down-crossings and up-crossings</span>
084 <span class="comment">% according to wavedefinition and number of level l crossings</span>
085 [l_ind Nc] = <a href="dat2crossind.html" class="code" title=" Finds indices to level v down and/or upcrossings from data">dat2crossind</a>(xn,v,wdef);
086 
087 <span class="keyword">if</span> Nc&lt;=2, 
088   disp(<span class="string">'Warning: There are no waves!'</span>) 
089   disp(<span class="string">'         Empty matrix returned.'</span>)
090   tc=[];
091   <span class="keyword">return</span>
092 <span class="keyword">end</span>
093 
094 <span class="comment">% determine the number of trough2crest (or crest2trough) cycles</span>
095 <span class="keyword">if</span> mod(Nc,2),
096   Ntc=(Nc-1)/2;     <span class="comment">% Nc is odd </span>
097 <span class="keyword">else</span>
098   Ntc=(Nc-2)/2;     <span class="comment">% Nc is even</span>
099 <span class="keyword">end</span>
100 
101 <span class="comment">% allocate variables before the loop increases the speed</span>
102 tc=zeros(Nc-1,2);
103 ind=tc(:,1);
104 
105 <span class="keyword">if</span> (xn(l_ind(1),2)&gt;xn(l_ind(1)+1,2)),<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">% the first is a down-crossing</span></span></span></span>
106   <span class="keyword">for</span> i=1:Ntc;, 
107     <span class="comment">% trough </span>
108     [tc(2*i-1,2) ind(2*i-1)]=min(xn((l_ind(2*i-1)+1):l_ind(2*i),2)); 
109     <span class="comment">% crest </span>
110     [tc(2*i,2) ind(2*i)]=max(xn((l_ind(2*i)+1):l_ind(2*i+1),2)); 
111   <span class="keyword">end</span>  <span class="comment">% for i=1:Ntc loop</span>
112   
113   <span class="keyword">if</span> (2*Ntc+1&lt;Nc)&amp;(strcmp(wdef,<span class="string">'none'</span>)|strcmp(wdef,<span class="string">'tw'</span>)), 
114     <span class="comment">% trough </span>
115     [tc(Nc-1,2) ind(Nc-1)]=min(xn((l_ind(Nc-1)+1):l_ind(Nc),2));
116   <span class="keyword">end</span>
117 <span class="keyword">else</span> <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">% the first is a up-crossing</span></span></span></span>
118   <span class="keyword">for</span> i=1:Ntc;, 
119     <span class="comment">% crest </span>
120     [tc(2*i-1,2) ind(2*i-1)]=max(xn((l_ind(2*i-1)+1):l_ind(2*i),2)); 
121     <span class="comment">% trough </span>
122     [tc(2*i,2) ind(2*i)]=min(xn((l_ind(2*i)+1):l_ind(2*i+1),2)); 
123   <span class="keyword">end</span>  <span class="comment">% for i=1:Ntc loop</span>
124   
125   <span class="keyword">if</span> (2*Ntc+1&lt;Nc)&amp;(strcmp(wdef,<span class="string">'none'</span>)|strcmp(wdef,<span class="string">'cw'</span>)), 
126     <span class="comment">% crest </span>
127     [tc(Nc-1,2) ind(Nc-1)]=max(xn((l_ind(Nc-1)+1):l_ind(Nc),2));
128   <span class="keyword">end</span>
129 <span class="keyword">end</span>
130                     
131 
132 ind=l_ind(1:(Nc-1))+ind;
133 tc(:,1)=xn(ind,1);
134 
135 <span class="comment">%if (l_ind(Nc)+ind(Nc-1)&lt;=n)&amp;(wdef=='none'),</span>
136 <span class="comment">%    [tc(Nc,2) ind(Nc)]=max(xn((l_ind(Nc)+1):n,2)); <span class="comment">% local max; probably </span></span>
137 <span class="comment">%                                                    <span class="comment">% a crest</span></span>
138 <span class="comment">%end</span>
139 
140 
141 
142 
143 
144 
145</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>