<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of dat2cov</title>
  <meta name="keywords" content="dat2cov">
  <meta name="description" content=" Estimate auto covariance function from data.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">onedim</a> &gt; dat2cov.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\onedim&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>dat2cov
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Estimate auto covariance function from data.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> R = dat2cov(xn,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="dat2cov.html" class="code" title=" Estimate auto covariance function from data.">DAT2COV</a> Estimate auto covariance function from data.
 
  CALL:  R = <a href="dat2cov.html" class="code" title=" Estimate auto covariance function from data.">dat2cov</a>(x,L,plotflag,dT,flag)
 
          R = a structure containing:
                  R = ACF vector length L+1  
                  t = time lags  length L+1  
              stdev = estimated large lag standard deviation of the estimate
                      assuming x is a Gaussian process:
                      if R(k)=0 for all lags k&gt;q then an approximation 
                      of the variance for large samples due to Bartlett
                      <a href="../../wafo/wstats/var.html" class="code" title="  Variance ">var</a>(R(k))=1/N*(R(0)^2+2*R(1)^2+2*R(2)^2+ ..+2*R(q)^2)
                      for  k&gt;q and where  N=length(x). Special case is
                      white noise where it equals R(0)^2/N for k&gt;0
                  h = water depth (default inf)
                 tr = [], transformation 
               type = 'none'
               norm = 0 indicating that R is not normalized
 
         x  = a column data vector or
              two column data matrix with sampled times and values.
         L  = the maximum time-lag for which the ACF is estimated.
                (Default L=n-1)        
  plotflag = 1 then the ACF is plotted vs lag
             2 then the ACF is plotted vs lag in seconds
             3 then the ACF is plotted vs lag and vs lag (sec
        dT = time-step between data points (default xn(2,1)-xn(1,1) or 1 Hz).
      flag = 'biased'  : scales the raw cross-correlation by 1/n. (default)
             'unbiased': scales the raw correlation by 1/(n-abs(k)), 
                         where k is the index into the result.
 
  Note:  - flag may be given anywhere after x.
         - x may contain NaN's  (i.e. missing values).
 
  Example: 
    x = load('sea.dat');
    rf = <a href="dat2cov.html" class="code" title=" Estimate auto covariance function from data.">dat2cov</a>(x,150,2)
 
  See also  <a href="dat2cor.html" class="code" title=" Estimate auto correlation function from data.">dat2cor</a>, <a href="covplot.html" class="code" title=" Plots the auto covariance function (ACF) 1D or 2D. ">covplot</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="covplot.html" class="code" title=" covplot(rn,L,plotflag,lintype)">covplot</a></li></TD>
<TD> Plots the auto covariance function (ACF) 1D or 2D.</TD>
</TR>
<TR>
<TD><li><a href="dat2cor.html" class="code" title=" [corr,c0] = dat2cor(xn,varargin)">dat2cor</a></li></TD>
<TD> Estimate auto correlation function from data.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\ischar.m">ischar</a></li></TD>
<TD>        True for character array (string).</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter2.html" class="code" title="This is a script file.">Chapter2</a></li></TD>
<TD> % CHAPTER2 Modelling random loads and stochastic waves</TD>
</TR>
<TR>
<TD><li><a href="dat2spec.html" class="code" title=" [S,fcut] = dat2spec(xn,varargin)">dat2spec</a></li></TD>
<TD> Estimate one-sided spectral density from data.</TD>
</TR>
<TR>
<TD><li><a href="dat2spec2.html" class="code" title=" S = dat2spec2(xn,L,g,plotflag,wdef,dT,chopOffHighFreq)">dat2spec2</a></li></TD>
<TD> Estimate one-sided spectral density, version 2.</TD>
</TR>
<TR>
<TD><li><a href="reconstruct.html" class="code" title=" [y,g,g2,test,tobs,mu1o, mu1oStd]=reconstruct(x,inds,Nsim,L,def,varargin)">reconstruct</a></li></TD>
<TD> reconstruct the spurious/missing points of timeseries</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code"> [x,L,plotflag,dT,flag,n] = dat2corchk(P,xn,Na)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> R = <a name="_sub0" href="#_subfunctions" class="code">dat2cov</a>(xn,varargin)
002 <span class="comment">%DAT2COV Estimate auto covariance function from data.</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:  R = dat2cov(x,L,plotflag,dT,flag)</span>
005 <span class="comment">%</span>
006 <span class="comment">%         R = a structure containing:</span>
007 <span class="comment">%                 R = ACF vector length L+1  </span>
008 <span class="comment">%                 t = time lags  length L+1  </span>
009 <span class="comment">%             stdev = estimated large lag standard deviation of the estimate</span>
010 <span class="comment">%                     assuming x is a Gaussian process:</span>
011 <span class="comment">%                     if R(k)=0 for all lags k&gt;q then an approximation </span>
012 <span class="comment">%                     of the variance for large samples due to Bartlett</span>
013 <span class="comment">%                     var(R(k))=1/N*(R(0)^2+2*R(1)^2+2*R(2)^2+ ..+2*R(q)^2)</span>
014 <span class="comment">%                     for  k&gt;q and where  N=length(x). Special case is</span>
015 <span class="comment">%                     white noise where it equals R(0)^2/N for k&gt;0</span>
016 <span class="comment">%                 h = water depth (default inf)</span>
017 <span class="comment">%                tr = [], transformation </span>
018 <span class="comment">%              type = 'none'</span>
019 <span class="comment">%              norm = 0 indicating that R is not normalized</span>
020 <span class="comment">%</span>
021 <span class="comment">%        x  = a column data vector or</span>
022 <span class="comment">%             two column data matrix with sampled times and values.</span>
023 <span class="comment">%        L  = the maximum time-lag for which the ACF is estimated.</span>
024 <span class="comment">%               (Default L=n-1)        </span>
025 <span class="comment">% plotflag = 1 then the ACF is plotted vs lag</span>
026 <span class="comment">%            2 then the ACF is plotted vs lag in seconds</span>
027 <span class="comment">%            3 then the ACF is plotted vs lag and vs lag (sec</span>
028 <span class="comment">%       dT = time-step between data points (default xn(2,1)-xn(1,1) or 1 Hz).</span>
029 <span class="comment">%     flag = 'biased'  : scales the raw cross-correlation by 1/n. (default)</span>
030 <span class="comment">%            'unbiased': scales the raw correlation by 1/(n-abs(k)), </span>
031 <span class="comment">%                        where k is the index into the result.</span>
032 <span class="comment">%</span>
033 <span class="comment">% Note:  - flag may be given anywhere after x.</span>
034 <span class="comment">%        - x may contain NaN's  (i.e. missing values).</span>
035 <span class="comment">%</span>
036 <span class="comment">% Example: </span>
037 <span class="comment">%   x = load('sea.dat');</span>
038 <span class="comment">%   rf = dat2cov(x,150,2)</span>
039 <span class="comment">%</span>
040 <span class="comment">% See also  dat2cor, covplot</span>
041 
042 <span class="comment">%(If you have got the signal toolbox you may modify the dat2cor file)<span class="comment">%--------</span></span>
043 
044 <span class="comment">% Tested on: Matlab 6.0, 5.3, 5.2, 5.1</span>
045 <span class="comment">% History:</span>
046 <span class="comment">% revised jr 02.04.2001</span>
047 <span class="comment">%  - added example, updating help </span>
048 <span class="comment">% revised pab 09.10.2000</span>
049 <span class="comment">%  - added dat2corchk</span>
050 <span class="comment">%  - updated documentation</span>
051 <span class="comment">%  - added flag option</span>
052 <span class="comment">% revised pab 12.08.99</span>
053 <span class="comment">%  - updated to handle covariance class/structure</span>
054 <span class="comment">% modified by Per A. Brodtkorb 28.10.98 </span>
055 <span class="comment">%  removed some code and replaced it wih a call to dat2cor</span>
056 
057 
058 [x,L,plotflag,dT,flag,n] = <a href="#_sub1" class="code" title="sub  [x,L,plotflag,dT,flag,n] = dat2corchk(P,xn,Na)">dat2corchk</a>(varargin,xn,nargout);
059 
060  
061 <span class="comment">% ind     = find(~isnan(x));</span>
062 <span class="comment">%n0      = length(ind);</span>
063 <span class="comment">%c0      = (n0-1)/n0*(std(x(ind)).^2);<span class="comment">% allowing missing data</span></span>
064 [R, c0] = <a href="dat2cor.html" class="code" title=" Estimate auto correlation function from data.">dat2cor</a>(x,L,0,dT,flag);
065 R.R     = R.R*c0;
066 R.stdev = R.stdev*c0;
067 R.norm  = 0;
068 
069 <span class="keyword">if</span> ((plotflag&gt;0) ),
070   <a href="covplot.html" class="code" title=" Plots the auto covariance function (ACF) 1D or 2D. ">covplot</a>(R,L,plotflag)
071 <span class="keyword">end</span>
072 
073 
074 <span class="keyword">function</span> [x,L,plotflag,dT,flag,n] = <a name="_sub1" href="#_subfunctions" class="code">dat2corchk</a>(P,xn,Na)
075 <span class="comment">% DAT2CORCHK Helper function for dat2cor.</span>
076 <span class="comment">%</span>
077 <span class="comment">% CALL  [x2,L,plotflag,dT,flag,n]=dat2corchk(P,x1) </span>
078 <span class="comment">%</span>
079 <span class="comment">%   P = the cell array P of input arguments (between 0 and 7 elements)</span>
080 <span class="comment">%   x = a vector.</span>
081 
082 
083 x=xn;
084 [n m]= size(x);
085 
086 <span class="keyword">if</span> n&lt;m
087  b=m;m=n;n=b; 
088  x=x';
089 <span class="keyword">end</span>
090 
091 <span class="keyword">if</span> n&lt;2, 
092   error(<span class="string">'The vector must have more than 2 elements!'</span>)
093 <span class="keyword">end</span>
094 
095 <span class="comment">% Default values</span>
096 <span class="comment">%~~~~~~~~~~~~~~~~  </span>
097 flag = <span class="string">'biased'</span>;
098 plotflag = 0;
099 dT=[]; <span class="comment">% sampling frequency unknown</span>
100 L=n-1;
101    <span class="comment">% if n&lt;400</span>
102 <span class="comment">%    L=floor(n/2);</span>
103 <span class="comment">%  else</span>
104 <span class="comment">%    L=floor(12*sqrt(n));</span>
105 <span class="comment">%  end</span>
106 
107 
108 
109 
110 Np=length(P);
111 strix=zeros(1,Np);
112 <span class="keyword">for</span> ix=1:Np, <span class="comment">% finding symbol strings </span>
113  strix(ix)=ischar(P{ix});
114 <span class="keyword">end</span>
115 
116 
117 k=find(strix);
118 <span class="keyword">if</span> any(k)
119   flag = P{k(1)};
120   Np   = Np-1;
121   P={P{find(~strix)}};
122 <span class="keyword">end</span>
123 
124 <span class="keyword">if</span> Np&gt;0 &amp; ~isempty(P{1}), L=P{1}; <span class="keyword">end</span>
125 <span class="keyword">if</span> Np&gt;1 &amp; ~isempty(P{2}), plotflag=P{2}; <span class="keyword">end</span>
126 <span class="keyword">if</span> Np&gt;2 &amp; ~isempty(P{3}), dT=P{3}; <span class="keyword">end</span>
127 
128 <span class="keyword">if</span> (Na == 0)&amp;plotflag==0
129   plotflag=3;
130 <span class="keyword">end</span>
131 <span class="keyword">if</span> plotflag&gt;3, 
132   error(<span class="string">'Invalid option. Plotflag can only be 0,1,2 or 3'</span>)
133 <span class="keyword">end</span>
134  <span class="keyword">switch</span> m
135  <span class="keyword">case</span> 1, x=x(:); <span class="keyword">if</span> isempty(dT),dT=1;<span class="keyword">end</span>
136  <span class="keyword">case</span> 2,  dT=x(2,1)-x(1,1);x=x(:,2);
137  <span class="keyword">otherwise</span>, error(<span class="string">'Wrong dimension of input! dim must be 2xN, 1xN, Nx2 or Nx1 '</span>) 
138               
139 <span class="keyword">end</span>
140 <span class="keyword">return</span>
141</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>