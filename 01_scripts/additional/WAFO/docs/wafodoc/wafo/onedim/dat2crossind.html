<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of dat2crossind</title>
  <meta name="keywords" content="dat2crossind">
  <meta name="description" content=" Finds indices to level v down and/or upcrossings from data">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">onedim</a> &gt; dat2crossind.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\onedim&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>dat2crossind
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Finds indices to level v down and/or upcrossings from data</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [ind , Nc]= dat2crossind(x,v,wdef) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="dat2crossind.html" class="code" title=" Finds indices to level v down and/or upcrossings from data">DAT2CROSSIND</a> Finds indices to level v down and/or upcrossings from data
 
   CALL:  [ind, Nc]= <a href="dat2crossind.html" class="code" title=" Finds indices to level v down and/or upcrossings from data">dat2crossind</a>(x,v,wdef/cdef);
 
  ind  = indices to the level v crossings of the original sequence x.
  Nc   = number of crossings (i.e.length of ind). 
   x   = the surface elevation data.
   v   = the reference level (default  v = mean of  x).
  wdef = defines the type of wave. Possible options are
         'dw', 'uw', 'cw', 'tw' or 'none'. (Default 'none').
         If wdef='none' all crossings will be returned,
         otherwise only the crossings which defines a 
         wave according to the wave definition will be returned.
  cdef = defines the type crossings returned. Possible options are
         'd' 'u' or 'all'. (Default 'all').
         If def='d' all down-crossings will be returned.
         Similarly if def='u' only the up-crossings will be returned
         otherwise 'all' the crossings will be returned.
 
  Example: 
    t = linspace(0,7*pi,250); 
    x = sin(t);
    [ind, Nc] = <a href="dat2crossind.html" class="code" title=" Finds indices to level v down and/or upcrossings from data">dat2crossind</a>(x,0.75,'u')
    plot(t,x,'.',t(ind),x(ind),'o')  
 
  See also  <a href="findcross.html" class="code" title=" Finds indices to level v up and downcrossings of a vector">findcross</a>, <a href="../../wafo/docs/wavedef.html" class="code" title=" Wave definitions and nomenclature ">wavedef</a>, <a href="../../wafo/docs/crossdef.html" class="code" title=" level v crossing definitions and nomenclature ">crossdef</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="findcross.html" class="code" title=" ind=findcross(x,v)">findcross</a></li></TD>
<TD> Finds indices to level v up and downcrossings of a vector</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\mean.m">mean</a></li></TD>
<TD>          Average or mean value.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\num2str.m">num2str</a></li></TD>
<TD>       Convert number to string. (Fast version)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\sprintf.m">sprintf</a></li></TD>
<TD>       Write formatted data to string.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\warning.m">warning</a></li></TD>
<TD>       Display warning message; disable or enable warning messages.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\ops\@double\xor.bi">xor</a></li></TD>
<TD>           Logical EXCLUSIVE OR.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="dat2tc.html" class="code" title=" [tc, ind, l_ind]=dat2tc(x,v,wdef)">dat2tc</a></li></TD>
<TD> Extracts troughs and crests from data.</TD>
</TR>
<TR>
<TD><li><a href="dat2wa.html" class="code" title=" [T, index,ind] = dat2wa(xn,h,pdef,wdef,rate)">dat2wa</a></li></TD>
<TD> Extracts sequence of wavelengths from data.</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [ind , Nc]= <a name="_sub0" href="#_subfunctions" class="code">dat2crossind</a>(x,v,wdef)
002 <span class="comment">%DAT2CROSSIND Finds indices to level v down and/or upcrossings from data</span>
003 <span class="comment">%</span>
004 <span class="comment">%  CALL:  [ind, Nc]= dat2crossind(x,v,wdef/cdef);</span>
005 <span class="comment">%</span>
006 <span class="comment">% ind  = indices to the level v crossings of the original sequence x.</span>
007 <span class="comment">% Nc   = number of crossings (i.e.length of ind). </span>
008 <span class="comment">%  x   = the surface elevation data.</span>
009 <span class="comment">%  v   = the reference level (default  v = mean of  x).</span>
010 <span class="comment">% wdef = defines the type of wave. Possible options are</span>
011 <span class="comment">%        'dw', 'uw', 'cw', 'tw' or 'none'. (Default 'none').</span>
012 <span class="comment">%        If wdef='none' all crossings will be returned,</span>
013 <span class="comment">%        otherwise only the crossings which defines a </span>
014 <span class="comment">%        wave according to the wave definition will be returned.</span>
015 <span class="comment">% cdef = defines the type crossings returned. Possible options are</span>
016 <span class="comment">%        'd' 'u' or 'all'. (Default 'all').</span>
017 <span class="comment">%        If def='d' all down-crossings will be returned.</span>
018 <span class="comment">%        Similarly if def='u' only the up-crossings will be returned</span>
019 <span class="comment">%        otherwise 'all' the crossings will be returned.</span>
020 <span class="comment">%</span>
021 <span class="comment">% Example: </span>
022 <span class="comment">%   t = linspace(0,7*pi,250); </span>
023 <span class="comment">%   x = sin(t);</span>
024 <span class="comment">%   [ind, Nc] = dat2crossind(x,0.75,'u')</span>
025 <span class="comment">%   plot(t,x,'.',t(ind),x(ind),'o')  </span>
026 <span class="comment">%</span>
027 <span class="comment">% See also  findcross, wavedef, crossdef</span>
028 
029 <span class="comment">%tested on: Matlab 6.0, 5.3, 5.2, 5.1</span>
030 <span class="comment">% History:</span>
031 <span class="comment">% revised pab Feb2004</span>
032 <span class="comment">% revised by pab 12.06.2001</span>
033 <span class="comment">%  -added check on ind returned from findcross.</span>
034 <span class="comment">% Revised by jr 02.04.2001</span>
035 <span class="comment">% - Added example, updated help </span>
036 <span class="comment">% By Per A. Brodtkorb 07.07.1998,  27.07.1998,  </span>
037 
038 error(nargchk(1,3,nargin))
039 xn=x;
040 
041 [n m]= size(xn);
042 <span class="keyword">if</span> n&lt;m
043  b=m;m=n;n=b; 
044  xn=xn';
045 <span class="keyword">end</span>
046 
047 <span class="keyword">if</span> n&lt;2, 
048   error(<span class="string">'The vector must have more than 2 elements!'</span>)
049 <span class="keyword">end</span>
050 
051 istime=1;
052 
053 <span class="keyword">switch</span> m
054  <span class="keyword">case</span> 1, istime=0;
055  <span class="keyword">case</span> 2, xn= xn(:,2);<span class="comment">% dimension OK!</span>
056  <span class="keyword">otherwise</span>, error(<span class="string">'Wrong dimension of input! dim must be 2xN, 1xN, Nx2 or Nx1 '</span>)          
057 <span class="keyword">end</span>
058 
059 <span class="keyword">if</span> ((nargin&lt;3) | isempty(wdef)),
060   wdef=<span class="string">'none'</span>;
061 <span class="keyword">end</span>
062 
063 <span class="keyword">if</span> ((nargin&lt;2) | isempty(v)),
064   v = mean(xn);
065   disp([<span class="string">'   The level v is set to: '</span>, num2str(v)])
066 <span class="keyword">end</span>
067 
068 
069 <span class="comment">% find level v down-crossings and/or up-crossings</span>
070 <span class="comment">% according to wdef or cdef</span>
071 ind = <a href="findcross.html" class="code" title=" Finds indices to level v up and downcrossings of a vector">findcross</a>(xn,v); <span class="comment">% faster than find</span>
072 
073 <span class="keyword">if</span> isempty(ind), <span class="comment">%added pab 12.06.2001</span>
074    Nc = 0; 
075    txt = sprintf(<span class="string">'No level v = %0.5g crossings found in x'</span>,v)   
076    warning(txt)
077    <span class="keyword">return</span>,
078 <span class="keyword">end</span>
079 
080 
081 <span class="keyword">switch</span> wdef   <span class="comment">% switch wdef/cdef    </span>
082   <span class="keyword">case</span> <span class="string">'d'</span>, <span class="comment">%downcrossings only</span>
083     <span class="keyword">if</span> xn(ind(1)+1)&gt;v,
084       ind =ind(2:2:<span class="keyword">end</span>);
085     <span class="keyword">else</span>
086       ind =ind(1:2:<span class="keyword">end</span>);
087     <span class="keyword">end</span>
088     
089  <span class="keyword">case</span> <span class="string">'u'</span>,<span class="comment">%upcrossings  only</span>
090    <span class="keyword">if</span> xn(ind(1)+1)&lt;v,
091       ind =ind(2:2:<span class="keyword">end</span>);
092     <span class="keyword">else</span>
093       ind =ind(1:2:<span class="keyword">end</span>);
094     <span class="keyword">end</span>
095     
096   <span class="keyword">case</span> {<span class="string">'dw'</span>,<span class="string">'uw'</span>},
097     <span class="comment">% make sure that the first is a level v down-crossing if wdef == 'dw'</span>
098     <span class="comment">% or make sure that the first is a level v up-crossing if wdef == 'uw'</span>
099 
100     <span class="keyword">if</span> xor(((xn(ind(1))&gt;xn(ind(1)+1))),strcmp(wdef,<span class="string">'dw'</span>)),
101       ind(1)=[];
102     <span class="keyword">end</span>
103     Nc=length(ind); <span class="comment">% number of level v crossings</span>
104     <span class="comment">% make sure the number of troughs and crests are according to the</span>
105     <span class="comment">% wavedef, i.e., make sure length(ind) is odd</span>
106     <span class="keyword">if</span> ~(mod(Nc,2)), <span class="comment">% if Nc is even do</span>
107       ind(<span class="keyword">end</span>)=[];
108     <span class="keyword">end</span>    
109   <span class="keyword">case</span> {<span class="string">'tw'</span>,<span class="string">'cw'</span>},
110     <span class="comment">% make sure that the first is a level v down-crossing if wdef == 'tw'</span>
111     <span class="comment">% or make sure that the first is a level v up-crossing if wdef == 'cw'</span>
112 
113     <span class="keyword">if</span> xor(((xn(ind(1))&gt;xn(ind(1)+1))),strcmp(wdef,<span class="string">'tw'</span>)),
114       ind(1)=[];
115     <span class="keyword">end</span>
116     Nc=length(ind); <span class="comment">% number of level v crossings</span>
117     <span class="comment">% make sure the number of troughs and crests are according to the</span>
118     <span class="comment">% wavedef, i.e., make sure length(ind) is even</span>
119     <span class="keyword">if</span> (mod(Nc,2)), <span class="comment">% if Nc is odd do</span>
120       ind(<span class="keyword">end</span>)=[];
121     <span class="keyword">end</span>    
122   <span class="keyword">case</span> {<span class="string">'du'</span>,<span class="string">'all'</span>,<span class="string">'none'</span>},
123     <span class="comment">% do nothing</span>
124  <span class="keyword">otherwise</span>,  error(<span class="string">'Unknown wave/crossing definition!'</span>)
125 <span class="keyword">end</span>
126 <span class="keyword">if</span> nargout&gt;1,
127   Nc=length(ind); <span class="comment">% number of level v crossings</span>
128 <span class="keyword">end</span>
129 
130 <span class="keyword">return</span>
131 
132 
133 
134</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>