<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of tran</title>
  <meta name="keywords" content="tran">
  <meta name="description" content=" Computes transfer functions based on linear wave theory">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">multidim</a> &gt; tran.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\multidim&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>tran
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Computes transfer functions based on linear wave theory</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [Hw, Gwt, kw,Hwt,ee]=tran(w,theta,pos,def,h,g,rho,bet,igam,thx,thy,kw); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="tran.html" class="code" title=" Computes transfer functions based on linear wave theory">TRAN</a> Computes transfer functions based on linear wave theory
      of the system with input surface elevation, 
      eta(x0,y0,t) = exp(i*(kx*x0+ky*y0-w*t)), 
      and output Y determined by type and pos. 
 
  CALL:  [Hw Gwt kw Hwt] = <a href="tran.html" class="code" title=" Computes transfer functions based on linear wave theory">tran</a>(w,theta,pos,type,h,g,rho,bet,igam,thx,thy,kw);
 
    Hwt = Hw(ones(Nt,1),:).*Gwt matrix of transfer functions values as function of 
          w (columns) and theta (rows)                   size Nt x Nf 
    Hw  = a function of frequency only (not direction)   size  1 x Nf
    Gwt = a function of frequency and direction          size Nt x Nf
      w = vector of angular frequencies in Rad/sec. Length Nf
  theta = vector of directions in radians           Length Nt   (default 0)
          ( theta = 0 -&gt; positive x axis theta = pi/2 -&gt; positive y axis)
    pos = [x,y,z] = vector giving coordinate position relative to [x0 y0 z0] (default [0,0,0])
   type = Number or string defining the transfer function in output. 
          1,  'n'    : Surface elevation              (n=Eta)     (default)
          2,  'n_t'  : Vertical surface velocity
          3,  'n_tt' : Vertical surface acceleration
          4,  'n_x'  : Surface slope in x-direction 
          5,  'n_y'  : Surface slope in y-direction
          6,  'n_xx' : Surface curvature in x-direction
          7,  'n_yy' : Surface curvature in y-direction
          8,  'n_xy' : Surface curvature in xy-direction
          9,  'P'    : Pressure fluctuation about static MWL pressure 
          10, 'U'    : Water particle velocity in x-direction
          11, 'V'    : Water particle velocity in y-direction
          12, 'W'    : Water particle velocity in z-direction
          13, 'U_t'  : Water particle acceleration in x-direction
          14, 'V_t'  : Water particle acceleration in y-direction
          15, 'W_t'  : Water particle acceleration in z-direction
          16, 'X_p'  : Water particle displacement in x-direction from its mean position
          17, 'Y_p'  : Water particle displacement in y-direction from its mean position
          18, 'Z_p'  : Water particle displacement in z-direction from its mean position
          19, 'Dummy': Transfer function is zero
     h  = water depth      (default inf) 
     g  = acceleration of <a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a> (default see <a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>)
    rho = water density    (default see <a href="../../wafo/misc/wdensity.html" class="code" title="  Returns the water density ">wdensity</a>)
    bet = 1, theta given in terms of directions toward which waves travel (default)
         -1, theta given in terms of directions from which waves come 
   igam = 1, if z is measured positive upward from mean water level (default)
          2, if z is measured positive downward from mean water level
          3, if z is measured positive upward from <a href="../../wafo/data/sea.html" class="code" title=" Surface elevation dataset used in WAT version 1.1.">sea</a> floor
    thx = angle clockwise from true north to positive x-axis in degrees
          (default 90)
    thy = angle clockwise from true north to positive y-axis in degrees
          (default 0)
     kw = vector of wave numbers corresponding to angular frequencies, w
          (default calculated with <a href="../../wafo/spec/w2k.html" class="code" title=" Translates from frequency to wave number">w2k</a>)
 
  Example:
    N=5000;dt=0.4;f0=0.1;th0=0;h=50; w0 = 2*pi*f0;
   t = linspace(0,1500,N)';
   types = [1 4 5];
   bfs   = [1 0 0];
   pos   = zeros(3,3);
   eta0 = exp(-i*w0*t);
   [Hw Gwt] = <a href="tran.html" class="code" title=" Computes transfer functions based on linear wave theory">tran</a>(w0,th0,pos(1,:),'n',h); 
   eta = real(Hw*Gwt*eta0)+0.001*rand(N,1);
   [Hw Gwt] = <a href="tran.html" class="code" title=" Computes transfer functions based on linear wave theory">tran</a>(w0,th0,pos(2,:),'n_x',h); 
   n_x = real(Hw*Gwt*eta0)+0.001*rand(N,1);
   [Hw Gwt] = <a href="tran.html" class="code" title=" Computes transfer functions based on linear wave theory">tran</a>(w0,th0,pos(3,:),'n_y',h); 
   n_y = real(Hw*Gwt*eta0)+0.001*rand(N,1);
 
   S = <a href="dat2dspec.html" class="code" title=" Estimates the directional wave spectrum from timeseries  ">dat2dspec</a>([t eta n_x n_y],[pos types',bfs'],h,256,101);
   <a href="../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S)
 
  See also  <a href="dat2dspec.html" class="code" title=" Estimates the directional wave spectrum from timeseries  ">dat2dspec</a>, <a href="../../wafo/misc/wdensity.html" class="code" title="  Returns the water density ">wdensity</a>, <a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/misc/gravity.html" class="code" title=" g=gravity(phi)">gravity</a></li></TD>
<TD>  returns the constant acceleration of gravity</TD>
</TR>
<TR>
<TD><li><a href="ratio.html" class="code" title=" [r,r2]=ratio(a,b,sa,sb);">ratio</a></li></TD>
<TD> compute ratio of hyperbolic functions</TD>
</TR>
<TR>
<TD><li><a href="sensortypeid.html" class="code" title=" sensorid = sensortypeid(sensortype)">sensortypeid</a></li></TD>
<TD> Return ID for sensortype name</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/spec/w2k.html" class="code" title=" [k,k2,ind]=w2k(w,th,h,g),">w2k</a></li></TD>
<TD> Translates from frequency to wave number</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/misc/wdensity.html" class="code" title=" rho = wdensity(S,T,P)">wdensity</a></li></TD>
<TD>  Returns the water density</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\ischar.m">ischar</a></li></TD>
<TD>        True for character array (string).</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\sprintf.m">sprintf</a></li></TD>
<TD>       Write formatted data to string.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="dat2dspec.html" class="code" title=" [Sd,D,Sw,Fcof,Gwt,Sxy,Sxy1] = dat2dspec2(xn,pos,h,nfft,nt,method,varargin)">dat2dspec</a></li></TD>
<TD> Estimates the directional wave spectrum from timeseries</TD>
</TR>
<TR>
<TD><li><a href="testmeasurements.html" class="code" title=" D = testsurf(pos,type,thet0,f0,N,dt,amp,d,g,thetx,thety);">testmeasurements</a></li></TD>
<TD> Creates a test case for measurement time series</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [Hw, Gwt, kw,Hwt,ee]=<a name="_sub0" href="#_subfunctions" class="code">tran</a>(w,theta,pos,def,h,g,rho,bet,igam,thx,thy,kw);
002 <span class="comment">%TRAN Computes transfer functions based on linear wave theory</span>
003 <span class="comment">%     of the system with input surface elevation, </span>
004 <span class="comment">%     eta(x0,y0,t) = exp(i*(kx*x0+ky*y0-w*t)), </span>
005 <span class="comment">%     and output Y determined by type and pos. </span>
006 <span class="comment">%</span>
007 <span class="comment">% CALL:  [Hw Gwt kw Hwt] = tran(w,theta,pos,type,h,g,rho,bet,igam,thx,thy,kw);</span>
008 <span class="comment">%</span>
009 <span class="comment">%   Hwt = Hw(ones(Nt,1),:).*Gwt matrix of transfer functions values as function of </span>
010 <span class="comment">%         w (columns) and theta (rows)                   size Nt x Nf </span>
011 <span class="comment">%   Hw  = a function of frequency only (not direction)   size  1 x Nf</span>
012 <span class="comment">%   Gwt = a function of frequency and direction          size Nt x Nf</span>
013 <span class="comment">%     w = vector of angular frequencies in Rad/sec. Length Nf</span>
014 <span class="comment">% theta = vector of directions in radians           Length Nt   (default 0)</span>
015 <span class="comment">%         ( theta = 0 -&gt; positive x axis theta = pi/2 -&gt; positive y axis)</span>
016 <span class="comment">%   pos = [x,y,z] = vector giving coordinate position relative to [x0 y0 z0] (default [0,0,0])</span>
017 <span class="comment">%  type = Number or string defining the transfer function in output. </span>
018 <span class="comment">%         1,  'n'    : Surface elevation              (n=Eta)     (default)</span>
019 <span class="comment">%         2,  'n_t'  : Vertical surface velocity</span>
020 <span class="comment">%         3,  'n_tt' : Vertical surface acceleration</span>
021 <span class="comment">%         4,  'n_x'  : Surface slope in x-direction </span>
022 <span class="comment">%         5,  'n_y'  : Surface slope in y-direction</span>
023 <span class="comment">%         6,  'n_xx' : Surface curvature in x-direction</span>
024 <span class="comment">%         7,  'n_yy' : Surface curvature in y-direction</span>
025 <span class="comment">%         8,  'n_xy' : Surface curvature in xy-direction</span>
026 <span class="comment">%         9,  'P'    : Pressure fluctuation about static MWL pressure </span>
027 <span class="comment">%         10, 'U'    : Water particle velocity in x-direction</span>
028 <span class="comment">%         11, 'V'    : Water particle velocity in y-direction</span>
029 <span class="comment">%         12, 'W'    : Water particle velocity in z-direction</span>
030 <span class="comment">%         13, 'U_t'  : Water particle acceleration in x-direction</span>
031 <span class="comment">%         14, 'V_t'  : Water particle acceleration in y-direction</span>
032 <span class="comment">%         15, 'W_t'  : Water particle acceleration in z-direction</span>
033 <span class="comment">%         16, 'X_p'  : Water particle displacement in x-direction from its mean position</span>
034 <span class="comment">%         17, 'Y_p'  : Water particle displacement in y-direction from its mean position</span>
035 <span class="comment">%         18, 'Z_p'  : Water particle displacement in z-direction from its mean position</span>
036 <span class="comment">%         19, 'Dummy': Transfer function is zero</span>
037 <span class="comment">%    h  = water depth      (default inf) </span>
038 <span class="comment">%    g  = acceleration of gravity (default see gravity)</span>
039 <span class="comment">%   rho = water density    (default see wdensity)</span>
040 <span class="comment">%   bet = 1, theta given in terms of directions toward which waves travel (default)</span>
041 <span class="comment">%        -1, theta given in terms of directions from which waves come </span>
042 <span class="comment">%  igam = 1, if z is measured positive upward from mean water level (default)</span>
043 <span class="comment">%         2, if z is measured positive downward from mean water level</span>
044 <span class="comment">%         3, if z is measured positive upward from sea floor</span>
045 <span class="comment">%   thx = angle clockwise from true north to positive x-axis in degrees</span>
046 <span class="comment">%         (default 90)</span>
047 <span class="comment">%   thy = angle clockwise from true north to positive y-axis in degrees</span>
048 <span class="comment">%         (default 0)</span>
049 <span class="comment">%    kw = vector of wave numbers corresponding to angular frequencies, w</span>
050 <span class="comment">%         (default calculated with w2k)</span>
051 <span class="comment">%</span>
052 <span class="comment">% Example:</span>
053 <span class="comment">%   N=5000;dt=0.4;f0=0.1;th0=0;h=50; w0 = 2*pi*f0;</span>
054 <span class="comment">%  t = linspace(0,1500,N)';</span>
055 <span class="comment">%  types = [1 4 5];</span>
056 <span class="comment">%  bfs   = [1 0 0];</span>
057 <span class="comment">%  pos   = zeros(3,3);</span>
058 <span class="comment">%  eta0 = exp(-i*w0*t);</span>
059 <span class="comment">%  [Hw Gwt] = tran(w0,th0,pos(1,:),'n',h); </span>
060 <span class="comment">%  eta = real(Hw*Gwt*eta0)+0.001*rand(N,1);</span>
061 <span class="comment">%  [Hw Gwt] = tran(w0,th0,pos(2,:),'n_x',h); </span>
062 <span class="comment">%  n_x = real(Hw*Gwt*eta0)+0.001*rand(N,1);</span>
063 <span class="comment">%  [Hw Gwt] = tran(w0,th0,pos(3,:),'n_y',h); </span>
064 <span class="comment">%  n_y = real(Hw*Gwt*eta0)+0.001*rand(N,1);</span>
065 <span class="comment">%</span>
066 <span class="comment">%  S = dat2dspec([t eta n_x n_y],[pos types',bfs'],h,256,101);</span>
067 <span class="comment">%  wspecplot(S)</span>
068 <span class="comment">%</span>
069 <span class="comment">% See also  dat2dspec, wdensity, gravity</span>
070 
071 <span class="comment">% Reference</span>
072 <span class="comment">% Young I.R. (1994)</span>
073 <span class="comment">% &quot;On the measurement of directional spectra&quot;,</span>
074 <span class="comment">% Applied Ocean Research, Vol 16, pp 283-294</span>
075 
076 <span class="comment">% History</span>
077 <span class="comment">% revised pab jan2005 </span>
078 <span class="comment">% -moved the code changing sensortypename to sensortypeid into a separate</span>
079 <span class="comment">% function sensortypeid.m</span>
080 <span class="comment">% revised pab 11.10.2002</span>
081 <span class="comment">% - fixed some bugs in transfer functions</span>
082 <span class="comment">% - reordered the transfer functions</span>
083 <span class="comment">% - </span>
084 <span class="comment">% revised pab 07.11.2001</span>
085 <span class="comment">% -Made a fix for w=0 where the transfer functions sometimes is singular.</span>
086 <span class="comment">%  e.g., Hw  = w.*ratio(zk,hk,-1,-1); return NaN for zk=0,hk=0 and w=0.</span>
087 <span class="comment">%  This fix is strictly not correct for all cases, but suffices in most cases.</span>
088 <span class="comment">% -moved tran as a local function to a function in \wafo\multidim\</span>
089 <span class="comment">% revised pab 14.06.2000</span>
090 <span class="comment">% - updated documentation</span>
091 <span class="comment">% - clearified directions</span>
092 <span class="comment">% - added def for surface curvature</span>
093 <span class="comment">% revised pab 06.01.2000</span>
094 <span class="comment">%  - cleaned up documentation</span>
095 <span class="comment">%  - added default values</span>
096 <span class="comment">%  - speeded up computations</span>
097 <span class="comment">% based on transp by L. Borgman</span>
098 
099 <span class="comment">% Default values</span>
100 <span class="comment">%~~~~~~~~~~~~~~~</span>
101 <span class="keyword">if</span> nargin&lt;2|isempty(theta), theta = 0; <span class="keyword">end</span>
102 <span class="keyword">if</span> nargin&lt;3|isempty(pos),   pos   = [0 0 0]; <span class="keyword">end</span>
103 <span class="keyword">if</span> nargin&lt;4|isempty(def),   def   = 1; <span class="keyword">end</span>  
104 <span class="keyword">if</span> nargin&lt;5|isempty(h),     h     = inf; <span class="keyword">end</span>
105 <span class="keyword">if</span> nargin&lt;6|isempty(g),     g     = <a href="../../wafo/misc/gravity.html" class="code" title="  returns the constant acceleration of gravity ">gravity</a>;, <span class="keyword">end</span> <span class="comment">% accelleration of gravity</span>
106 <span class="keyword">if</span> nargin&lt;7|isempty(rho),   rho   = <a href="../../wafo/misc/wdensity.html" class="code" title="  Returns the water density ">wdensity</a>; <span class="keyword">end</span> <span class="comment">% water density given in kg/m^3</span>
107 <span class="keyword">if</span> nargin&lt;8|isempty(bet),   bet   = 1; <span class="keyword">end</span>
108 <span class="keyword">if</span> nargin&lt;9|isempty(igam),  igam  = 1;<span class="keyword">end</span>
109 <span class="keyword">if</span> nargin&lt;10|isempty(thx),  thx   = 90; <span class="keyword">end</span>
110 <span class="keyword">if</span> nargin&lt;11|isempty(thy),  thy   = 0; <span class="keyword">end</span>
111 <span class="keyword">if</span> nargin&lt;12|isempty(kw),   kw    = <a href="../../wafo/spec/w2k.html" class="code" title=" Translates from frequency to wave number">w2k</a>(w,0,h); <span class="keyword">end</span> <span class="comment">% find the wave number as function of angular frequency</span>
112 
113 <span class="keyword">if</span> ischar(def)
114   def1 = <a href="sensortypeid.html" class="code" title=" Return ID for sensortype name ">sensortypeid</a>(def);
115   <span class="keyword">if</span> isempty(def1)|length(def1)&gt;1
116     error(sprintf(<span class="string">'Invalid input def = %s'</span>,def))
117   <span class="keyword">end</span>
118   def = def1;
119 <span class="keyword">end</span>
120 
121 <span class="comment">% make sure they have the correct orientation</span>
122 theta = theta(:);
123 kw    = kw(:).';
124 w     = w(:).';
125 
126 
127 <span class="comment">% Compute various fixed arrays</span>
128 <span class="comment">% ----------------------------</span>
129 Nt    = length(theta);
130 Nf    = length(w);
131 Oneth = ones(Nt,1);
132 Onef  = ones(1,Nf);
133 
134 
135 
136 <span class="comment">% convert to from angle in degrees to radians</span>
137 thxr = thx*pi/180;
138 thyr = thy*pi/180;
139 
140 cthx = bet*cos(theta-thxr+pi/2);
141 <span class="comment">%cthy = cos(theta-thyr-pi/2);</span>
142 cthy = bet*sin(theta-thyr);
143 
144 <span class="comment">% Compute location complex exponential</span>
145 <span class="comment">% ------------------------------------</span>
146 
147 x=pos(1);y=pos(2);z=pos(3);
148 <span class="comment">%arg = bet*(x*cthx+y*cthy)*kw;</span>
149 <span class="comment">%arg = arg(:,Onef).*kw(Oneth,:);</span>
150 
151 <span class="comment">% old call</span>
152 <span class="comment">%ee=cos(arg)-(sqrt(-1))*sin(arg); <span class="comment">% exp(-i*k(w)*(x*cos(theta)+y*sin(theta)) size Nt X Nf</span></span>
153 <span class="comment">%new call</span>
154 ee= exp((sqrt(-1)*(x*cthx+y*cthy))*kw);   <span class="comment">% exp(i*k(w)*(x*cos(theta)+y*sin(theta)) size Nt X Nf</span>
155 
156 
157 <span class="keyword">if</span> def &gt; 8
158    <span class="comment">% Set up z and h arguments</span>
159    <span class="comment">% ------------------------ </span>
160    hk = kw*h;
161    <span class="keyword">switch</span> igam
162      <span class="keyword">case</span> 1,   zk = kw*(h+z); <span class="comment">% z measured positive upward from mean water level (default)</span>
163      <span class="keyword">case</span> 2,   zk = kw*(h-z); <span class="comment">% z measured positive downward from mean water level</span>
164      <span class="keyword">otherwise</span>,zk = kw*z;     <span class="comment">% z measured positive upward from sea floor</span>
165    <span class="keyword">end</span>
166 <span class="keyword">end</span>
167 
168 <span class="comment">% Start computation of complex transformations</span>
169 <span class="comment">% ---------------------------------------------</span>
170 <span class="keyword">switch</span> def
171   <span class="keyword">case</span> 1,                                    <span class="comment">% n   = Eta = wave profile</span>
172     Hw  = Onef;
173     Gwt = ee;
174     
175     <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
176     <span class="comment">%</span>
177     <span class="comment">%             Vertical surface velocity and acceleration</span>
178     <span class="comment">%</span>
179     <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
180     
181   <span class="keyword">case</span> 2,                                    <span class="comment">% n_t = Eta_t </span>
182     Hw  = w;
183     Gwt = -sqrt(-1)*ee;
184   <span class="keyword">case</span> 3,                                     <span class="comment">% n_tt = Eta_tt</span>
185     Hw  = w.^2;
186     Gwt = -ee;
187     
188     <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
189     <span class="comment">%</span>
190     <span class="comment">%             Surface slopes</span>
191     <span class="comment">%</span>
192     <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
193   <span class="keyword">case</span> 4,                                    <span class="comment">% n_x = Eta_x = x-slope</span>
194     Hw  = kw;
195     Gwt = sqrt(-1)*cthx(:,Onef).*ee;
196   <span class="keyword">case</span> 5,                                    <span class="comment">% n_y = Eta_y = y-slope</span>
197     Hw  = kw;
198     Gwt = sqrt(-1)*cthy(:,Onef).*ee;
199     
200     
201   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
202   <span class="comment">%</span>
203   <span class="comment">%             Surface curvatures</span>
204   <span class="comment">%</span>
205   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
206   <span class="keyword">case</span> 6,                                   <span class="comment">% n_xx = Eta_xx = Surface curvature (x-dir)</span>
207     Hw = kw.^2;
208     Gwt = -cthx(:,Onef).^2.*ee; 
209   <span class="keyword">case</span> 7,                                   <span class="comment">% n_yy = Eta_yy = Surface curvature (y-dir)</span>
210     Hw = kw.^2;
211     Gwt = -cthy(:,Onef).^2.*ee; 
212   <span class="keyword">case</span> 8,                                   <span class="comment">% n_xy = Eta_xy = Surface curvature (xy-dir)</span>
213     Hw = kw.^2;
214     Gwt = -cthx(:,Onef).*cthy(:,Onef).*ee; 
215   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
216   <span class="comment">%</span>
217   <span class="comment">%            Pressure</span>
218   <span class="comment">%</span>
219   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
220     
221     
222   <span class="keyword">case</span> 9, <span class="comment">% pressure fluctuations</span>
223     Hw  = rho*g*<a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,1,1);       <span class="comment">% cosh(zk)/cosh(hk)</span>
224     Gwt = ee;
225     
226   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
227   <span class="comment">%</span>
228   <span class="comment">%             water particle velocities</span>
229   <span class="comment">%</span>
230   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
231   <span class="keyword">case</span> 10,                                    <span class="comment">% U = x-velocity</span>
232     Hw  = w.*<a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,1,-1); <span class="comment">% w*cosh(zk)/sinh(hk)</span>
233     Gwt = cthx(:,Onef).*ee; <span class="comment">% cos(theta)*ee </span>
234   <span class="keyword">case</span> 11,                                    <span class="comment">% V = y-velocity</span>
235     Hw  = (w.*<a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,1,-1)); <span class="comment">% w*cosh(zk)/sinh(hk)</span>
236     Gwt = cthy(:,Onef).*ee; <span class="comment">% sin(theta)*ee </span>
237   <span class="keyword">case</span> 12,                                    <span class="comment">% W = z-velocity</span>
238     Hw  = w.*<a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,-1,-1); <span class="comment">% w*sinh(zk)/sinh(hk)</span>
239     Gwt = -sqrt(-1)*ee;                        <span class="comment">%-?         </span>
240     
241   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
242   <span class="comment">%</span>
243   <span class="comment">%             water particle acceleration</span>
244   <span class="comment">%</span>
245   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%  </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
246   <span class="keyword">case</span> 13 ,                                   <span class="comment">% U_t = x-acceleration</span>
247     Hw  = (w.^2).*<a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,1,-1);<span class="comment">% w^2*cosh(zk)/sinh(hk)</span>
248     Gwt = -sqrt(-1)*cthx(:,Onef).*ee;                         <span class="comment">%-?</span>
249   <span class="keyword">case</span> 14  ,                                  <span class="comment">% V_t = y-acceleration</span>
250     Hw  = (w.^2).*<a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,1,-1);<span class="comment">% w^2*cosh(zk)/sinh(hk)</span>
251     Gwt = -sqrt(-1)*cthy(:,Onef).*ee;                         <span class="comment">%-?</span>
252   <span class="keyword">case</span> 15,                                    <span class="comment">% W_t = z-acceleration</span>
253     Hw  = (w.^2).*<a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,-1,-1);<span class="comment">% w*sinh(zk)/sinh(hk)</span>
254     Gwt = -ee;
255     
256    
257   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
258   <span class="comment">%</span>
259   <span class="comment">%             water particle displacement</span>
260   <span class="comment">%</span>
261   <span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">%<span class="comment">% </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
262   <span class="keyword">case</span> 16,                                    <span class="comment">% X_p = x-displacement</span>
263     Hw  = <a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,1,-1);            <span class="comment">% cosh(zk)./sinh(hk)</span>
264     Gwt = sqrt(-1)*cthx(:,Onef).*ee;
265   <span class="keyword">case</span> 17,                                    <span class="comment">% Y_p = y-displacement</span>
266     Hw  = <a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,1,-1);            <span class="comment">% cosh(zk)./sinh(hk) </span>
267     Gwt = sqrt(-1)*cthy(:,Onef).*ee; 
268   <span class="keyword">case</span> 18,                                    <span class="comment">% Z_p = z-displacement</span>
269     Hw  = <a href="ratio.html" class="code" title=" compute ratio of hyperbolic functions ">ratio</a>(zk,hk,-1,-1);            <span class="comment">% sinh(zk)./sinh(hk) </span>
270     Gwt = ee;
271   <span class="keyword">otherwise</span>
272     error(<span class="string">'Unknown option 1&lt;=def&lt;=18'</span>)
273  <span class="keyword">end</span>
274  
275  <span class="comment">% New call to avoid singularities. pab 07.11.200</span>
276  <span class="comment">% Set Hw to 0 for expressions w*ratio(z*k,h*k,1,-1)= 0*inf</span>
277 Hw(isnan(Hw) | isinf(Hw)) = 0;
278 
279 sgn = sign(Hw);
280 k0 = find(sgn&lt;0);
281 <span class="keyword">if</span> any(k0) <span class="comment">% make sure Hw&gt;=0 ie. transfer negative signs to Gwt</span>
282   Gwt(:,k0) = -Gwt(:,k0);
283   Hw(k0)    = -Hw(k0);
284   
285 <span class="keyword">end</span>
286 <span class="keyword">if</span> igam==2, 
287   <span class="comment">%pab 09 Oct.2002: bug fix</span>
288   <span class="comment">%  Changing igam by 2 should affect the directional result in the same way that changing eta by -eta!</span>
289   Gwt = -Gwt;
290 <span class="keyword">end</span>
291 
292 
293 <span class="keyword">if</span> nargout&gt;3
294  Hwt=Hw(Oneth,:).*Gwt;
295 <span class="keyword">end</span>
296 <span class="comment">%if Hw is wanted in size Nt x Nf uncomment this!!!</span>
297 <span class="comment">%   Hw=Hw(Oneth,:); </span>
298 
299 <span class="keyword">return</span>
300 
301</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>