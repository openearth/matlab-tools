<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of res2arfc</title>
  <meta name="keywords" content="res2arfc">
  <meta name="description" content=" Calculates asymmetric rainflow cycles for a residual.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">cycles</a> &gt; res2arfc.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\cycles&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>res2arfc
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Calculates asymmetric rainflow cycles for a residual.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [ARFC] = res2arfc(res,def,def_time) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="res2arfc.html" class="code" title=" Calculates asymmetric rainflow cycles for a residual.">RES2ARFC</a> Calculates asymmetric rainflow cycles for a residual.
 
  CALL:   ARFC_res = <a href="res2arfc.html" class="code" title=" Calculates asymmetric rainflow cycles for a residual.">res2arfc</a>(res);
          ARFC_res = <a href="res2arfc.html" class="code" title=" Calculates asymmetric rainflow cycles for a residual.">res2arfc</a>(res,def,def_time);
 
  Output:
    ARFC_res = Asymmetric RFC for residual.             [N,2]/[N,4]
 
  Input:
    res      = Residual.                               [nres,1]/[nres,2]
    def      = Treatment of residual.
               'up':   Count min-to-Max cycles,    (default)
                       gives correct number of upcrossings.
               'down': Count Max-to-min cycles, 
                       gives correct number of downcrossings.
               'CS':   Cloormann/Seeger method, 
                       gives all closed hysterisis loops.
                       This method is identical to the French AFNOR recommendation, 
                       and the ASTM standard (variant called simplified version).
  def_time   = 0: Don't store time of max and min. (default)
               1: Store the time when the maxima and minima occured.
 
  Example:
    x = load('sea.dat'); tp=<a href="../../wafo/onedim/dat2tp.html" class="code" title=" Extracts turning points from data,">dat2tp</a>(x);
    [ARFC,res]=<a href="tp2arfc4p.html" class="code" title=" Calculates asymmetric rainflow cycles from turning points (4-point).">tp2arfc4p</a>(tp);      % Default (min-to-Max cycles in residual)
    ARFC_res = <a href="res2arfc.html" class="code" title=" Calculates asymmetric rainflow cycles for a residual.">res2arfc</a>(res);      % Cycles in residual
    <a href="ccplot.html" class="code" title=" Plots a cycle count as a point process in the plane.">ccplot</a>(ARFC), hold on, plot(ARFC_res(:,1),ARFC_res(:,2),'r.'), hold off
 
  See also  <a href="tp2arfc.html" class="code" title=" Calculates asymmetric rainflow cycles from turning points.">tp2arfc</a>, <a href="tp2arfc4p.html" class="code" title=" Calculates asymmetric rainflow cycles from turning points (4-point).">tp2arfc4p</a>, <a href="../../wafo/onedim/findrfc.html" class="code" title=" Finds indices to rainflow cycles of a sequence of TP. ">findrfc</a>, <a href="dtp2arfm.html" class="code" title=" Calculates asymmetric RFM from discrete turning points.">dtp2arfm</a>, <a href="tp2rfc.html" class="code" title=" Finds the rainflow cycles from the sequence of turning points.">tp2rfc</a>, <a href="../../wafo/onedim/dat2tp.html" class="code" title=" Extracts turning points from data,">dat2tp</a>, rfcfilt</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="rfcfilter.html" class="code" title=" [y] = rfcfilter(x,h,def)">rfcfilter</a></li></TD>
<TD> Rainflow filter a signal.</TD>
</TR>
<TR>
<TD><li><a href="tp2arfc4p.html" class="code" title=" [ARFC,res] = tp2arfc4p(x,res0,def_time)">tp2arfc4p</a></li></TD>
<TD> Calculates asymmetric rainflow cycles from turning points (4-point).</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="dtp2arfm.html" class="code" title=" [RFM,RFM1,res] = dtp2arfm(x,in2,in3,res0)">dtp2arfm</a></li></TD>
<TD> Calculates asymmetric RFM from discrete turning points.</TD>
</TR>
<TR>
<TD><li><a href="tp2arfc.html" class="code" title=" [ARFC,ARFC1,res,def] = tp2arfc(x,def,ARFC0,res0)">tp2arfc</a></li></TD>
<TD> Calculates asymmetric rainflow cycles from turning points.</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [ARFC] = <a name="_sub0" href="#_subfunctions" class="code">res2arfc</a>(res,def,def_time)
002 <span class="comment">%RES2ARFC Calculates asymmetric rainflow cycles for a residual.</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL:   ARFC_res = res2arfc(res);</span>
005 <span class="comment">%         ARFC_res = res2arfc(res,def,def_time);</span>
006 <span class="comment">%</span>
007 <span class="comment">% Output:</span>
008 <span class="comment">%   ARFC_res = Asymmetric RFC for residual.             [N,2]/[N,4]</span>
009 <span class="comment">%</span>
010 <span class="comment">% Input:</span>
011 <span class="comment">%   res      = Residual.                               [nres,1]/[nres,2]</span>
012 <span class="comment">%   def      = Treatment of residual.</span>
013 <span class="comment">%              'up':   Count min-to-Max cycles,    (default)</span>
014 <span class="comment">%                      gives correct number of upcrossings.</span>
015 <span class="comment">%              'down': Count Max-to-min cycles, </span>
016 <span class="comment">%                      gives correct number of downcrossings.</span>
017 <span class="comment">%              'CS':   Cloormann/Seeger method, </span>
018 <span class="comment">%                      gives all closed hysterisis loops.</span>
019 <span class="comment">%                      This method is identical to the French AFNOR recommendation, </span>
020 <span class="comment">%                      and the ASTM standard (variant called simplified version).</span>
021 <span class="comment">% def_time   = 0: Don't store time of max and min. (default)</span>
022 <span class="comment">%              1: Store the time when the maxima and minima occured.</span>
023 <span class="comment">%</span>
024 <span class="comment">% Example:</span>
025 <span class="comment">%   x = load('sea.dat'); tp=dat2tp(x);</span>
026 <span class="comment">%   [ARFC,res]=tp2arfc4p(tp);      <span class="comment">% Default (min-to-Max cycles in residual)</span></span>
027 <span class="comment">%   ARFC_res = res2arfc(res);      <span class="comment">% Cycles in residual</span></span>
028 <span class="comment">%   ccplot(ARFC), hold on, plot(ARFC_res(:,1),ARFC_res(:,2),'r.'), hold off</span>
029 <span class="comment">%</span>
030 <span class="comment">% See also  tp2arfc, tp2arfc4p, findrfc, dtp2arfm, tp2rfc, dat2tp, rfcfilt</span>
031 
032 <span class="comment">% Tested  on Matlab  5.3</span>
033 <span class="comment">%</span>
034 <span class="comment">% History:</span>
035 <span class="comment">% Created by PJ (Pär Johannesson) 25-Jul-2000</span>
036 <span class="comment">% Revised by PJ 09-Oct-2000</span>
037 <span class="comment">%   Some small corrections.</span>
038 <span class="comment">% Revised by PJ 04-Apr-2001</span>
039 <span class="comment">% - Added input def_time</span>
040 <span class="comment">% Correction by PJ 08-Nov-2001</span>
041 <span class="comment">%   Changed </span>
042 <span class="comment">%     [ARFC,res_res] = tp2arfc4p(res2,def_time);</span>
043 <span class="comment">%   to</span>
044 <span class="comment">%     [ARFC,res_res] = tp2arfc4p(res2,[],def_time);</span>
045 <span class="comment">% Correction by PJ 13-Jun-2003</span>
046 <span class="comment">%   Exit funtion if less than two points in residual</span>
047 
048 <span class="comment">% Check input arguments</span>
049 ni = nargin;
050 no = nargout;
051 error(nargchk(1,3,ni));
052 
053 <span class="keyword">if</span> ni&lt;2, def=[]; <span class="keyword">end</span>
054 <span class="keyword">if</span> ni&lt;3, def_time = []; <span class="keyword">end</span>
055 
056 <span class="comment">% Default value</span>
057 <span class="keyword">if</span> isempty(def), def=<span class="string">'up'</span>; <span class="keyword">end</span>
058 <span class="keyword">if</span> isempty(def_time), def_time=0; <span class="keyword">end</span>
059 
060 <span class="comment">% Initiate</span>
061 [nres,nn] = size(res);
062 
063 <span class="comment">% Exit funtion if less than two points in residual</span>
064 <span class="keyword">if</span> nres&lt;2
065     ARFC = [];
066     <span class="keyword">return</span>
067 <span class="keyword">end</span>
068 
069 <span class="comment">% Count min-to-Max cycles, gives correct number of upcrossings</span>
070 <span class="keyword">if</span> strcmp(lower(def),<span class="string">'up'</span>)
071   <span class="keyword">if</span> res(2,nn)-res(1,nn)&gt;0 <span class="comment">% First point is a minimum?</span>
072     i_start=1;
073   <span class="keyword">else</span>
074     i_start=2;
075   <span class="keyword">end</span>
076     
077   I = i_start:2:nres-1;
078   <span class="keyword">if</span> def_time == 0
079     ARFC = [res(I,nn) res(I+1,nn)];
080   <span class="keyword">else</span>
081     ARFC = [res(I,2:nn) res(I+1,2:nn) res(I,1) res(I+1,1)];
082   <span class="keyword">end</span>
083   
084 <span class="comment">% Count Max-to-min cycles, gives correct number of downcrossings</span>
085 <span class="keyword">elseif</span> strcmp(lower(def),<span class="string">'down'</span>)
086   
087   <span class="keyword">if</span> res(2,nn)-res(1,nn)&gt;0 <span class="comment">% First point is a minimum?</span>
088     i_start=2;
089   <span class="keyword">else</span>
090     i_start=1;
091   <span class="keyword">end</span>
092   
093   I = i_start:2:nres-1;
094   <span class="keyword">if</span> def_time == 0
095     ARFC = [res(I,nn) res(I+1,nn)];
096   <span class="keyword">else</span>
097     ARFC = [res(I,2:nn) res(I+1,2:nn) res(I,1) res(I+1,1)];
098   <span class="keyword">end</span>
099   
100 <span class="comment">% Cloormann/Seeger, gives all closed hysterisis loops  </span>
101 <span class="keyword">elseif</span> strcmp(lower(def),<span class="string">'cs'</span>)
102   
103   res2 = [res;res];           <span class="comment">% Concatenate two residuals</span>
104   res2 = <a href="rfcfilter.html" class="code" title=" Rainflow filter a signal.">rfcfilter</a>(res2,0,1); <span class="comment">% Get turning points</span>
105   [ARFC,res_res] = <a href="tp2arfc4p.html" class="code" title=" Calculates asymmetric rainflow cycles from turning points (4-point).">tp2arfc4p</a>(res2,[],def_time);
106   
107 <span class="keyword">end</span>
108 
109</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>