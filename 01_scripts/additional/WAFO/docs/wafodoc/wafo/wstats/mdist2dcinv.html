<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of mdist2dcinv</title>
  <meta name="keywords" content="mdist2dcinv">
  <meta name="description" content=" Inverse of the conditional cdf of X2 given X1.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">wstats</a> &gt; mdist2dcinv.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\wstats&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>mdist2dcinv
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Inverse of the conditional cdf of X2 given X1.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [x, ind]= mdist2dcinv(x1,p,phat); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="mdist2dcinv.html" class="code" title=" Inverse of the conditional cdf of X2 given X1.">MDIST2DCINV</a> Inverse of the conditional cdf of X2 given X1.
  
    CALL: x2 =  <a href="mdist2dcinv.html" class="code" title=" Inverse of the conditional cdf of X2 given X1.">mdist2dcinv</a>(x1,P,phat)  
 
   x2 = the inverse of <a href="mdist2dcdf.html" class="code" title=" Joint 2D CDF due to Plackett ">mdist2dcdf</a> given x1 and P
   x1 = quantiles
   P  = 0..1
   phat = parameter structure (see <a href="mdist2dfit.html" class="code" title=" Parameter estimates for MDIST2D data. ">mdist2dfit</a>)
 
    The size of X2 is the common size of the input arguments X1 and P. 
    A scalar input functions as a constant matrix of the same size as the
    other inputs.    
 
    <a href="mdist2dcinv.html" class="code" title=" Inverse of the conditional cdf of X2 given X1.">MDIST2DCINV</a> uses Newton's method to converge to the solution.
 
  See also   <a href="mdist2dcdf.html" class="code" title=" Joint 2D CDF due to Plackett ">mdist2dcdf</a>,  <a href="mdist2dpdf.html" class="code" title=" Joint 2D PDF due to Plackett given as  f{x1}*f{x2}*G(x1,x2;Psi). ">mdist2dpdf</a>, <a href="mdist2dfit.html" class="code" title=" Parameter estimates for MDIST2D data. ">mdist2dfit</a>, <a href="mdist2drnd.html" class="code" title="  Random points from a bivariate MDIST2D distribution ">mdist2drnd</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="comnsize.html" class="code" title=" [errorcode,varargout] = comnsize(varargin)">comnsize</a></li></TD>
<TD> Check if all input arguments are either scalar or of common size.</TD>
</TR>
<TR>
<TD><li><a href="mdist2dcdf.html" class="code" title=" y = mdist2dcdf(V,H,phat,condon)">mdist2dcdf</a></li></TD>
<TD> Joint 2D CDF due to Plackett</TD>
</TR>
<TR>
<TD><li><a href="mdist2dpdf.html" class="code" title=" y = mdist2dpdf(V,H,phat,condon)">mdist2dpdf</a></li></TD>
<TD> Joint 2D PDF due to Plackett given as  f{x1}*f{x2}*G(x1,x2;Psi).</TD>
</TR>
<TR>
<TD><li><a href="mdist2dstat.html" class="code" title=" [M ,V ,Tm ,cvar, tolm, tolv] = mdist2dstat(phat,condon,cvar,tol)">mdist2dstat</a></li></TD>
<TD>  Mean and variance for the MDIST2D distribution.</TD>
</TR>
<TR>
<TD><li><a href="wlogninv.html" class="code" title=" x = wlogninv(F,m,v)">wlogninv</a></li></TD>
<TD> Inverse of the Lognormal distribution function</TD>
</TR>
<TR>
<TD><li><a href="wnorminv.html" class="code" title=" x = wnorminv(F,m,v)">wnorminv</a></li></TD>
<TD> Inverse of the Normal distribution function</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\inf.m">inf</a></li></TD>
<TD>           Infinity.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\polyfun\interp1.m">interp1</a></li></TD>
<TD>       1-D interpolation (table lookup)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\linspace.m">linspace</a></li></TD>
<TD>      Linearly spaced vector.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\nan.m">nan</a></li></TD>
<TD>           Not-a-Number.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\num2str.m">num2str</a></li></TD>
<TD>       Convert number to string. (Fast version)</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="mdist2drnd.html" class="code" title=" [V,H,ind] = mdist2drnd(N,phat)">mdist2drnd</a></li></TD>
<TD>  Random points from a bivariate MDIST2D distribution</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [x, ind]= <a name="_sub0" href="#_subfunctions" class="code">mdist2dcinv</a>(x1,p,phat);
002 <span class="comment">%MDIST2DCINV Inverse of the conditional cdf of X2 given X1.</span>
003 <span class="comment">% </span>
004 <span class="comment">%   CALL: x2 =  mdist2dcinv(x1,P,phat)  </span>
005 <span class="comment">%</span>
006 <span class="comment">%  x2 = the inverse of mdist2dcdf given x1 and P</span>
007 <span class="comment">%  x1 = quantiles</span>
008 <span class="comment">%  P  = 0..1</span>
009 <span class="comment">%  phat = parameter structure (see mdist2dfit)</span>
010 <span class="comment">%</span>
011 <span class="comment">%   The size of X2 is the common size of the input arguments X1 and P. </span>
012 <span class="comment">%   A scalar input functions as a constant matrix of the same size as the</span>
013 <span class="comment">%   other inputs.    </span>
014 <span class="comment">%</span>
015 <span class="comment">%   MDIST2DCINV uses Newton's method to converge to the solution.</span>
016 <span class="comment">%</span>
017 <span class="comment">% See also   mdist2dcdf,  mdist2dpdf, mdist2dfit, mdist2drnd</span>
018 
019 <span class="comment">%   References:</span>
020 <span class="comment">%      Plackett, R. L. (1965) &quot;A class of bivariate distributions.&quot;</span>
021 <span class="comment">%                                J. Am. Stat. Assoc. 60. 516-22</span>
022 <span class="comment">%      [1]  Michel K. Ochi,</span>
023 <span class="comment">%       OCEAN TECHNOLOGY series 6</span>
024 <span class="comment">%      &quot;OCEAN WAVES, The stochastic approach&quot;, Cambridge</span>
025 <span class="comment">%      1998 pp. 133-134.</span>
026 
027 
028 <span class="comment">%  tested on: matlab 5.2</span>
029 <span class="comment">% history</span>
030 <span class="comment">% revised pab 8.11.1999</span>
031 <span class="comment">%  - updated header info</span>
032 <span class="comment">%  - changed phat from vectro to structure</span>
033 <span class="comment">% By Per A. Brodtkorb 01.02.99</span>
034 
035 error(nargchk(3,3,nargin))
036 [errorcode  x1 p ] = <a href="comnsize.html" class="code" title=" Check if all input arguments are either scalar or of common size.">comnsize</a>(x1,p);
037 
038 <span class="keyword">if</span> errorcode &gt; 0
039     error(<span class="string">'Requires non-scalar arguments to match in size.'</span>);
040 <span class="keyword">end</span>
041 
042 VDIST=lower(phat.dist{1});
043 HDIST= lower(phat.dist{2});
044 
045 <span class="comment">%   Initialize X to zero.</span>
046 x = zeros(size(p));
047 <span class="comment">%size(x),size(x1)</span>
048 ok=(p &gt; 0  &amp;  p &lt; 1);
049 k = find(~ok);
050 <span class="keyword">if</span> any(k),
051     tmp  = NaN;
052     x(k) = tmp(ones(size(k))); 
053 <span class="keyword">end</span>
054 
055 <span class="comment">% The inverse cdf of 0 is 0, and the inverse cdf of 1 is inf.  </span>
056 <span class="comment">%k0 = find(p == 0);</span>
057 <span class="comment">%if any(k0),</span>
058 <span class="comment">%    x(k0) = zeros(size(k0)); </span>
059 <span class="comment">%end</span>
060 
061 k1 = find((p == 1| isinf(x1) ));
062 <span class="keyword">if</span> any(k1), 
063   tmp = Inf;
064     x(k1) = tmp(ones(size(k1))); 
065 <span class="keyword">end</span>
066 
067 <span class="comment">% Newton's Method</span>
068 <span class="comment">% Permit no more than count_limit interations.</span>
069 count_limit = 150;
070 count = 0;
071 
072 k = find(~isinf(x1) &amp; ok );
073 
074 pk = p(k);
075 
076 <span class="comment">% Supply a starting guess for the iteration.</span>
077 cvar=linspace(eps,max(x1(k)),15); <span class="comment">% make sure that the comp. of mn and v do </span>
078                                 <span class="comment">% not consume valuable time</span>
079 [mn v ]=<a href="mdist2dstat.html" class="code" title="  Mean and variance for the MDIST2D distribution. ">mdist2dstat</a>(phat,1,cvar); <span class="comment">%slow</span>
080 mn = interp1(cvar,mn,x1(k),<span class="string">'linear'</span>); <span class="comment">%fast</span>
081 v = interp1(cvar,v,x1(k),<span class="string">'linear'</span>); <span class="comment">%fast</span>
082 
083 <span class="keyword">switch</span> 2, <span class="comment">%method</span>
084   <span class="keyword">case</span> 1,<span class="comment">%Use a lognormal distribution. </span>
085   temp = log(v + mn .^ 2); 
086   mu = 2 * log(mn) - 0.5 * temp;
087   sigma = -2 * log(mn) + temp;
088   xk = (<a href="wlogninv.html" class="code" title=" Inverse of the Lognormal distribution function">wlogninv</a>(pk,mu,sigma.^2));
089   <span class="comment">%xk = exp(wnorminv(pk,mu,sigma));</span>
090 <span class="keyword">case</span> 2, <span class="comment">%   Use a normal distribution. probably the fastest choice</span>
091   xk=abs(<a href="wnorminv.html" class="code" title=" Inverse of the Normal distribution function ">wnorminv</a>(pk,mn,v));
092   <span class="comment">%xk((xk&lt;=0))=1e-3;</span>
093     <span class="keyword">if</span> any(isnan(xk))
094       disp([<span class="string">'Warning: NaNs   '</span> num2str(sum(isnan(xk)))])
095     <span class="keyword">end</span>
096 
097 <span class="keyword">end</span>
098 <span class="comment">%x(k)=xk;</span>
099 <span class="comment">%return</span>
100 h = ones(size(pk)); 
101 
102 <span class="comment">% Break out of the iteration loop for three reasons:</span>
103 <span class="comment">%  1) the last update is very small (compared to x)</span>
104 <span class="comment">%  2) the last update is very small (compared to sqrt(eps))</span>
105 <span class="comment">%  3) There are more than 100 iterations. This should NEVER happen.</span>
106  
107 k2=find((abs(h) &gt; sqrt(eps)*abs(xk))  &amp;  abs(h) &gt; sqrt(eps));
108 <span class="keyword">while</span>(any(k2) &amp; count &lt; count_limit), 
109                                  
110     count = count + 1;
111     h(k2)  = (<a href="mdist2dcdf.html" class="code" title=" Joint 2D CDF due to Plackett ">mdist2dcdf</a>(x1(k(k2)),xk(k2),phat,1) - pk(k2)) ./ <a href="mdist2dpdf.html" class="code" title=" Joint 2D PDF due to Plackett given as  f{x1}*f{x2}*G(x1,x2;Psi). ">mdist2dpdf</a>(x1(k(k2)),xk(k2),phat,1);
112    <span class="comment">% if any(isnan(h(k2))),      h(isnan(h))=-0.01;    end</span>
113     xnew = xk(k2) - h(k2);
114     <span class="comment">% Make sure that xnew&gt;0</span>
115     ix = find(xnew &lt;= 0);
116     <span class="keyword">if</span> any(ix),
117         xnew(ix) = xk(k2(ix)) / 10;
118         h(k2(ix)) = xk(k2(ix))-xnew(ix);
119     <span class="keyword">end</span>
120     xk(k2) = xnew;
121      disp([<span class="string">'Iteration  '</span>num2str(count) , <span class="string">'  Number of points left:  '</span> num2str(length(k2)) ]),
122     <span class="comment">%if any(isnan(xk)),  disp(['Warning: values out of range   ' num2str(sum(isnan(xk)))]),   end</span>
123     k2=find((abs(h) &gt; sqrt(eps)*abs(xk))  &amp;  abs(h) &gt; sqrt(eps));   
124 <span class="keyword">end</span>
125 
126 
127 <span class="comment">% Store the converged value in the correct place</span>
128 x(k) = xk;
129 
130 <span class="keyword">if</span> count == count_limit, 
131     disp(<span class="string">'Warning: MDIST2DCINV did not converge.'</span>);
132     str = [<span class="string">'The last steps were all less than:  '</span> num2str(max(abs(h(k2))))];
133     disp(outstr)
134     ind=k(k2);
135   <span class="keyword">else</span>
136     ind=[];
137 <span class="keyword">end</span>
138 
139 
140 
141 
142 
143</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>