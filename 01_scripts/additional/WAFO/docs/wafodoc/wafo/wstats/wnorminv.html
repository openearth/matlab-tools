<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of wnorminv</title>
  <meta name="keywords" content="wnorminv">
  <meta name="description" content=" Inverse of the Normal distribution function">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">wstats</a> &gt; wnorminv.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\wstats&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>wnorminv
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Inverse of the Normal distribution function</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> x = wnorminv(F,m,v) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="wnorminv.html" class="code" title=" Inverse of the Normal distribution function ">WNORMINV</a> Inverse of the Normal distribution function 
  
  CALL:  x = <a href="wnorminv.html" class="code" title=" Inverse of the Normal distribution function ">wnorminv</a>(F,m,v) 
  
         x = inverse cdf for the Normal distribution evaluated at F 
         m = mean     (default 0) 
         v = variance (default 1) 
  
  Example: 
    F = linspace(0,1,100); 
    x = <a href="wnorminv.html" class="code" title=" Inverse of the Normal distribution function ">wnorminv</a>(F,2.5,0.6); 
    plot(F,x) 
   
  See also  <a href="wnorminv.html" class="code" title=" Inverse of the Normal distribution function ">wnorminv</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="comnsize.html" class="code" title=" [errorcode,varargout] = comnsize(varargin)">comnsize</a></li></TD>
<TD> Check if all input arguments are either scalar or of common size.</TD>
</TR>
<TR>
<TD><li><a href="wnormcdf.html" class="code" title=" F = wnormcdf(x,m,v);">wnormcdf</a></li></TD>
<TD> Normal cumulative distribution function</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\nan.m">nan</a></li></TD>
<TD>           Not-a-Number.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/wavemodels/braylfit.html" class="code" title=" [phat, cov,pci]=braylfit(data1,alpha)">braylfit</a></li></TD>
<TD> Parameter estimates for Beta-Rayleigh data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/cdf2tr.html" class="code" title=" [g, test, g2] = cdf2tr(Fx1,ma ,sa,varargin)">cdf2tr</a></li></TD>
<TD> Estimate transformation, g, from observed CDF.</TD>
</TR>
<TR>
<TD><li><a href="dist2dfit.html" class="code" title=" [phat] =dist2dfit(V,H,dist,res,method,monitor,chat0)">dist2dfit</a></li></TD>
<TD> Parameter estimates for DIST2D data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/initoptions.html" class="code" title=" options = initoptions(speed,options)">initoptions</a></li></TD>
<TD> Initializes RIND options according to speed.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/lc2tr2.html" class="code" title=" [g, test, g2] = lc2tr(cross,ma,sa,varargin);">lc2tr2</a></li></TD>
<TD> Estimate transformation, g, from observed crossing intensity, version2.</TD>
</TR>
<TR>
<TD><li><a href="mdist2dcinv.html" class="code" title=" [x, ind]= mdist2dcinv(x1,p,phat);">mdist2dcinv</a></li></TD>
<TD> Inverse of the conditional cdf of X2 given X1.</TD>
</TR>
<TR>
<TD><li><a href="mdist2dfit.html" class="code" title=" phato=mdist2dfit(V,H,dist,alpha,method)">mdist2dfit</a></li></TD>
<TD> Parameter estimates for MDIST2D data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/mvnormpcprb.html" class="code" title=" [val, err,ier,extime]= mvnormpcprb(rho,a,b,tol,useSimpson,useBreakPoints)">mvnormpcprb</a></li></TD>
<TD> Multivariate Normal probabilities with product correlation</TD>
</TR>
<TR>
<TD><li><a href="nplot.html" class="code" title=" h= nplot(ef,id,offset)">nplot</a></li></TD>
<TD> Normal probability plot of effects</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wavemodels/ochi98fit.html" class="code" title=" [phat, pci,pinit]=ochi98fit(data,alpha)">ochi98fit</a></li></TD>
<TD> Parameter estimates and confidence intervals for Ochi data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/rind.html" class="code" title=" [fxind, err,exTime,options] = rind(BIG,Ex,Blo,Bup,indI,xc,Nt,varargin)">rind</a></li></TD>
<TD> Computes multivariate normal expectations</TD>
</TR>
<TR>
<TD><li><a href="wbetafit.html" class="code" title=" [phat, cov,pci]=wbetafit(data1, plotflag);">wbetafit</a></li></TD>
<TD> Parameter estimates for Beta data.</TD>
</TR>
<TR>
<TD><li><a href="wchi2fit.html" class="code" title=" [phat, cov,pci]=wchi2fit(data1, plotflag);">wchi2fit</a></li></TD>
<TD> Parameter estimates for Chi squared data.</TD>
</TR>
<TR>
<TD><li><a href="weib2dcinv.html" class="code" title=" [x, k2]= weib2dcinv(x1,p,a1,b1,a2,b2,c12,tol);">weib2dcinv</a></li></TD>
<TD> Inverse of the conditional 2D weibull cdf of X2 given X1.</TD>
</TR>
<TR>
<TD><li><a href="weib2dfit.html" class="code" title=" [phat, cov,pci]=weib2dfit(data1,data2,method,given,gparam,alpha)">weib2dfit</a></li></TD>
<TD> Parameter estimates for 2D Weibull data.</TD>
</TR>
<TR>
<TD><li><a href="wgamfit.html" class="code" title=" [phat, cov,pci]=wgamfit(data1, plotflag);">wgamfit</a></li></TD>
<TD> Parameter estimates for Gamma data.</TD>
</TR>
<TR>
<TD><li><a href="wgaminv.html" class="code" title=" x = wgaminv(F,a,b)">wgaminv</a></li></TD>
<TD> Inverse of the Gamma distribution function</TD>
</TR>
<TR>
<TD><li><a href="wgevfit.html" class="code" title=" [phat,cov,pci] = wgevfit(data,method,start,plotflag)">wgevfit</a></li></TD>
<TD> Parameter estimates for GEV data</TD>
</TR>
<TR>
<TD><li><a href="wggamfit.html" class="code" title=" [phat, cov,pci]=wggamfit(data1, plotflag,chat0);">wggamfit</a></li></TD>
<TD> Parameter estimates for Generalized Gamma data.</TD>
</TR>
<TR>
<TD><li><a href="wggaminv.html" class="code" title=" x = wggaminv(F,a,b,c)">wggaminv</a></li></TD>
<TD> Inverse of the Generalized Gamma distribution function</TD>
</TR>
<TR>
<TD><li><a href="wgumbfit.html" class="code" title=" [phat, cov,pci] = wgumbfit(data1, plotflag)">wgumbfit</a></li></TD>
<TD> Parameter estimates for Gumbel data.</TD>
</TR>
<TR>
<TD><li><a href="winvgfit.html" class="code" title=" [phat, var,ciL,ciU] = winvgfit(data,plotflag)">winvgfit</a></li></TD>
<TD> Parameter estimates for Inverse Gaussian data.</TD>
</TR>
<TR>
<TD><li><a href="wlogninv.html" class="code" title=" x = wlogninv(F,m,v)">wlogninv</a></li></TD>
<TD> Inverse of the Lognormal distribution function</TD>
</TR>
<TR>
<TD><li><a href="wraylfit.html" class="code" title=" [phat, var,pci] = wraylfit(data,plotflag)">wraylfit</a></li></TD>
<TD> Parameter estimates for Rayleigh data.</TD>
</TR>
<TR>
<TD><li><a href="wtfit.html" class="code" title=" [phat, cov,pci]=wtfit(data1, plotflag);">wtfit</a></li></TD>
<TD> Parameter estimates for Student's T data.</TD>
</TR>
<TR>
<TD><li><a href="wtinv.html" class="code" title=" x = wtinv(F,df)">wtinv</a></li></TD>
<TD> Inverse of the Student's T distribution function</TD>
</TR>
<TR>
<TD><li><a href="wtraylfit.html" class="code" title=" [phat,cov,pci] = wtraylfit(data,plotflag)">wtraylfit</a></li></TD>
<TD> Parameter estimates for Truncated Rayleigh data.</TD>
</TR>
<TR>
<TD><li><a href="wtweibfit.html" class="code" title=" [phat, cov, pci]=wtweibfit(data1, plotflag);">wtweibfit</a></li></TD>
<TD> Parameter estimates for truncated Weibull data.</TD>
</TR>
<TR>
<TD><li><a href="wweibfit.html" class="code" title=" [phat, cov, pci]=wweibfit(data1, plotflag);">wweibfit</a></li></TD>
<TD> Parameter estimates for Weibull data.</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code"> PHINV = PHIINV( P )</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> x = <a name="_sub0" href="#_subfunctions" class="code">wnorminv</a>(F,m,v) 
002 <span class="comment">%WNORMINV Inverse of the Normal distribution function </span>
003 <span class="comment">% </span>
004 <span class="comment">% CALL:  x = wnorminv(F,m,v) </span>
005 <span class="comment">% </span>
006 <span class="comment">%        x = inverse cdf for the Normal distribution evaluated at F </span>
007 <span class="comment">%        m = mean     (default 0) </span>
008 <span class="comment">%        v = variance (default 1) </span>
009 <span class="comment">% </span>
010 <span class="comment">% Example: </span>
011 <span class="comment">%   F = linspace(0,1,100); </span>
012 <span class="comment">%   x = wnorminv(F,2.5,0.6); </span>
013 <span class="comment">%   plot(F,x) </span>
014 <span class="comment">%  </span>
015 <span class="comment">% See also  wnorminv </span>
016    
017 <span class="comment">% Tested on: Matlab 6.0, 5.3 </span>
018 <span class="comment">% History: </span>
019 <span class="comment">% revised pab 23.03.2003 </span>
020 <span class="comment">% -replace erfinv with PHIINV which perform more accurate </span>
021 <span class="comment">%  inversion in the lower tail. This also results in faster execution. </span>
022 <span class="comment">% revised jr 03.04.2001 </span>
023 <span class="comment">%  - fixed a bug in the last if statement </span>
024 <span class="comment">%  - updated information, example </span>
025 <span class="comment">% revised pab 24.10.2000 </span>
026 <span class="comment">%  - added comnsize, nargchk </span>
027 <span class="comment">%  - added default values </span>
028 <span class="comment">% added ms 17.06.2000 </span>
029  
030 error(nargchk(1,3,nargin)) 
031 <span class="keyword">if</span> nargin&lt;2|isempty(m),  m=0;  <span class="keyword">end</span> 
032 <span class="keyword">if</span> nargin&lt;3|isempty(v),  v=1;  <span class="keyword">end</span> 
033  
034 [errorcode, F, m, v] = <a href="comnsize.html" class="code" title=" Check if all input arguments are either scalar or of common size.">comnsize</a> (F,m, v); 
035 <span class="keyword">if</span> (errorcode &gt; 0) 
036   error (<span class="string">'F, m and v must be of common size or scalar'</span>); 
037 <span class="keyword">end</span> 
038  
039 x=zeros(size(F)); 
040  
041 ok = ((v&gt;0)&amp;(F&gt;=0)&amp;(F&lt;=1)); 
042 k = find (ok); 
043 <span class="keyword">if</span> any(k) 
044   <span class="comment">% old call </span>
045   <span class="comment">%x(k) = sqrt(2*v(k)).*erfinv(2 * F(k) - 1) + m(k); </span>
046   <span class="comment">% new call </span>
047   x(k) = sqrt(v(k)).*<a href="#_sub1" class="code" title="sub  PHINV = PHIINV( P )">PHIINV</a>(F(k))+m(k); 
048 <span class="keyword">end</span> 
049  
050 k1 = find (~ok); 
051 <span class="keyword">if</span> any(k1) 
052   tmp=NaN; 
053   x(k1) = tmp(ones(size(k1))); 
054 <span class="keyword">end</span> 
055  
056 <span class="keyword">return</span> 
057  
058  
059 <span class="keyword">function</span> PHINV = <a name="_sub1" href="#_subfunctions" class="code">PHIINV</a>( P )  
060 <span class="comment">% </span>
061 <span class="comment">%    ALGORITHM AS241  APPL. STATIST. (1988) VOL. 37, NO. 3 </span>
062 <span class="comment">% </span>
063 <span class="comment">%    Produces the normal deviate Z corresponding to a given lower </span>
064 <span class="comment">%    tail area of P. </span>
065 <span class="comment">%   </span>
066 <span class="comment">%       Absolute error less than 1e-13 </span>
067 <span class="comment">%       Relative error less than 1e-15 for abs(VAL)&gt;0.1 </span>
068 <span class="comment">%   </span>
069 <span class="comment">%    The hash sums below are the sums of the mantissas of the </span>
070 <span class="comment">%    coefficients.   They are included for use in checking </span>
071 <span class="comment">%    transcription. </span>
072 <span class="comment">% </span>
073  
074    SPLIT1 = 0.425; 
075    SPLIT2 = 5; 
076    CONST1 = 0.180625; 
077    CONST2 = 1.6;  
078     
079     
080 <span class="comment">%  Coefficients in rational approximations.   </span>
081 <span class="comment">%!      </span>
082 <span class="comment">%!     Coefficients for P close to 0.5 </span>
083 <span class="comment">%!      </span>
084 A0 = 3.3871328727963666080E00; 
085 A1 = 1.3314166789178437745E+2; 
086 A2 = 1.9715909503065514427E+3; 
087 A3 = 1.3731693765509461125E+4; 
088 A4 = 4.5921953931549871457E+4; 
089 A5 = 6.7265770927008700853E+4; 
090 A6 = 3.3430575583588128105E+4; 
091 A7 = 2.5090809287301226727E+3; 
092  
093 B1 = 4.2313330701600911252E+1; 
094 B2 = 6.8718700749205790830E+2; 
095 B3 = 5.3941960214247511077E+3; 
096 B4 = 2.1213794301586595867E+4; 
097 B5 = 3.9307895800092710610E+4; 
098 B6 = 2.8729085735721942674E+4; 
099 B7 = 5.2264952788528545610E+3; 
100 <span class="comment">%*     HASH SUM AB    55.88319 28806 14901 4439 </span>
101 <span class="comment">%!      </span>
102 <span class="comment">%!     Coefficients for P not close to 0, 0.5 or 1. </span>
103 <span class="comment">%!      </span>
104 C0 = 1.42343711074968357734E00; 
105 C1 = 4.63033784615654529590E00; 
106 C2 = 5.76949722146069140550E00; 
107 C3 = 3.64784832476320460504E00;  
108 C4 = 1.27045825245236838258E00; 
109 C5 = 2.41780725177450611770E-1; 
110 C6 = 2.27238449892691845833E-2; 
111 C7 = 7.74545014278341407640E-4; 
112 D1 = 2.05319162663775882187E00; 
113 D2 = 1.67638483018380384940E00; 
114 D3 = 6.89767334985100004550E-1; 
115 D4 = 1.48103976427480074590E-1; 
116 D5 = 1.51986665636164571966E-2; 
117 D6 = 5.47593808499534494600E-4; 
118 D7 = 1.05075007164441684324E-9 ; 
119 <span class="comment">%*     HASH SUM CD    49.33206 50330 16102 89036 </span>
120 <span class="comment">%! </span>
121 <span class="comment">%!    Coefficients for P near 0 or 1. </span>
122 <span class="comment">%! </span>
123 E0 = 6.65790464350110377720E00; 
124 E1 = 5.46378491116411436990E00; 
125 E2 = 1.78482653991729133580E00; 
126 E3 = 2.96560571828504891230E-1; 
127 E4 = 2.65321895265761230930E-2; 
128 E5 = 1.24266094738807843860E-3; 
129 E6 = 2.71155556874348757815E-5; 
130 E7 = 2.01033439929228813265E-7; 
131 F1 = 5.99832206555887937690E-1; 
132 F2 = 1.36929880922735805310E-1; 
133 F3 = 1.48753612908506148525E-2; 
134 F4 = 7.86869131145613259100E-4; 
135 F5 = 1.84631831751005468180E-5; 
136 F6 = 1.42151175831644588870E-7; 
137 F7 = 2.04426310338993978564E-15; 
138 <span class="comment">%     HASH SUM EF    47.52583 31754 92896 71629 </span>
139  
140 PHINV = zeros(size(P)); 
141 Q = ( 2*P - 1 )/2; 
142 region1 =  abs(Q) &lt;= SPLIT1; 
143 k1 = find(region1); 
144 <span class="keyword">if</span> any(k1) 
145   R1 = CONST1 - Q(k1).^2; 
146   PHINV(k1) = Q(k1).*( ( ( ((((A7.*R1 + A6).*R1 + A5).*R1 + A4).*R1 + A3) <span class="keyword">...</span> 
147                .*R1 + A2 ).*R1 + A1 ).*R1 + A0 )              <span class="keyword">...</span> 
148       ./( ( ( ((((B7.*R1 + B6).*R1 + B5).*R1 + B4).*R1 + B3)  <span class="keyword">...</span> 
149           .*R1 + B2 ).*R1 + B1 ).*R1 + 1 ); 
150 <span class="keyword">end</span> 
151  
152 k2 = find(~region1); 
153 <span class="keyword">if</span> any(k2) 
154   R2 = min( P(k2), 1 - P(k2) ); 
155   k3 = find(R2&gt;0); 
156   <span class="keyword">if</span> any(k3) <span class="comment">%         if ( R2 &gt; 0 ) <span class="comment">%THEN </span></span>
157     R3 = sqrt( -log(R2(k3)) ); 
158     k4 = find(R3 &lt;= SPLIT2); 
159     <span class="keyword">if</span> any(k4)  <span class="comment">%if ( R2 &lt;= SPLIT2 ) <span class="comment">% THEN </span></span>
160       R4 = R3(k4) - CONST2; 
161       PHINV(k2(k3(k4))) = ( ( ( ((((C7.*R4 + C6).*R4 + C5).*R4 + <span class="keyword">...</span> 
162                   C4).*R4 + C3).*R4 + C2 ).*R4 + <span class="keyword">...</span> 
163                   C1 ).*R4 + C0 )  <span class="keyword">...</span> 
164       ./( ( ( ((((D7.*R4 + D6).*R4 + D5).*R4 + D4).*R4 + D3)  <span class="keyword">...</span> 
165           .*R4 + D2 ).*R4 + D1 ).*R4 + 1 ); 
166     <span class="keyword">end</span> 
167     k5 = find(R3 &gt; SPLIT2); 
168     <span class="keyword">if</span> any(k5) 
169       R5 = R3(k5) - SPLIT2; 
170       PHINV(k2(k3(k5))) = ( ( ( ((((E7.*R5 + E6).*R5 + E5).*R5 + <span class="keyword">...</span> 
171                   E4).*R5 + E3).*R5 + E2 ).*R5 + <span class="keyword">...</span> 
172                   E1 ).*R5 + E0 ) <span class="keyword">...</span> 
173       ./( ( ( ((((F7.*R5 + F6).*R5 + F5).*R5 + F4).*R5 + F3)  <span class="keyword">...</span> 
174           .*R5 + F2 ).*R5 + F1 ).*R5 + 1 ); 
175     <span class="keyword">end</span> <span class="comment">% IF </span>
176   <span class="keyword">end</span> 
177   k6 = find(R2&lt;=0); 
178   <span class="keyword">if</span> any(k6) 
179     PHINV(k2(k6)) = inf; 
180   <span class="keyword">end</span> <span class="comment">%IF </span>
181   k7 = find(Q(k2)&lt;0); 
182   <span class="keyword">if</span> any(k7) <span class="comment">%( Q &lt; 0 ) <span class="comment">%THEN </span></span>
183     PHINV(k2(k7)) = - PHINV(k2(k7)); 
184   <span class="keyword">end</span> <span class="comment">%IF </span>
185 <span class="keyword">end</span> <span class="comment">%IF </span>
186  
187 <span class="comment">% The relative error of the approximation has absolute value less </span>
188 <span class="comment">% than 1.e-13.  One iteration of Halley's rational method (third </span>
189 <span class="comment">% order) gives full machine precision. </span>
190 <span class="comment">%k = find(0 &lt; P &amp; P &lt; 1); </span>
191 <span class="keyword">if</span> 0 <span class="comment">%any(k) </span>
192   e = <a href="wnormcdf.html" class="code" title=" Normal cumulative distribution function ">wnormcdf</a>(PHINV(k)) - P(k);          <span class="comment">% error </span>
193   u = e * sqrt(2*pi) .* exp(PHINV(k).^2/2);        <span class="comment">% f(z)/df(z) </span>
194   <span class="comment">% Newton's method: </span>
195   <span class="comment">%PHINV(k) = PHINV(k) - u;  </span>
196   <span class="comment">% Halley's method: </span>
197   PHINV(k) = PHINV(k) - u./( 1 + PHINV(k).*u/2 );    
198 <span class="keyword">end</span> 
199 <span class="keyword">return</span> 
200  
201  
202  
203</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>