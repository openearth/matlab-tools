<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of mdist2dstatplot</title>
  <meta name="keywords" content="mdist2dstatplot">
  <meta name="description" content=" Computes and plots the conditional mean and standard deviation.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">wstats</a> &gt; mdist2dstatplot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\wstats&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>mdist2dstatplot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Computes and plots the conditional mean and standard deviation.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [ax11, h11, h22 ]=mdist2dstatplot(V,H,phat,condon ,res) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="mdist2dstatplot.html" class="code" title=" Computes and plots the conditional mean and standard deviation.">MDIST2DSTATPLOT</a> Computes and plots the conditional mean and standard deviation.
 
  CALL: <a href="mdist2dstatplot.html" class="code" title=" Computes and plots the conditional mean and standard deviation.">mdist2dstatplot</a>(x1,x2,phat,condon,res);
  
        x1,x2 = data
        phat  =  parameter structure array
      condon  = 1 mean and standard deviation of X2 given X1
                2 mean and standard deviation of X1 given X2 (default)
        res   = resolution (default <a href="range.html" class="code" title="  Calculates the difference between the maximum and minimum values. ">range</a>(x2)/12)
  
  
   <a href="mdist2dstatplot.html" class="code" title=" Computes and plots the conditional mean and standard deviation.">MDIST2DSTATPLOT</a> plots the  empirical conditional mean and standard deviation of
   X1 given X2 or X2 given X1 and compares it with  theoretical quantities.
 
  Example:
   x1=linspace(0,10)';
   phat.x={1 2 2 };
   phat.dist={'rayl','rayl'};
   [y1,y2] = <a href="mdist2drnd.html" class="code" title="  Random points from a bivariate MDIST2D distribution ">mdist2drnd</a>(2000,phat);
   <a href="mdist2dstatplot.html" class="code" title=" Computes and plots the conditional mean and standard deviation.">mdist2dstatplot</a>(y1,y2,phat,2); 
  
   See also  <a href="mdist2dstat.html" class="code" title="  Mean and variance for the MDIST2D distribution. ">mdist2dstat</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="mdist2dstat.html" class="code" title=" [M ,V ,Tm ,cvar, tolm, tolv] = mdist2dstat(phat,condon,cvar,tol)">mdist2dstat</a></li></TD>
<TD>  Mean and variance for the MDIST2D distribution.</TD>
</TR>
<TR>
<TD><li><a href="range.html" class="code" title=" y = range(x)">range</a></li></TD>
<TD>  Calculates the difference between the maximum and minimum values.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\axes.m">axes</a></li></TD>
<TD>          Create axes in arbitrary positions.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graphics\hold.m">hold</a></li></TD>
<TD>          Hold current graph.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\linspace.m">linspace</a></li></TD>
<TD>      Linearly spaced vector.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\mean.m">mean</a></li></TD>
<TD>          Average or mean value.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\nan.m">nan</a></li></TD>
<TD>           Not-a-Number.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\ident\ident\@iddata\plot.m">plot</a></li></TD>
<TD>          Linear plot.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\plotyy.m">plotyy</a></li></TD>
<TD>        Graphs with y tick labels on the left and right.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="set is a built-in method">set</a></li></TD>
<TD>           Set object properties.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\std.m">std</a></li></TD>
<TD>           Standard deviation.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\title.m">title</a></li></TD>
<TD>         Graph title.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\graph2d\xlabel.m">xlabel</a></li></TD>
<TD>        X-axis label.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

</TABLE>

</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code"> [m, v ]=findmeancovar(V,grp)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [ax11, h11, h22  ]=<a name="_sub0" href="#_subfunctions" class="code">mdist2dstatplot</a>(V,H,phat,condon ,res)
002 <span class="comment">%MDIST2DSTATPLOT Computes and plots the conditional mean and standard deviation.</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL: mdist2dstatplot(x1,x2,phat,condon,res);</span>
005 <span class="comment">% </span>
006 <span class="comment">%       x1,x2 = data</span>
007 <span class="comment">%       phat  =  parameter structure array</span>
008 <span class="comment">%     condon  = 1 mean and standard deviation of X2 given X1</span>
009 <span class="comment">%               2 mean and standard deviation of X1 given X2 (default)</span>
010 <span class="comment">%       res   = resolution (default range(x2)/12)</span>
011 <span class="comment">% </span>
012 <span class="comment">% </span>
013 <span class="comment">%  MDIST2DSTATPLOT plots the  empirical conditional mean and standard deviation of</span>
014 <span class="comment">%  X1 given X2 or X2 given X1 and compares it with  theoretical quantities.</span>
015 <span class="comment">%</span>
016 <span class="comment">% Example:</span>
017 <span class="comment">%  x1=linspace(0,10)';</span>
018 <span class="comment">%  phat.x={1 2 2 };</span>
019 <span class="comment">%  phat.dist={'rayl','rayl'};</span>
020 <span class="comment">%  [y1,y2] = mdist2drnd(2000,phat);</span>
021 <span class="comment">%  mdist2dstatplot(y1,y2,phat,2); </span>
022 <span class="comment">% </span>
023 <span class="comment">%  See also  mdist2dstat</span>
024 
025 
026 <span class="comment">%  tested on: matlab 5.2</span>
027 <span class="comment">% history</span>
028 <span class="comment">% revised pab 03.11.2000</span>
029 <span class="comment">% changed var(tmp) to std(tmp)^2</span>
030 <span class="comment">% revised pab 8.11.1999</span>
031 <span class="comment">%  - updated header info</span>
032 <span class="comment">%  - changed phat from vector to structure</span>
033 <span class="comment">% by Per A. Brodtkorb 31.01.99</span>
034 
035 
036 error(nargchk(3,5,nargin))
037 
038 <span class="keyword">if</span> nargin &lt;4 |isempty(condon), condon =2; <span class="keyword">end</span>
039 
040 <span class="keyword">if</span> nargin&lt;5|isempty(res), 
041   <span class="keyword">if</span> condon==2,  
042    res=<a href="range.html" class="code" title="  Calculates the difference between the maximum and minimum values. ">range</a>(H(:))/12;
043   <span class="keyword">else</span>
044    res=<a href="range.html" class="code" title="  Calculates the difference between the maximum and minimum values. ">range</a>(V(:))/12;
045   <span class="keyword">end</span> 
046 <span class="keyword">end</span>
047 
048 
049 Nmesh=40;
050 <span class="keyword">if</span> condon==2,  
051    grp=floor(H/res)+1; <span class="comment">% dividing the data into groups </span>
052    Ngrp=max(grp);
053    cvar=linspace(eps, max(H), Nmesh)';
054    [m v ]=<a href="#_sub1" class="code" title="sub  [m, v ]=findmeancovar(V,grp)">findmeancovar</a>(V,grp); 
055 <span class="keyword">else</span>
056   grp=floor(V/res)+1; <span class="comment">% dividing the data into groups </span>
057   Ngrp=max(grp);
058   cvar=linspace(eps, max(V), Nmesh)';
059   [m v ]=<a href="#_sub1" class="code" title="sub  [m, v ]=findmeancovar(V,grp)">findmeancovar</a>(H,grp); 
060 <span class="keyword">end</span> 
061 
062 h1=linspace(res/2, (Ngrp-0.5)*res, Ngrp)'; 
063 [M1 V1]= <a href="mdist2dstat.html" class="code" title="  Mean and variance for the MDIST2D distribution. ">mdist2dstat</a>(phat,condon,cvar);
064   
065 
066 <span class="keyword">if</span> 0,
067  [ax1 h11 h22]=plotyy(h1,m,h1,sqrt(v));
068  set(ax1(1),<span class="string">'nextplot'</span>,<span class="string">'add'</span> );
069  set(h11, <span class="string">'LineStyle'</span> , <span class="string">'x'</span>)
070  axes(ax1(1));
071  plot(cvar,M1,<span class="string">'-'</span>),
072  set(ax1(1),<span class="string">'nextplot'</span>,<span class="string">'replace'</span> );
073 
074  set(ax1(2),<span class="string">'nextplot'</span>,<span class="string">'add'</span> );
075  set(h22, <span class="string">'LineStyle'</span> , <span class="string">'o'</span>)
076  axes(ax1(2));
077  <span class="comment">%axis([0 inf 0 max(v)])</span>
078 
079  plot(cvar,sqrt(V1),<span class="string">'-'</span>), 
080  set(ax1(2),<span class="string">'nextplot'</span>,<span class="string">'replace'</span> );
081 <span class="keyword">else</span>
082   plot(h1,m,<span class="string">'bo'</span>,h1,sqrt(v),<span class="string">'rx'</span>); hold on
083   plot(cvar,M1,<span class="string">'b-'</span>),
084    plot(cvar,sqrt(V1),<span class="string">'r--'</span>),hold off
085 <span class="keyword">end</span>
086 <span class="keyword">if</span> condon ==2
087   xlabel(<span class="string">'x2'</span>)
088 <span class="keyword">else</span>
089  xlabel(<span class="string">'x1'</span>)
090 <span class="keyword">end</span>
091  title(<span class="string">'Conditional mean and standard deviation'</span>)
092  <span class="keyword">if</span> nargout&gt;0
093    ax11=ax1;
094  <span class="keyword">end</span>
095 
096 
097 <span class="keyword">function</span> [m, v ]=<a name="_sub1" href="#_subfunctions" class="code">findmeancovar</a>(V,grp) 
098 
099 Ngrp=max(grp);
100 m=zeros(Ngrp,1);v=m;
101 <span class="keyword">for</span> ix=1:Ngrp,
102   tmp=V(grp==ix);<span class="comment">%find data in group number ix</span>
103   
104   <span class="keyword">if</span> length(tmp)&gt;max(4,0),<span class="comment">% if less than 4 observations in the group </span>
105     m(ix)=mean(tmp); <span class="comment">% mean of data in group ix</span>
106     v(ix)=std(tmp).^2;  <span class="comment">% variance of data in group ix</span>
107   <span class="keyword">else</span> 
108     m(ix)=NaN;
109     v(ix)=NaN;
110   <span class="keyword">end</span>
111 <span class="keyword">end</span>
112 <span class="keyword">return</span>
113</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>