<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of mdist2dfit</title>
  <meta name="keywords" content="mdist2dfit">
  <meta name="description" content=" Parameter estimates for MDIST2D data.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">wstats</a> &gt; mdist2dfit.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\wstats&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>mdist2dfit
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Parameter estimates for MDIST2D data.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> phato=mdist2dfit(V,H,dist,alpha,method) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">  <a href="mdist2dfit.html" class="code" title=" Parameter estimates for MDIST2D data. ">MDIST2DFIT</a> Parameter estimates for MDIST2D data. 
  
   CALL: Phat = <a href="mdist2dfit.html" class="code" title=" Parameter estimates for MDIST2D data. ">mdist2dfit</a>(x1,x2,dist,alpha,method) 
  
    phat = structure array containing 
           x      = cellarray of distribution parameters 
                    x{1} = Phat1 marginal parameters of x1 
                    x{2} = Phat2 marginal parameters of x2 
                    x{3} = Psi the interaction parameter between x1 and x2. 
           CI     = Confidence interval of distribution parameters 
           dist   = as explained below 
           alpha  = ------||---------- 
           method = ------||---------- 
           note   = Memorandum string 
           date   = date and time of creation  
  
  x1,x2  = input data 
  dist   = list of distributions used in the fitting of X1 and X2,  
           respectively. Options are 'tgumbel', 'gumbel',  
           'lognormal','rayleigh','weibull','gamma'. 
  alpha  = confidence level constant (If not given CI will not be computed) 
  method = fitting method used 'SML' or 'MML' (Simultainous or Marginal  
           Maximum Likelihood method) (default 'SML') 
  
  Example: 
   phat.x={1 2  2 }; 
   phat.dist={'rayl','rayl'}; 
   [R1,R2] = <a href="mdist2drnd.html" class="code" title="  Random points from a bivariate MDIST2D distribution ">mdist2drnd</a>(1000,phat); 
   Phat2 = <a href="mdist2dfit.html" class="code" title=" Parameter estimates for MDIST2D data. ">mdist2dfit</a>(R1,R2,{'weibull','rayleigh'},.05,'SML') 
   
  See also  <a href="mdist2drnd.html" class="code" title="  Random points from a bivariate MDIST2D distribution ">mdist2drnd</a>,  <a href="mdist2dpdf.html" class="code" title=" Joint 2D PDF due to Plackett given as  f{x1}*f{x2}*G(x1,x2;Psi). ">mdist2dpdf</a>, <a href="mdist2dcdf.html" class="code" title=" Joint 2D CDF due to Plackett ">mdist2dcdf</a>, mdist2dprb</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="mdist2dlike.html" class="code" title=" [LL, cov] = mdist2dlike(params,data1,data2,dist)">mdist2dlike</a></li></TD>
<TD> MDIST log-likelihood function.</TD>
</TR>
<TR>
<TD><li><a href="wgamfit.html" class="code" title=" [phat, cov,pci]=wgamfit(data1, plotflag);">wgamfit</a></li></TD>
<TD> Parameter estimates for Gamma data.</TD>
</TR>
<TR>
<TD><li><a href="wgumbfit.html" class="code" title=" [phat, cov,pci] = wgumbfit(data1, plotflag)">wgumbfit</a></li></TD>
<TD> Parameter estimates for Gumbel data.</TD>
</TR>
<TR>
<TD><li><a href="wnormfit.html" class="code" title=" [phat, var,ciL,ciU] = wnormfit(data,plotflag)">wnormfit</a></li></TD>
<TD> Parameter estimates for Normal data.</TD>
</TR>
<TR>
<TD><li><a href="wnorminv.html" class="code" title=" x = wnorminv(F,m,v)">wnorminv</a></li></TD>
<TD> Inverse of the Normal distribution function</TD>
</TR>
<TR>
<TD><li><a href="wraylfit.html" class="code" title=" [phat, var,pci] = wraylfit(data,plotflag)">wraylfit</a></li></TD>
<TD> Parameter estimates for Rayleigh data.</TD>
</TR>
<TR>
<TD><li><a href="wweibfit.html" class="code" title=" [phat, cov, pci]=wweibfit(data1, plotflag);">wweibfit</a></li></TD>
<TD> Parameter estimates for Weibull data.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datatypes\cell.m">cell</a></li></TD>
<TD>          Create cell array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\corrcoef.m">corrcoef</a></li></TD>
<TD>      Correlation coefficients.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\timefun\datestr.m">datestr</a></li></TD>
<TD>       String representation of date.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="">fmins</a></li></TD>
<TD></TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\funfun\fminsearch.m">fminsearch</a></li></TD>
<TD>    Multidimensional unconstrained nonlinear minimization (Nelder-Mead).</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\linspace.m">linspace</a></li></TD>
<TD>      Linearly spaced vector.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elmat\nan.m">nan</a></li></TD>
<TD>           Not-a-Number.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\timefun\now.m">now</a></li></TD>
<TD>           Current date and time as date number.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\str2num.m">str2num</a></li></TD>
<TD>       Convert string matrix to numeric array.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\local\version.m">version</a></li></TD>
<TD>       MATLAB version number.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

</TABLE>

</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code"> k=findPsi(rho)</a></li><li><a href="#_sub2" class="code"> r=getrho(psi)</a></li><li><a href="#_sub3" class="code"> [pvhat,pvci]=distfit(tmp,dist,method,alpha)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span>  phato=<a name="_sub0" href="#_subfunctions" class="code">mdist2dfit</a>(V,H,dist,alpha,method) 
002 <span class="comment">% MDIST2DFIT Parameter estimates for MDIST2D data. </span>
003 <span class="comment">% </span>
004 <span class="comment">%  CALL: Phat = mdist2dfit(x1,x2,dist,alpha,method) </span>
005 <span class="comment">% </span>
006 <span class="comment">%   phat = structure array containing </span>
007 <span class="comment">%          x      = cellarray of distribution parameters </span>
008 <span class="comment">%                   x{1} = Phat1 marginal parameters of x1 </span>
009 <span class="comment">%                   x{2} = Phat2 marginal parameters of x2 </span>
010 <span class="comment">%                   x{3} = Psi the interaction parameter between x1 and x2. </span>
011 <span class="comment">%          CI     = Confidence interval of distribution parameters </span>
012 <span class="comment">%          dist   = as explained below </span>
013 <span class="comment">%          alpha  = ------||---------- </span>
014 <span class="comment">%          method = ------||---------- </span>
015 <span class="comment">%          note   = Memorandum string </span>
016 <span class="comment">%          date   = date and time of creation  </span>
017 <span class="comment">% </span>
018 <span class="comment">% x1,x2  = input data </span>
019 <span class="comment">% dist   = list of distributions used in the fitting of X1 and X2,  </span>
020 <span class="comment">%          respectively. Options are 'tgumbel', 'gumbel',  </span>
021 <span class="comment">%          'lognormal','rayleigh','weibull','gamma'. </span>
022 <span class="comment">% alpha  = confidence level constant (If not given CI will not be computed) </span>
023 <span class="comment">% method = fitting method used 'SML' or 'MML' (Simultainous or Marginal  </span>
024 <span class="comment">%          Maximum Likelihood method) (default 'SML') </span>
025 <span class="comment">% </span>
026 <span class="comment">% Example: </span>
027 <span class="comment">%  phat.x={1 2  2 }; </span>
028 <span class="comment">%  phat.dist={'rayl','rayl'}; </span>
029 <span class="comment">%  [R1,R2] = mdist2drnd(1000,phat); </span>
030 <span class="comment">%  Phat2 = mdist2dfit(R1,R2,{'weibull','rayleigh'},.05,'SML') </span>
031 <span class="comment">%  </span>
032 <span class="comment">% See also  mdist2drnd,  mdist2dpdf, mdist2dcdf, mdist2dprb </span>
033  
034 <span class="comment">% References: </span>
035 <span class="comment">% Plackett, R. L. (1965) &quot;A class of bivariate distributions.&quot; </span>
036 <span class="comment">%                                J. Am. Stat. Assoc. 60. 516-22 </span>
037 <span class="comment">%      [1]  Michel K. Ochi, </span>
038 <span class="comment">%       OCEAN TECHNOLOGY series 6 </span>
039 <span class="comment">%      &quot;OCEAN WAVES, The stochastic approach&quot;, Cambridge </span>
040 <span class="comment">%      1998 p. 133-134. </span>
041  
042  
043 <span class="comment">%  tested on: matlab 5.2 </span>
044 <span class="comment">% history </span>
045 <span class="comment">% Revised pab nov2004 </span>
046 <span class="comment">%  -replaced fmins with fminsearch   </span>
047 <span class="comment">% revised pab Dec2003 </span>
048 <span class="comment">% revised pab 8.11.1999 </span>
049 <span class="comment">%  - updated header info </span>
050 <span class="comment">%  - changed phat from vector to structure </span>
051 <span class="comment">% Per A. Brodtkorb 29.01.1999 </span>
052  
053  
054 <span class="keyword">if</span> (nargin&lt; 3) 
055   error(<span class="string">'To few input arguments'</span>) 
056 <span class="keyword">end</span> 
057   CDIST=lower(dist{1}); 
058   UDIST=lower(dist{2}); 
059  
060 <span class="keyword">if</span> (nargin&lt;5)|isempty(method) 
061   method=<span class="string">'SML'</span>; <span class="comment">% options MML, MOM or SML (simultaneous maximum likelihood) </span>
062  ;<span class="comment">% marginal maximum likelihood  </span>
063 <span class="keyword">end</span> 
064 <span class="keyword">if</span> (nargin &lt; 4)|isempty(alpha) 
065     alpha = []; 
066 <span class="keyword">else</span> 
067   p_int = [alpha/2; 1-alpha/2]; 
068 <span class="keyword">end</span> 
069 V = V(:); 
070 H = H(:); 
071 [n, m] = size(V); 
072 [n2, m2] = size(H); 
073 <span class="keyword">if</span> n~=n2 
074   error(<span class="string">'V and H  must have equal size'</span>) 
075 <span class="keyword">end</span> 
076  
077 [ ph, phci]=<a href="#_sub3" class="code" title="sub  [pvhat,pvci]=distfit(tmp,dist,method,alpha)">distfit</a>(H,UDIST,method,alpha); 
078 [ pv,  pvci]=<a href="#_sub3" class="code" title="sub  [pvhat,pvci]=distfit(tmp,dist,method,alpha)">distfit</a>(V,CDIST,method,alpha); 
079  
080 rho= corrcoef(V,H); 
081 rho=rho(2,1); 
082 psi=<a href="#_sub1" class="code" title="sub  k=findPsi(rho)">findPsi</a>(rho);   
083 phat=[pv ph psi ]; 
084 phatCI=[pvci phci]; 
085 <span class="keyword">switch</span> lower(method(1:3)), 
086   <span class="keyword">case</span> <span class="string">'sml'</span>, <span class="comment">%simultaneous MLE </span>
087    pinit=phat; 
088    mvrs=version;ix=find(mvrs==<span class="string">'.'</span>); 
089    <span class="keyword">if</span> str2num(mvrs(1:ix(2)-1))&gt;5.2, 
090      phat = fminsearch(<span class="string">'mdist2dlike'</span>,pinit,[],V,H,dist); 
091    <span class="keyword">else</span> 
092      phat = fmins(<span class="string">'mdist2dlike'</span>,pinit,[],[],V,H,dist); 
093    <span class="keyword">end</span> 
094   <span class="keyword">case</span> <span class="string">'mml'</span>,<span class="comment">% marginal MLE is already found </span>
095       
096 <span class="keyword">end</span> 
097  
098 <span class="keyword">if</span> ~isempty(alpha) <span class="comment">%  </span>
099    [logL,cov]=<a href="mdist2dlike.html" class="code" title=" MDIST log-likelihood function.">mdist2dlike</a>(phat,V,H,dist); 
100    sa = diag(cov)'; 
101    phatCI = <a href="wnorminv.html" class="code" title=" Inverse of the Normal distribution function ">wnorminv</a>(repmat(p_int,1,length(phat)),[phat; phat],[sa;sa]); 
102  <span class="keyword">end</span> 
103  phato.x=cell(2,1); 
104 phato.CI=cell(1,1); 
105 n1=length(pv); 
106 [phato.x{1}]=phat(1:n1); 
107 [phato.x{2}]=phat(n1+1:<span class="keyword">end</span>-1); 
108 [phato.x{3}]=phat(<span class="keyword">end</span>); 
109  
110 [phato.CI{1}]=phatCI; 
111 phato.dist=dist; 
112 phato.alpha=alpha; 
113 phato.method=method; 
114 phato.note=[]; 
115 phato.date=datestr(now); 
116  
117 <span class="keyword">function</span> k=<a name="_sub1" href="#_subfunctions" class="code">findPsi</a>(rho) 
118   <span class="comment">% finds psi by a simple iteration scheme  </span>
119   rtol=1e-6; <span class="comment">%relativ tolerance </span>
120   <span class="keyword">switch</span> rho 
121   <span class="keyword">case</span> 0,  k=1; <span class="keyword">return</span> 
122   <span class="keyword">case</span> 1, k=inf;<span class="keyword">return</span> 
123   <span class="keyword">case</span> -1, k=0; <span class="keyword">return</span> 
124   <span class="keyword">otherwise</span>,  
125     <span class="keyword">if</span> rho&lt;0, 
126       kold=0.5; 
127     <span class="keyword">else</span> 
128      kold=4; 
129     <span class="keyword">end</span> 
130   <span class="keyword">end</span> 
131   kold2=kold-0.001; 
132   rho2=<a href="#_sub2" class="code" title="sub  r=getrho(psi)">getrho</a>(kold2); 
133   <span class="keyword">for</span> ix=1:500, 
134     rho1=<a href="#_sub2" class="code" title="sub  r=getrho(psi)">getrho</a>(kold); 
135     k=kold-(rho1-rho).*(kold-kold2)./( rho1-rho2); 
136    <span class="comment">%    disp(['k=' num2str(k) ]), pause </span>
137     <span class="keyword">if</span> abs(kold-k)&lt;abs(rtol.*k),<span class="keyword">break</span> 
138     <span class="keyword">elseif</span> k&lt;=0, k=linspace(0,20,1000); 
139       [tmp I]=min(abs(<a href="#_sub2" class="code" title="sub  r=getrho(psi)">getrho</a>(k)-rho)); <span class="comment">%linear search </span>
140       k=k(I); 
141       <span class="keyword">break</span>; 
142     <span class="keyword">end</span> 
143     kold=k; 
144     <span class="keyword">if</span> ix&gt;=500, disp(<span class="string">'could not find k'</span>),<span class="keyword">end</span> 
145   <span class="keyword">end</span> 
146   <span class="keyword">return</span> 
147  
148 <span class="keyword">function</span> r=<a name="_sub2" href="#_subfunctions" class="code">getrho</a>(psi) 
149 r=zeros(size(psi)); 
150 k1=find(psi==0); 
151 <span class="keyword">if</span> any(k1), 
152  r(k)=-1; 
153 <span class="keyword">end</span> 
154 k3=find((psi&lt;1.*psi&gt;0)|psi&gt;1); 
155 <span class="keyword">if</span> any(k3), 
156  r(k3)=(psi(k3).^2-1-2.*psi(k3).*log(psi(k3)))./((psi(k3)-1).^2) ; 
157 <span class="keyword">end</span> 
158 <span class="keyword">return</span> 
159  
160 <span class="keyword">function</span> [pvhat,pvci]=<a name="_sub3" href="#_subfunctions" class="code">distfit</a>(tmp,dist,method,alpha) 
161    
162   <span class="keyword">if</span> strcmp(lower(method(2:3)),<span class="string">'ml'</span>), 
163     <span class="keyword">switch</span> lower(dist(1:2)), 
164       <span class="keyword">case</span> <span class="string">'ra'</span>, [pvhat tmp2] = <a href="wraylfit.html" class="code" title=" Parameter estimates for Rayleigh data.">wraylfit</a>(tmp,0) ; 
165       <span class="keyword">case</span> <span class="string">'tg'</span>, [pvhat tmp2] = <a href="wgumbfit.html" class="code" title=" Parameter estimates for Gumbel data.">wgumbfit</a>(tmp,0); 
166       <span class="keyword">case</span> <span class="string">'gu'</span>, [pvhat tmp2] = <a href="wgumbfit.html" class="code" title=" Parameter estimates for Gumbel data.">wgumbfit</a>(tmp,0); 
167       <span class="keyword">case</span> <span class="string">'lo'</span>, [pvhat tmp2] = <a href="wnormfit.html" class="code" title=" Parameter estimates for Normal data.">wnormfit</a>(log(tmp),0); 
168       <span class="keyword">case</span> <span class="string">'ga'</span>, [pvhat tmp2] = <a href="wgamfit.html" class="code" title=" Parameter estimates for Gamma data. ">wgamfit</a>(tmp,0); 
169       <span class="keyword">case</span> <span class="string">'we'</span>, [pvhat tmp2] = <a href="wweibfit.html" class="code" title=" Parameter estimates for Weibull data. ">wweibfit</a>(tmp,0); 
170       <span class="keyword">otherwise</span>, error(<span class="string">'Unknown distribution'</span>) 
171     <span class="keyword">end</span> 
172     <span class="keyword">if</span> prod(size(tmp2))~=length(tmp2); 
173       sa=diag(tmp2)'; 
174     <span class="keyword">else</span> 
175       sa = tmp2(:)'; 
176     <span class="keyword">end</span> 
177     p_int=[alpha/2; 1-alpha/2]; 
178     pvci = <a href="wnorminv.html" class="code" title=" Inverse of the Normal distribution function ">wnorminv</a>(repmat(p_int,1,length(pvhat)),[pvhat; pvhat],[sa;sa]); 
179   <span class="keyword">else</span>  <span class="comment">% MOM fit </span>
180     pvci=NaN; 
181     error(<span class="string">'MOM is not implemented for any distribution'</span>)     
182     <span class="keyword">switch</span> dist(1:2) 
183       <span class="keyword">case</span> {<span class="string">'tg'</span>,<span class="string">'gu'</span>} ,   
184       <span class="keyword">case</span> <span class="string">'we'</span>,  
185       <span class="keyword">case</span> <span class="string">'lo'</span>,  
186       <span class="keyword">case</span> <span class="string">'ga'</span>, error(<span class="string">'MOM is not implemented for Gamma distribution'</span>)      
187       <span class="keyword">case</span> <span class="string">'ra'</span>, error(<span class="string">'MOM is not implemented for Rayleigh distribution'</span>)      
188       <span class="keyword">otherwise</span> , error(<span class="string">'Unknown distribution'</span>) 
189     <span class="keyword">end</span> 
190   <span class="keyword">end</span> 
191   <span class="keyword">return</span> 
192  
193</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>