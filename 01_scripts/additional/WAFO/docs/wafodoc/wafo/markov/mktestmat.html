<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of mktestmat</title>
  <meta name="keywords" content="mktestmat">
  <meta name="description" content="   Makes test matrices for min-max (and max-min) matrices.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">markov</a> &gt; mktestmat.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\markov&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>mktestmat
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>   Makes test matrices for min-max (and max-min) matrices.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [F,Fh] = mktestmat(param,x0,s,lam,NOsubzero) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="mktestmat.html" class="code" title="   Makes test matrices for min-max (and max-min) matrices. ">MKTESTMAT</a>   Makes test matrices for min-max (and max-min) matrices. 
  
  CALL: [F,Fh] = <a href="mktestmat.html" class="code" title="   Makes test matrices for min-max (and max-min) matrices. ">mktestmat</a>(param,x0,s,lam,NOsubzero) 
  
  Input: 
    param  = Parameter vector, [a b n], defines discretization. 
    x0     = Center of ellipse. [min Max]             [1x2] 
    s      = Standard deviation. (0&lt;s&lt;infinity)       [1x1] 
    lam    = Orientation of ellipse. (0&lt;lam&lt;infinity) [1x1] 
             lam=1 gives circles. 
    NOsubzero = Number of subdiagonals that are set to zero 
                (-Inf: no subdiagonals that are set to zero) 
                (Optional, Default = 0, only the diagonal is zero) 
  
  Output: 
    F      = min-max matrix.                          [nxn] 
    Fh     = max-min matrix.                          [nxn] 
  
  Makes a Normal kernel (Iso-lines are ellipses). 
  Each element in F =(F(i,j)) is 
    F(i,j) = exp(-1/2*(x-x0)*inv(S)*(x-x0)'); 
  where 
    S = 1/2*s^2*[lam^2+1 lam^2-1; lam^2-1 lam^2+1] 
  
  The matrix Fh is obtained by assuming a time-reversible process. 
  These matrices can be used for testing. 
  
  Example: 
    [F,Fh] = <a href="mktestmat.html" class="code" title="   Makes test matrices for min-max (and max-min) matrices. ">mktestmat</a>([-1 1 32],[-0.2 0.2], 0.25,1/2); 
    u=<a href="../../wafo/misc/levels.html" class="code" title=" Calculates discrete levels given the parameter matrix.">levels</a>([-1 1 32]); <a href="../../wafo/cycles/cmatplot.html" class="code" title=" Plots a cycle matrix, e.g. a rainflow matrix.">cmatplot</a>(u,u,F,3), axis('square') 
    [F,Fh] = <a href="mktestmat.html" class="code" title="   Makes test matrices for min-max (and max-min) matrices. ">mktestmat</a>([-1 1 32],[-0.2 0.2], 0.25,1/2,-Inf);</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/misc/levels.html" class="code" title=" l=levels(param)">levels</a></li></TD>
<TD> Calculates discrete levels given the parameter matrix.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\matfun\@single\inv.bi">inv</a></li></TD>
<TD>           Matrix inverse.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter4.html" class="code" title="This is a script file.">Chapter4</a></li></TD>
<TD> % CHAPTER4 contains the commands used in Chapter 4 of the tutorial</TD>
</TR>
<TR>
<TD><li><a href="f_funm.html" class="code" title=" [F,Fh] = f_funm(param,M)">f_funm</a></li></TD>
<TD>  Calculate min-max matrix for Model-structure.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wdemos/itmkurs/itmkurs_lab2.html" class="code" title="This is a script file.">itmkurs_lab2</a></li></TD>
<TD> Script to computer exercises 2</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wdemos/rfcdemo2.html" class="code" title=" [F_RFC] = refdemo2(demoNr,P,param,x0,s,lam)">rfcdemo2</a></li></TD>
<TD> Rainflow matrix for Switching Markov Chains of Turning Points.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/cycles/test/test_cycles.html" class="code" title="This is a script file.">test_cycles</a></li></TD>
<TD> Quick test of the routines in module 'cycles'</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/markov/test/test_markov.html" class="code" title="This is a script file.">test_markov</a></li></TD>
<TD> Quick test of the routines in module 'markov'</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [F,Fh] = <a name="_sub0" href="#_subfunctions" class="code">mktestmat</a>(param,x0,s,lam,NOsubzero) 
002 <span class="comment">%MKTESTMAT   Makes test matrices for min-max (and max-min) matrices. </span>
003 <span class="comment">% </span>
004 <span class="comment">% CALL: [F,Fh] = mktestmat(param,x0,s,lam,NOsubzero) </span>
005 <span class="comment">% </span>
006 <span class="comment">% Input: </span>
007 <span class="comment">%   param  = Parameter vector, [a b n], defines discretization. </span>
008 <span class="comment">%   x0     = Center of ellipse. [min Max]             [1x2] </span>
009 <span class="comment">%   s      = Standard deviation. (0&lt;s&lt;infinity)       [1x1] </span>
010 <span class="comment">%   lam    = Orientation of ellipse. (0&lt;lam&lt;infinity) [1x1] </span>
011 <span class="comment">%            lam=1 gives circles. </span>
012 <span class="comment">%   NOsubzero = Number of subdiagonals that are set to zero </span>
013 <span class="comment">%               (-Inf: no subdiagonals that are set to zero) </span>
014 <span class="comment">%               (Optional, Default = 0, only the diagonal is zero) </span>
015 <span class="comment">% </span>
016 <span class="comment">% Output: </span>
017 <span class="comment">%   F      = min-max matrix.                          [nxn] </span>
018 <span class="comment">%   Fh     = max-min matrix.                          [nxn] </span>
019 <span class="comment">% </span>
020 <span class="comment">% Makes a Normal kernel (Iso-lines are ellipses). </span>
021 <span class="comment">% Each element in F =(F(i,j)) is </span>
022 <span class="comment">%   F(i,j) = exp(-1/2*(x-x0)*inv(S)*(x-x0)'); </span>
023 <span class="comment">% where </span>
024 <span class="comment">%   S = 1/2*s^2*[lam^2+1 lam^2-1; lam^2-1 lam^2+1] </span>
025 <span class="comment">% </span>
026 <span class="comment">% The matrix Fh is obtained by assuming a time-reversible process. </span>
027 <span class="comment">% These matrices can be used for testing. </span>
028 <span class="comment">% </span>
029 <span class="comment">% Example: </span>
030 <span class="comment">%   [F,Fh] = mktestmat([-1 1 32],[-0.2 0.2], 0.25,1/2); </span>
031 <span class="comment">%   u=levels([-1 1 32]); cmatplot(u,u,F,3), axis('square') </span>
032 <span class="comment">%   [F,Fh] = mktestmat([-1 1 32],[-0.2 0.2], 0.25,1/2,-Inf); </span>
033  
034 <span class="comment">% Tested  on Matlab  5.3 </span>
035 <span class="comment">% </span>
036 <span class="comment">% History: </span>
037 <span class="comment">% Revised by PJ  23-Nov-1999 </span>
038 <span class="comment">%   updated for WAFO </span>
039 <span class="comment">% Created by PJ (Pär Johannesson) 1997 </span>
040 <span class="comment">%   Copyright (c) 1997 by Pär Johannesson </span>
041 <span class="comment">%   Toolbox: Rainflow Cycles for Switching Processes V.1.0, 2-Oct-1997 </span>
042  
043  
044 <span class="comment">% Check input arguments </span>
045  
046 ni = nargin; 
047 no = nargout; 
048 error(nargchk(0,5,ni)); 
049  
050 <span class="keyword">if</span> ni&lt;1, param = []; <span class="keyword">end</span> 
051 <span class="keyword">if</span> ni&lt;2, x0 = []; <span class="keyword">end</span> 
052 <span class="keyword">if</span> ni&lt;3, s = []; <span class="keyword">end</span> 
053 <span class="keyword">if</span> ni&lt;4, lam = []; <span class="keyword">end</span> 
054 <span class="keyword">if</span> ni&lt;5, NOsubzero=[]; <span class="keyword">end</span> 
055  
056 <span class="keyword">if</span> isempty(param), param = [-1 1 32]; <span class="keyword">end</span> 
057 <span class="keyword">if</span> isempty(x0), x0 = [1 1]*(param(2)+param(1))/2; <span class="keyword">end</span> 
058 <span class="keyword">if</span> isempty(s), s = (param(2)-param(1))/4; <span class="keyword">end</span> 
059 <span class="keyword">if</span> isempty(lam), lam = 1; <span class="keyword">end</span> 
060 <span class="keyword">if</span> isempty(NOsubzero), NOsubzero=0;<span class="keyword">end</span> 
061  
062 <span class="keyword">if</span> isinf(NOsubzero), NOsubzero=-(param(3)+1); <span class="keyword">end</span> 
063    
064 u = <a href="../../wafo/misc/levels.html" class="code" title=" Calculates discrete levels given the parameter matrix.">levels</a>(param); 
065 n = param(3); 
066  
067 <span class="comment">% F - min-Max matrix </span>
068  
069 F=zeros(n,n); 
070 S = 1/2*s^2*[lam^2+1 lam^2-1; lam^2-1 lam^2+1]; 
071  
072 <span class="keyword">for</span> i = 1:min(n-1-NOsubzero,n) 
073   <span class="keyword">for</span> j=max(i+1+NOsubzero,1):n 
074     x = [u(i) u(j)]; 
075     F(i,j) = exp(-1/2*(x-x0)*inv(S)*(x-x0)'); 
076   <span class="keyword">end</span> 
077 <span class="keyword">end</span> 
078  
079 <span class="comment">% Fh - Max-min matrix </span>
080 <span class="keyword">if</span> no&gt;1 
081   Fh = F';   <span class="comment">% Time-reversible </span>
082 <span class="keyword">end</span> 
083  
084  
085  
086  
087</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>