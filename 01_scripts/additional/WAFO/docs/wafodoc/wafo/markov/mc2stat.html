<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of mc2stat</title>
  <meta name="keywords" content="mc2stat">
  <meta name="description" content="  Calculates the stationary distribution for a Markov chain.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">markov</a> &gt; mc2stat.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\markov&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>mc2stat
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>  Calculates the stationary distribution for a Markov chain.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> [ro,PP]=mc2stat(P) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">  <a href="mc2stat.html" class="code" title="  Calculates the stationary distribution for a Markov chain.">MC2STAT</a>  Calculates the stationary distribution for a Markov chain.
 
  CALL: ro = <a href="mc2stat.html" class="code" title="  Calculates the stationary distribution for a Markov chain.">mc2stat</a>(P);
 
  ro = Stationary distribution.   [1xr]
 
  P  = transition matrix.         [rxr]
 
  Example: 
    F = magic(5)
    P = <a href="mat2tmat.html" class="code" title="  Converts a matrix to a transition matrix.">mat2tmat</a>(F)
    ro = <a href="mc2stat.html" class="code" title="  Calculates the stationary distribution for a Markov chain.">mc2stat</a>(P)
 
  See also  <a href="mat2tmat.html" class="code" title="  Converts a matrix to a transition matrix.">mat2tmat</a>, mc2reverse, smc2stat, <a href="mctp2stat.html" class="code" title="  Calculates the stationary distribution for a MCTP. ">mctp2stat</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\num2str.m">num2str</a></li></TD>
<TD>       Convert number to string. (Fast version)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\warning.m">warning</a></li></TD>
<TD>       Display warning message; disable or enable warning messages.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/wdemos/itmkurs/itmkurs_lab2.html" class="code" title="This is a script file.">itmkurs_lab2</a></li></TD>
<TD> Script to computer exercises 2</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wdemos/itmkurs/itmkurs_lab4.html" class="code" title="This is a script file.">itmkurs_lab4</a></li></TD>
<TD> Script to computer exercises 4</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wsim/mcsim.html" class="code" title=" x=mcsim(P,T,x0)">mcsim</a></li></TD>
<TD>   Simulates a Markov chain.</TD>
</TR>
<TR>
<TD><li><a href="mctp2arfm.html" class="code" title=" [F_rfc,FF,FFr,T] = mctp2arfm(F,c_m)">mctp2arfm</a></li></TD>
<TD>  Calculates asymmetric rainflow matrix for a MCTP.</TD>
</TR>
<TR>
<TD><li><a href="mctp2stat.html" class="code" title=" [ro_min,ro_max,QQ]=mctp2stat(Q)">mctp2stat</a></li></TD>
<TD>  Calculates the stationary distribution for a MCTP.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wdemos/rfcdemo1.html" class="code" title=" [F_RFC] = refdemo1(demoNr,P,A,m,s2,param)">rfcdemo1</a></li></TD>
<TD>  Demo for switching AR(1)-processes.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wdemos/rfcdemo2.html" class="code" title=" [F_RFC] = refdemo2(demoNr,P,param,x0,s,lam)">rfcdemo2</a></li></TD>
<TD> Rainflow matrix for Switching Markov Chains of Turning Points.</TD>
</TR>
<TR>
<TD><li><a href="smc2rfm.html" class="code" title=" [F_rfc,mu_rfc] = smc2rfc(P,Qc,def)">smc2rfm</a></li></TD>
<TD> Calculates the rainflow matrix/intensity for a switching Markov chain.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wsim/smcsim.html" class="code" title=" [x,z] = simsmc(P,Qc,T,init);">smcsim</a></li></TD>
<TD>  Simulates a Switching Markov chain with state space.</TD>
</TR>
<TR>
<TD><li><a href="smctp2arfm.html" class="code" title=" [F_rfc,F_rfc_z,T] = smctp2arfm(P,F,c_m,SideInfo)">smctp2arfm</a></li></TD>
<TD>  Calculates the asymmetric rainflow matrix for a SMCTP.</TD>
</TR>
<TR>
<TD><li><a href="smctp2rfm.html" class="code" title=" [F_rfc,mu_rfc,T] = smctp2rfm(P,F,c_m)">smctp2rfm</a></li></TD>
<TD>  Calculates the rainflow matrix for a SMCTP.</TD>
</TR>
<TR>
<TD><li><a href="smctp2stat.html" class="code" title=" [ro,ro_min,ro_max,Ro_min,Ro_max,QQ] = mctp2stat(P,F)">smctp2stat</a></li></TD>
<TD>  Stationary distributions for a switching MCTP.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/wsim/smctpsim.html" class="code" title=" [x,z,TT] = smctpsim(P,F,T,init,whatOut)">smctpsim</a></li></TD>
<TD>  Simulates a switching Markov chain of turning points,</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/markov/test/test_markov.html" class="code" title="This is a script file.">test_markov</a></li></TD>
<TD> Quick test of the routines in module 'markov'</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> [ro,PP]=<a name="_sub0" href="#_subfunctions" class="code">mc2stat</a>(P)
002 <span class="comment">% MC2STAT  Calculates the stationary distribution for a Markov chain.</span>
003 <span class="comment">%</span>
004 <span class="comment">% CALL: ro = mc2stat(P);</span>
005 <span class="comment">%</span>
006 <span class="comment">% ro = Stationary distribution.   [1xr]</span>
007 <span class="comment">%</span>
008 <span class="comment">% P  = transition matrix.         [rxr]</span>
009 <span class="comment">%</span>
010 <span class="comment">% Example: </span>
011 <span class="comment">%   F = magic(5)</span>
012 <span class="comment">%   P = mat2tmat(F)</span>
013 <span class="comment">%   ro = mc2stat(P)</span>
014 <span class="comment">%</span>
015 <span class="comment">% See also  mat2tmat, mc2reverse, smc2stat, mctp2stat</span>
016   
017 <span class="comment">% Tested  on Matlab  5.3</span>
018 <span class="comment">%</span>
019 <span class="comment">% History:</span>
020 <span class="comment">% Revised by PJ  23-Nov-1999</span>
021 <span class="comment">%   updated for WAFO</span>
022 <span class="comment">% Created by PJ (Pär Johannesson) 1998</span>
023 <span class="comment">%   from 'Toolbox: Rainflow Cycles for Switching Processes V.1.0'</span>
024 <span class="comment">%   previous name: 'statf_mc'</span>
025 
026 <span class="comment">% Check input arguments</span>
027 
028 ni = nargin;
029 no = nargout;
030 error(nargchk(1,1,ni));
031 
032 n=length(P); <span class="comment">% number of states</span>
033 
034 PP=P;
035 
036 <span class="comment">% Set negative elements to zero</span>
037 [I,J] = find(PP&lt;0);
038 <span class="keyword">if</span> length(I) ~= 0
039   warning([<span class="string">'Warning: Negative elements in P. Setting to zero!'</span>]);
040   <span class="keyword">for</span> k = 1:length(I)
041     PP(I(k),J(k)) = 0;
042   <span class="keyword">end</span>
043 <span class="keyword">end</span>
044 
045 J =[];
046 NoDeleted = 0; NoDeleted0 = -1; 
047 <span class="keyword">while</span> NoDeleted ~= NoDeleted0
048 
049   <span class="comment">% Check that the rowsums of PP are equal to 1</span>
050 
051   sumPP = sum(PP');
052   <span class="keyword">if</span> sum(abs(sumPP-1) &lt;= n*eps) ~= length(PP)  <span class="comment">% Number of rowsums equal to 1</span>
053     warning([<span class="string">'Warning: Rowsums of P not equal to 1. Renormalizing!'</span>]);
054     <span class="keyword">for</span> i = 1:length(PP)
055       <span class="keyword">if</span> sumPP(i) == 0
056         <span class="keyword">if</span> isempty( find(J==i) )  <span class="comment">% Not allready deleted</span>
057           warning([<span class="string">'Warning: Rowsum '</span> num2str(i) <span class="string">' of P equals zero. Deleting state '</span> num2str(i) <span class="string">'!'</span>]);
058           J = [J i];
059           PP(:,i) = zeros(n,1);
060         <span class="keyword">end</span>
061       <span class="keyword">else</span>
062         PP(i,:) = PP(i,:)/sumPP(i);
063       <span class="keyword">end</span>
064     <span class="keyword">end</span>
065   <span class="keyword">end</span>
066 
067   NoDeleted0 = NoDeleted;
068   NoDeleted = length(J);
069 
070 <span class="keyword">end</span>
071 
072 I=1:n; I(J)=[]; 
073 P1 = PP(I,I);  <span class="comment">% Delete states</span>
074 
075 
076 <span class="comment">% Compute stationary distribution</span>
077 
078 r=size(P1,1);
079 P1=P1';
080 M=[eye(r-1) zeros(r-1,1)];
081 P1=P1(1:r-1,:);
082 P1=P1-M;
083 P1=[P1 ; ones(1,r)];
084 a=[zeros(r-1,1); 1];
085 roP1=P1\a;
086 <span class="comment">%roP1=pinv(P1)*a;</span>
087 roP1=roP1';
088 
089 <span class="comment">% Set ro(i)=0 for 'singular states'</span>
090 
091 ro = zeros(1,n);
092 ro(I)=roP1;
093 
094</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>