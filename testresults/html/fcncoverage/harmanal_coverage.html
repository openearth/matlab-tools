<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Function details for harmanal</title>
<link type="text/css" href="script/css/jquery-ui-1.7.2.custom.css" rel="stylesheet" />
<link type="text/css" href="script/css/FunctionCoverage.css" rel="stylesheet" />
<script type="text/javascript" src="script/js/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="script/js/jquery-ui-1.7.2.custom.min.js"></script>
<script type="text/javascript" src="script/js/matlab2accordion.js"></script>
</head>
<body>
<h2 class="ui-widget-header ui-state-active ui-corner-all">harmanal</h2>
<div class="ui-widget-content ui-corner-all">
<strong>Coverage results</strong><br/>
<table border=0 cellspacing=0 cellpadding=6>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td>
<td class="td-linebottomrt">458</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td>
<td class="td-linebottomrt">230</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td>
<td class="td-linebottomrt">228</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td>
<td class="td-linebottomrt">82</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td>
<td class="td-linebottomrt">146</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td>
<td class="td-linebottomrt">35.96 %</td></tr>
</table>
</div><br/>
<div class="ui-widget-content ui-corner-all">
<strong>Function listing</strong><br/>
<pre>
<span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span> <span style="font-weight: bold; text-decoration: none">line</span><br/>
               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [varargout] = harmanal(t,h,varargin);</span>
               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%HARMANAL  harmonic analysis of timeseries</span>
               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%  FIT     = harmanal(t,signal,&lt;keyword,value&gt;)</span>
               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%  [Ai,Bi] = harmanal(t,signal,&lt;keyword,value&gt;)</span>
               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%  performs a harmonic analysis on IRREGULARLY </span>
               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%  spaced, scalar time series signal h according to :</span>
               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%                __</span>
               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%    h(t) = b0 + \ [Ai*cos(wi*t) + Bi*sin(wi*t)]</span>
               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%                /_ i</span>
               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%                __</span>
               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%    h(t) = b0 + \ [Hi*cos(wi*t - phi_i)]</span>
               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%                /_ i</span>
               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">% where t contains the times at which data points are available.</span>
               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%   Note: the units in which t is specified should be seconds</span>
               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%   Note: when using the matlab datenum convention for dates, </span>
               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%   which is in days, make sure that you make seconds from</span>
               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%   t when you pass it to this function by multiplying it with </span>
               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%   with 24*3600. (all data are in SI units, i.e. seconds for time).</span>
               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">% where h is the signal to be analysed.</span>
               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">% where  coef'        contains [bo   A1     B1    ...      An     Bn   ]</span>
               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%        ampltitudes' contains [sqrt(A1^2 + B1^2) ... sqrt(An^2 + Bn^2)]</span>
               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%        phases'      contains [atan(B1/A1)       ... atan(Bn/An)      ] in radians</span>
               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">% The following &lt;keyword,value&gt; pairs are implemented, of which</span>
               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">% one of [T,omega,freq&lt;ency&gt;] is required:</span>
               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%     * omega           angular velocity         (one of 3 is required)</span>
               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%     * T               period                   (one of 3 is ,,)</span>
               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%     * freq            frequency                (one of 3 is ,,)</span>
               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%     * parameter       name of harmonically reconstructed time series (default 'hfit')</span>
               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%     * names           name of component        (optional for output)</span>
               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%     * plotspectrum    whether to plot spectrum (default 0)</span>
               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%     * plottimeseries  whether to plot spectrum (default 0)</span>
               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%     * plotM           whether to plot spectrum (default 0)</span>
               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%     * screenoutput    whether to plot spectrum (default 1)</span>
               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%     * errors          whether to plot spectrum (default 1)</span>
               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">% For proper workings of the inversion matrix, t and h should </span>
               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">% have size [1 length(h)]. If not, internally the matrices are </span>
               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">% transposed. The resulting hfit is returned with the size of h </span>
               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">% (to be able to calculate h - hfit easily).</span>
               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">% See also: T_TIDE, FFT_ANAL, FFT_FILTER, TIDEANAL</span>
               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">%   --------------------------------------------------------------------</span>
               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">%   Copyright (C) 2004-2009 Delft University of Technology</span>
               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%       Gerben J. de Boer</span>
               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%       g.j.deboer@tudelft.nl	</span>
               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%       Fluid Mechanics Section</span>
               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">%       Faculty of Civil Engineering and Geosciences</span>
               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">%       PO Box 5048</span>
               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">%       2600 GA Delft</span>
               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%       The Netherlands</span>
               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">%   This library is free software: you can redistribute it and/or</span>
               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">%   modify it under the terms of the GNU Lesser General Public</span>
               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">%   License as published by the Free Software Foundation, either</span>
               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">%   version 2.1 of the License, or (at your option) any later version.</span>
               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">%   This library is distributed in the hope that it will be useful,</span>
               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;">%   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;">%   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;">%   Lesser General Public License for more details.</span>
               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">%   You should have received a copy of the GNU Lesser General Public</span>
               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;">%   License along with this library. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;">%   --------------------------------------------------------------------</span>
               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;">% TO DO: file output to some international standard</span>
               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;">%% input</span>
               <span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF;"></span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  77</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.plotspectrum     = 0; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  78</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.plottimeseries   = 0; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  79</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.plotM            = 0; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  80</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.screenoutput     = 1; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  81</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.errors           = 1; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  82</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.parameter        = 'hfit'; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  83</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.freq             = [];  </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  84</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.omega            = [];  </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  85</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.names            = [];  </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  86</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT.T                = []; </span>
               <span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  88</a></span> <span style="color: #000000; background: #E0E0FF;">   if nargin&gt;3 </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  89</a></span> <span style="color: #000000; background: #E0E0FF;">      nextarg = 1; </span>
               <span style="color: #A0A0A0">  90</span> <span style="color: #228B22; background: #FFFFFF;">   else</span>
               <span style="color: #A0A0A0">  91</span> <span style="color: #A0A0A0; background: #FFFFFF;">      error('at least one &lt;keyword,value&gt; pair required: tide/frequency/period')</span>
               <span style="color: #A0A0A0">  92</span> <span style="color: #A0A0A0; background: #FFFFFF;">   end</span>
               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  94</a></span> <span style="color: #000000; background: #E0E0FF;">   OPT = setProperty(OPT,varargin{nextarg:end}); </span>
               <span style="color: #A0A0A0">  95</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  96</span> <span style="color: #228B22; background: #FFFFFF;">%% Add and reformat (optional) fieldnames</span>
               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;"></span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  98</a></span> <span style="color: #000000; background: #E0E0FF;">   if isempty(OPT.omega); </span>
               <span style="color: #A0A0A0">  99</span> <span style="color: #A0A0A0; background: #FFFFFF;">      if     ~isempty(OPT.freq );OPT.omega = 2.*pi.*OPT.freq;</span>
               <span style="color: #A0A0A0"> 100</span> <span style="color: #A0A0A0; background: #FFFFFF;">      elseif ~isempty(OPT.T    );OPT.omega = 2.*pi./OPT.T;</span>
               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;">      else</span>
               <span style="color: #A0A0A0"> 102</span> <span style="color: #A0A0A0; background: #FFFFFF;">         error(' give either period, frequency or omega')</span>
               <span style="color: #A0A0A0"> 103</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
               <span style="color: #A0A0A0"> 104</span> <span style="color: #A0A0A0; background: #FFFFFF;">   end</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 105</a></span> <span style="color: #000000; background: #E0E0FF;">   if isempty(OPT.freq ); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 106</a></span> <span style="color: #000000; background: #E0E0FF;">      if     ~isempty(OPT.omega);OPT.freq = OPT.omega./2./pi; </span>
               <span style="color: #A0A0A0"> 107</span> <span style="color: #A0A0A0; background: #FFFFFF;">      elseif ~isempty(OPT.T    );OPT.freq = 1./OPT.T;</span>
               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;">      else</span>
               <span style="color: #A0A0A0"> 109</span> <span style="color: #A0A0A0; background: #FFFFFF;">         error(' give either period, frequency or omega')</span>
               <span style="color: #A0A0A0"> 110</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 111</a></span> <span style="color: #000000; background: #E0E0FF;">   end </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 112</a></span> <span style="color: #000000; background: #E0E0FF;">   if isempty(OPT.T    ); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 113</a></span> <span style="color: #000000; background: #E0E0FF;">      if     ~isempty(OPT.omega);OPT.T    = 2.*pi./OPT.omega; </span>
               <span style="color: #A0A0A0"> 114</span> <span style="color: #A0A0A0; background: #FFFFFF;">      elseif ~isempty(OPT.freq );OPT.T    = 1./OPT.freq     ;</span>
               <span style="color: #A0A0A0"> 115</span> <span style="color: #228B22; background: #FFFFFF;">      else</span>
               <span style="color: #A0A0A0"> 116</span> <span style="color: #A0A0A0; background: #FFFFFF;">         error(' give either period, frequency or omega')</span>
               <span style="color: #A0A0A0"> 117</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 118</a></span> <span style="color: #000000; background: #E0E0FF;">   end </span>
               <span style="color: #A0A0A0"> 119</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 120</a></span> <span style="color: #000000; background: #E0E0FF;">   if isempty(OPT.names) </span>
<span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 121</a></span> <span style="color: #000000; background: #E0E0FF;">      OPT.names = num2str([1:length(OPT.omega)]'); </span>
               <span style="color: #A0A0A0"> 122</span> <span style="color: #A0A0A0; background: #FFFFFF;">   elseif iscell(OPT.names)</span>
               <span style="color: #A0A0A0"> 123</span> <span style="color: #A0A0A0; background: #FFFFFF;">       OPT.names1 = [];</span>
               <span style="color: #A0A0A0"> 124</span> <span style="color: #A0A0A0; background: #FFFFFF;">       for i=1:length(OPT.names)</span>
               <span style="color: #A0A0A0"> 125</span> <span style="color: #A0A0A0; background: #FFFFFF;">           OPT.names1 = strvcat(OPT.names1, char(OPT.names(i)));</span>
               <span style="color: #A0A0A0"> 126</span> <span style="color: #A0A0A0; background: #FFFFFF;">       end</span>
               <span style="color: #A0A0A0"> 127</span> <span style="color: #A0A0A0; background: #FFFFFF;">      OPT.names = OPT.names1;</span>
               <span style="color: #A0A0A0"> 128</span> <span style="color: #A0A0A0; background: #FFFFFF;">   end</span>
               <span style="color: #A0A0A0"> 129</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 130</a></span> <span style="color: #000000; background: #E0E0FF;">   meanname = 'mean'; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 131</a></span> <span style="color: #000000; background: #E0E0FF;">   if size(OPT.names,1) &lt; length(meanname) </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 132</a></span> <span style="color: #000000; background: #E0E0FF;">      namewidth = length(meanname);% for mean component </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 133</a></span> <span style="color: #000000; background: #E0E0FF;">      OPT.names = pad(OPT.names,length(meanname),' '); </span>
               <span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;">   else    </span>
               <span style="color: #A0A0A0"> 135</span> <span style="color: #A0A0A0; background: #FFFFFF;">      namewidth = length(OPT.names(1,:));% for mean component</span>
               <span style="color: #A0A0A0"> 136</span> <span style="color: #A0A0A0; background: #FFFFFF;">   end   </span>
               <span style="color: #A0A0A0"> 137</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 138</a></span> <span style="color: #000000; background: #E0E0FF;">   sizehin = size(h); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 139</a></span> <span style="color: #000000; background: #E0E0FF;">   if ~(size(t,1)==1); t = t';end </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 140</a></span> <span style="color: #000000; background: #E0E0FF;">   if ~(size(h,1)==1); h = h';end </span>
               <span style="color: #A0A0A0"> 141</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 142</span> <span style="color: #228B22; background: #FFFFFF;">%% REMOVE NANS FROM DATA</span>
               <span style="color: #A0A0A0"> 143</span> <span style="color: #228B22; background: #FFFFFF;"></span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 144</a></span> <span style="color: #000000; background: #E0E0FF;">   mask2keep = ~(isnan(t) | isnan(h)); </span>
               <span style="color: #A0A0A0"> 145</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;">%% mean component</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 147</a></span> <span style="color: #000000; background: #E0E0FF;">      if sum(OPT.omega==0)==0 </span>
               <span style="color: #A0A0A0"> 148</span> <span style="color: #228B22; background: #FFFFFF;">   %   OPT.omega     = [0       OPT.w];</span>
               <span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;">   %   OPT.freq      = [0       OPT.f];</span>
               <span style="color: #A0A0A0"> 150</span> <span style="color: #228B22; background: #FFFFFF;">   %   OPT.T         = [realmax OPT.T];</span>
               <span style="color: #A0A0A0"> 151</span> <span style="color: #228B22; background: #FFFFFF;">   %   OPT.names     = strvcat('mean',OPT.names);</span>
               <span style="color: #A0A0A0"> 152</span> <span style="color: #A0A0A0; background: #FFFFFF;">   elseif sum(OPT.omega==0)==1</span>
               <span style="color: #A0A0A0"> 153</span> <span style="color: #A0A0A0; background: #FFFFFF;">      error('Cannot include mean component (frequency==0)')</span>
               <span style="color: #A0A0A0"> 154</span> <span style="color: #A0A0A0; background: #FFFFFF;">   elseif sum(OPT.omega==0)&gt;1</span>
               <span style="color: #A0A0A0"> 155</span> <span style="color: #A0A0A0; background: #FFFFFF;">      error('Mean component (frequency==0) added more than once')</span>
               <span style="color: #A0A0A0"> 156</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
               <span style="color: #A0A0A0"> 157</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 158</span> <span style="color: #228B22; background: #FFFFFF;">%% specify least square solution      </span>
               <span style="color: #A0A0A0"> 159</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 160</span> <span style="color: #228B22; background: #FFFFFF;">   % if ~(size(t,2)==size(h,2))</span>
               <span style="color: #A0A0A0"> 161</span> <span style="color: #228B22; background: #FFFFFF;">   %    error('Orientation h and t wrong: dim = 1 should be different datasets and dim 2 time')</span>
               <span style="color: #A0A0A0"> 162</span> <span style="color: #228B22; background: #FFFFFF;">   % end</span>
               <span style="color: #A0A0A0"> 163</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 164</span> <span style="color: #228B22; background: #FFFFFF;">   % b0 = column(1)</span>
               <span style="color: #A0A0A0"> 165</span> <span style="color: #228B22; background: #FFFFFF;">   % Ai = column(1 + 2*iw-1)</span>
               <span style="color: #A0A0A0"> 166</span> <span style="color: #228B22; background: #FFFFFF;">   % Bi = column(1 + 2*iw  )</span>
               <span style="color: #A0A0A0"> 167</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 168</span> <span style="color: #228B22; background: #FFFFFF;">   % Pre allocate coefficients array containing </span>
               <span style="color: #A0A0A0"> 169</span> <span style="color: #228B22; background: #FFFFFF;">   % b0, A1, B1, ... , A2, B2</span>
               <span style="color: #A0A0A0"> 170</span> <span style="color: #228B22; background: #FFFFFF;">   % ------------------------------------------</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 171</a></span> <span style="color: #000000; background: #E0E0FF;">   coef = repmat(0,1,2*length(OPT.omega)+1); </span>
               <span style="color: #A0A0A0"> 172</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 173</span> <span style="color: #228B22; background: #FFFFFF;">   % Fill matrix M that gives relation between h on the left hand side and </span>
               <span style="color: #A0A0A0"> 174</span> <span style="color: #228B22; background: #FFFFFF;">   %        __</span>
               <span style="color: #A0A0A0"> 175</span> <span style="color: #228B22; background: #FFFFFF;">   %  b0 +  \ [Ai*cos(wi*t) + Bi*sin(wi*t)]]</span>
               <span style="color: #A0A0A0"> 176</span> <span style="color: #228B22; background: #FFFFFF;">   %        /_ i</span>
               <span style="color: #A0A0A0"> 177</span> <span style="color: #228B22; background: #FFFFFF;">   % on the right hand side according to h = M * coef</span>
               <span style="color: #A0A0A0"> 178</span> <span style="color: #228B22; background: #FFFFFF;">   % ------------------------------------------</span>
               <span style="color: #A0A0A0"> 179</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 180</span> <span style="color: #228B22; background: #FFFFFF;">   %M      = repmat(0,  2*length(OPT.omega)+1,length(t));</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 181</a></span> <span style="color: #000000; background: #E0E0FF;">    M      = repmat(0,  2*length(OPT.omega)+1,sum(mask2keep(:))); </span>
               <span style="color: #A0A0A0"> 182</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 183</a></span> <span style="color: #000000; background: #E0E0FF;">   M(1,:) = 1;  </span>
               <span style="color: #A0A0A0"> 184</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 185</a></span> <span style="color: #000000; background: #E0E0FF;">   for iw=1:length(OPT.omega) </span>
       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"><a> 186</a></span> <span style="color: #000000; background: #E0E0FF;">      M(1 + 2*iw-1,:) = cos(OPT.omega(iw).*t(mask2keep)); % Ai*cos(wi*t) </span>
       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"><a> 187</a></span> <span style="color: #000000; background: #E0E0FF;">      M(1 + 2*iw  ,:) = sin(OPT.omega(iw).*t(mask2keep)); % Bi*sin(wi*t) </span>
       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"><a> 188</a></span> <span style="color: #000000; background: #E0E0FF;">   end </span>
               <span style="color: #A0A0A0"> 189</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 190</span> <span style="color: #228B22; background: #FFFFFF;">%% get least square solution to tidal parameters</span>
               <span style="color: #A0A0A0"> 191</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 192</a></span> <span style="color: #000000; background: #E0E0FF;">      if OPT.plotM </span>
               <span style="color: #A0A0A0"> 193</span> <span style="color: #A0A0A0; background: #FFFFFF;">         newfig1 = figure;</span>
               <span style="color: #A0A0A0"> 194</span> <span style="color: #A0A0A0; background: #FFFFFF;">            hist(M(:))</span>
               <span style="color: #A0A0A0"> 195</span> <span style="color: #228B22; background: #FFFFFF;">            % DONT PLOT surf(M), IS TOO BIG</span>
               <span style="color: #A0A0A0"> 196</span> <span style="color: #A0A0A0; background: #FFFFFF;">            pause</span>
               <span style="color: #A0A0A0"> 197</span> <span style="color: #A0A0A0; background: #FFFFFF;">         try</span>
               <span style="color: #A0A0A0"> 198</span> <span style="color: #A0A0A0; background: #FFFFFF;">         close(newfig1)</span>
               <span style="color: #A0A0A0"> 199</span> <span style="color: #A0A0A0; background: #FFFFFF;">         end</span>
               <span style="color: #A0A0A0"> 200</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
               <span style="color: #A0A0A0"> 201</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 202</a></span> <span style="color: #000000; background: #E0E0FF;">      coef  = h(mask2keep)/M; </span>
               <span style="color: #A0A0A0"> 203</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
               <span style="color: #A0A0A0"> 204</span> <span style="color: #228B22; background: #FFFFFF;">%% rewrite to get tidal parameters</span>
               <span style="color: #A0A0A0"> 205</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 206</span> <span style="color: #228B22; background: #FFFFFF;">     %FIT.(OPT.parameter)             = coef*M;</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 207</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.(OPT.parameter)             = nan.*zeros(size(h)); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 208</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.(OPT.parameter)(mask2keep)  = coef*M; </span>
               <span style="color: #A0A0A0"> 209</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 210</a></span> <span style="color: #000000; background: #E0E0FF;">      a = coef(2:2:end); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 211</a></span> <span style="color: #000000; background: #E0E0FF;">      b = coef(3:2:end); </span>
               <span style="color: #A0A0A0"> 212</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 213</span> <span style="color: #228B22; background: #FFFFFF;">      %            sqrt[(Ai)^2 + (Bi)^2]</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 214</a></span> <span style="color: #000000; background: #E0E0FF;">      amplitudes = sqrt(a.^2 + ... </span>
               <span style="color: #A0A0A0"> 215</span> <span style="color: #000000; background: #E0E0FF;">                        b.^2);</span>
               <span style="color: #A0A0A0"> 216</span> <span style="color: #228B22; background: #FFFFFF;">                        </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 217</a></span> <span style="color: #000000; background: #E0E0FF;">      amplitude_order = ranknumber(amplitudes); </span>
               <span style="color: #A0A0A0"> 218</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;">      %            atan(Bi/Ai))</span>
               <span style="color: #A0A0A0"> 220</span> <span style="color: #228B22; background: #FFFFFF;">      % If you want the right phase for a sinus base fucntion,</span>
               <span style="color: #A0A0A0"> 221</span> <span style="color: #228B22; background: #FFFFFF;">      % subtract 90 degrees, for a cosinus don't.</span>
               <span style="color: #A0A0A0"> 222</span> <span style="color: #228B22; background: #FFFFFF;"></span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 223</a></span> <span style="color: #000000; background: #E0E0FF;">      phases     = - atan2(a,... </span>
               <span style="color: #A0A0A0"> 224</span> <span style="color: #000000; background: #E0E0FF;">                           b) + pi/2;</span>
               <span style="color: #A0A0A0"> 225</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
               <span style="color: #A0A0A0"> 226</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 227</span> <span style="color: #228B22; background: #FFFFFF;">      % all in range 0 360</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 228</a></span> <span style="color: #000000; background: #E0E0FF;">      phases(phases&lt;0) = phases(phases&lt;0)+2*pi; </span>
               <span style="color: #A0A0A0"> 229</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
               <span style="color: #A0A0A0"> 230</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 231</span> <span style="color: #228B22; background: #FFFFFF;">% CHECK amplitudes and phases</span>
               <span style="color: #A0A0A0"> 232</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 233</span> <span style="color: #228B22; background: #FFFFFF;">   %   FIT.hfit2 = coef(1) + zeros(size(h));</span>
               <span style="color: #A0A0A0"> 234</span> <span style="color: #228B22; background: #FFFFFF;">   %   for iw=1:length(OPT.w)</span>
               <span style="color: #A0A0A0"> 235</span> <span style="color: #228B22; background: #FFFFFF;">   %   FIT.hfit2  = FIT.hfit2  + amplitudes(iw).* cos(OPT.omega(iw).*t - phases(iw));</span>
               <span style="color: #A0A0A0"> 236</span> <span style="color: #228B22; background: #FFFFFF;">   %   end</span>
               <span style="color: #A0A0A0"> 237</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 238</span> <span style="color: #228B22; background: #FFFFFF;">%% PLOT SPECTRUM</span>
               <span style="color: #A0A0A0"> 239</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 240</a></span> <span style="color: #000000; background: #E0E0FF;">       if OPT.plotspectrum </span>
               <span style="color: #A0A0A0"> 241</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 242</span> <span style="color: #A0A0A0; background: #FFFFFF;">          newfig1 = figure;</span>
               <span style="color: #A0A0A0"> 243</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 244</span> <span style="color: #A0A0A0; background: #FFFFFF;">             subplot(2,1,1)</span>
               <span style="color: #A0A0A0"> 245</span> <span style="color: #A0A0A0; background: #FFFFFF;">             bar   (OPT.freq,amplitudes)</span>
               <span style="color: #A0A0A0"> 246</span> <span style="color: #A0A0A0; background: #FFFFFF;">             hold   on</span>
               <span style="color: #A0A0A0"> 247</span> <span style="color: #A0A0A0; background: #FFFFFF;">             text  (OPT.freq,amplitudes,OPT.names,'rotation',45)</span>
               <span style="color: #A0A0A0"> 248</span> <span style="color: #A0A0A0; background: #FFFFFF;">             title ('Amplitudes')</span>
               <span style="color: #A0A0A0"> 249</span> <span style="color: #A0A0A0; background: #FFFFFF;">             xlabel(' Frequency ')</span>
               <span style="color: #A0A0A0"> 250</span> <span style="color: #A0A0A0; background: #FFFFFF;">             grid   on</span>
               <span style="color: #A0A0A0"> 251</span> <span style="color: #228B22; background: #FFFFFF;">             </span>
               <span style="color: #A0A0A0"> 252</span> <span style="color: #A0A0A0; background: #FFFFFF;">             subplot(2,1,2)</span>
               <span style="color: #A0A0A0"> 253</span> <span style="color: #A0A0A0; background: #FFFFFF;">             bar   (OPT.freq,rad2deg(phases))</span>
               <span style="color: #A0A0A0"> 254</span> <span style="color: #A0A0A0; background: #FFFFFF;">             hold   on</span>
               <span style="color: #A0A0A0"> 255</span> <span style="color: #A0A0A0; background: #FFFFFF;">             text  (OPT.freq,rad2deg(phases),OPT.names,'rotation',45)</span>
               <span style="color: #A0A0A0"> 256</span> <span style="color: #A0A0A0; background: #FFFFFF;">             title (' Phases')</span>
               <span style="color: #A0A0A0"> 257</span> <span style="color: #A0A0A0; background: #FFFFFF;">             xlabel(' Frequency ')</span>
               <span style="color: #A0A0A0"> 258</span> <span style="color: #A0A0A0; background: #FFFFFF;">             grid   on</span>
               <span style="color: #A0A0A0"> 259</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 260</span> <span style="color: #A0A0A0; background: #FFFFFF;">          newfig2 = figure;</span>
               <span style="color: #A0A0A0"> 261</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 262</span> <span style="color: #A0A0A0; background: #FFFFFF;">             subplot(2,1,1)</span>
               <span style="color: #A0A0A0"> 263</span> <span style="color: #A0A0A0; background: #FFFFFF;">             plot  (OPT.freq,amplitudes,'o')</span>
               <span style="color: #A0A0A0"> 264</span> <span style="color: #A0A0A0; background: #FFFFFF;">             hold   on</span>
               <span style="color: #A0A0A0"> 265</span> <span style="color: #A0A0A0; background: #FFFFFF;">             text  (OPT.freq,amplitudes,OPT.names,'rotation',45)</span>
               <span style="color: #A0A0A0"> 266</span> <span style="color: #A0A0A0; background: #FFFFFF;">             title ('Amplitudes')</span>
               <span style="color: #A0A0A0"> 267</span> <span style="color: #A0A0A0; background: #FFFFFF;">             xlabel(' Frequency ')</span>
               <span style="color: #A0A0A0"> 268</span> <span style="color: #A0A0A0; background: #FFFFFF;">             set   (gca,'yscale','log')</span>
               <span style="color: #A0A0A0"> 269</span> <span style="color: #A0A0A0; background: #FFFFFF;">             grid   on</span>
               <span style="color: #A0A0A0"> 270</span> <span style="color: #228B22; background: #FFFFFF;">             </span>
               <span style="color: #A0A0A0"> 271</span> <span style="color: #A0A0A0; background: #FFFFFF;">             subplot(2,1,2)</span>
               <span style="color: #A0A0A0"> 272</span> <span style="color: #A0A0A0; background: #FFFFFF;">             bar   (OPT.freq,rad2deg(phases))</span>
               <span style="color: #A0A0A0"> 273</span> <span style="color: #A0A0A0; background: #FFFFFF;">             hold   on</span>
               <span style="color: #A0A0A0"> 274</span> <span style="color: #A0A0A0; background: #FFFFFF;">             text  (OPT.freq,rad2deg(phases),OPT.names,'rotation',45)</span>
               <span style="color: #A0A0A0"> 275</span> <span style="color: #A0A0A0; background: #FFFFFF;">             title (' Phases')</span>
               <span style="color: #A0A0A0"> 276</span> <span style="color: #A0A0A0; background: #FFFFFF;">             xlabel(' Frequency ')</span>
               <span style="color: #A0A0A0"> 277</span> <span style="color: #A0A0A0; background: #FFFFFF;">             grid   on</span>
               <span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 279</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 280</span> <span style="color: #A0A0A0; background: #FFFFFF;">          newfig3= figure;</span>
               <span style="color: #A0A0A0"> 281</span> <span style="color: #228B22; background: #FFFFFF;">            </span>
               <span style="color: #A0A0A0"> 282</span> <span style="color: #A0A0A0; background: #FFFFFF;">            plot    (amplitudes,amplitudes,'+')</span>
               <span style="color: #A0A0A0"> 283</span> <span style="color: #A0A0A0; background: #FFFFFF;">            hold    ('on')</span>
               <span style="color: #A0A0A0"> 284</span> <span style="color: #A0A0A0; background: #FFFFFF;">            text    (amplitudes,amplitudes,...</span>
               <span style="color: #A0A0A0"> 285</span> <span style="color: #A0A0A0; background: #FFFFFF;">                     OPT.names,'rotation',-45);</span>
               <span style="color: #A0A0A0"> 286</span> <span style="color: #A0A0A0; background: #FFFFFF;">            title   (['Amplitudes [m] '])</span>
               <span style="color: #A0A0A0"> 287</span> <span style="color: #A0A0A0; background: #FFFFFF;">            grid    ('on')</span>
               <span style="color: #A0A0A0"> 288</span> <span style="color: #A0A0A0; background: #FFFFFF;">            set     (gca,'xscale','log')</span>
               <span style="color: #A0A0A0"> 289</span> <span style="color: #A0A0A0; background: #FFFFFF;">            set     (gca,'yscale','log')</span>
               <span style="color: #A0A0A0"> 290</span> <span style="color: #228B22; background: #FFFFFF;">            % axis    ([1e-3 1 1e-3 1]) % does not work for fluxes</span>
               <span style="color: #A0A0A0"> 291</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 292</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 293</span> <span style="color: #A0A0A0; background: #FFFFFF;">          pause</span>
               <span style="color: #A0A0A0"> 294</span> <span style="color: #A0A0A0; background: #FFFFFF;">          try</span>
               <span style="color: #A0A0A0"> 295</span> <span style="color: #A0A0A0; background: #FFFFFF;">          close (newfig1)</span>
               <span style="color: #A0A0A0"> 296</span> <span style="color: #A0A0A0; background: #FFFFFF;">          end</span>
               <span style="color: #A0A0A0"> 297</span> <span style="color: #A0A0A0; background: #FFFFFF;">          try</span>
               <span style="color: #A0A0A0"> 298</span> <span style="color: #A0A0A0; background: #FFFFFF;">          close (newfig2)</span>
               <span style="color: #A0A0A0"> 299</span> <span style="color: #A0A0A0; background: #FFFFFF;">          end</span>
               <span style="color: #A0A0A0"> 300</span> <span style="color: #A0A0A0; background: #FFFFFF;">          try</span>
               <span style="color: #A0A0A0"> 301</span> <span style="color: #A0A0A0; background: #FFFFFF;">          close (newfig3)</span>
               <span style="color: #A0A0A0"> 302</span> <span style="color: #A0A0A0; background: #FFFFFF;">          end</span>
               <span style="color: #A0A0A0"> 303</span> <span style="color: #228B22; background: #FFFFFF;">          </span>
               <span style="color: #A0A0A0"> 304</span> <span style="color: #A0A0A0; background: #FFFFFF;">       end %if OPT.plot</span>
               <span style="color: #A0A0A0"> 305</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 306</span> <span style="color: #228B22; background: #FFFFFF;">%% PLOT TIMESERIES</span>
               <span style="color: #A0A0A0"> 307</span> <span style="color: #228B22; background: #FFFFFF;"></span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 308</a></span> <span style="color: #000000; background: #E0E0FF;">       if OPT.plottimeseries  </span>
               <span style="color: #A0A0A0"> 309</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 310</span> <span style="color: #A0A0A0; background: #FFFFFF;">          newfig1 = figure;</span>
               <span style="color: #A0A0A0"> 311</span> <span style="color: #A0A0A0; background: #FFFFFF;">          subplot(2,1,1)</span>
               <span style="color: #A0A0A0"> 312</span> <span style="color: #A0A0A0; background: #FFFFFF;">          plot   (t,h,'k')</span>
               <span style="color: #A0A0A0"> 313</span> <span style="color: #A0A0A0; background: #FFFFFF;">          hold   ('on')</span>
               <span style="color: #A0A0A0"> 314</span> <span style="color: #A0A0A0; background: #FFFFFF;">          plot   (t,FIT.(OPT.parameter),'g')</span>
               <span style="color: #A0A0A0"> 315</span> <span style="color: #A0A0A0; background: #FFFFFF;">          plot   (t,h-FIT.(OPT.parameter),'b')</span>
               <span style="color: #A0A0A0"> 316</span> <span style="color: #A0A0A0; background: #FFFFFF;">          title  ('Time series')</span>
               <span style="color: #A0A0A0"> 317</span> <span style="color: #A0A0A0; background: #FFFFFF;">          xlabel (' Time [s]')</span>
               <span style="color: #A0A0A0"> 318</span> <span style="color: #A0A0A0; background: #FFFFFF;">          legend ('h','h_{fit}','residual (data - harmonic fit)')</span>
               <span style="color: #A0A0A0"> 319</span> <span style="color: #A0A0A0; background: #FFFFFF;">          grid   ('on')</span>
               <span style="color: #A0A0A0"> 320</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 321</span> <span style="color: #A0A0A0; background: #FFFFFF;">          subplot(2,1,2)</span>
               <span style="color: #A0A0A0"> 322</span> <span style="color: #A0A0A0; background: #FFFFFF;">          plot   (t,FIT.(OPT.parameter)-h,'b')</span>
               <span style="color: #A0A0A0"> 323</span> <span style="color: #A0A0A0; background: #FFFFFF;">          title  ('Time series')</span>
               <span style="color: #A0A0A0"> 324</span> <span style="color: #A0A0A0; background: #FFFFFF;">          xlabel (' Time [s]')</span>
               <span style="color: #A0A0A0"> 325</span> <span style="color: #A0A0A0; background: #FFFFFF;">          legend ('residual')</span>
               <span style="color: #A0A0A0"> 326</span> <span style="color: #A0A0A0; background: #FFFFFF;">          grid   ('on')</span>
               <span style="color: #A0A0A0"> 327</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 328</span> <span style="color: #A0A0A0; background: #FFFFFF;">          pause</span>
               <span style="color: #A0A0A0"> 329</span> <span style="color: #A0A0A0; background: #FFFFFF;">          try</span>
               <span style="color: #A0A0A0"> 330</span> <span style="color: #A0A0A0; background: #FFFFFF;">          close (newfig1)</span>
               <span style="color: #A0A0A0"> 331</span> <span style="color: #A0A0A0; background: #FFFFFF;">          end</span>
               <span style="color: #A0A0A0"> 332</span> <span style="color: #A0A0A0; background: #FFFFFF;">       end</span>
               <span style="color: #A0A0A0"> 333</span> <span style="color: #228B22; background: #FFFFFF;">       </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 334</a></span> <span style="color: #000000; background: #E0E0FF;">       if OPT.errors </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 335</a></span> <span style="color: #000000; background: #E0E0FF;">       FIT.residue  = h(:) - FIT.(OPT.parameter)(:); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 336</a></span> <span style="color: #000000; background: #E0E0FF;">       FIT.rmserror = rms(FIT.residue(:)); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 337</a></span> <span style="color: #000000; background: #E0E0FF;">       FIT.minerror = min(FIT.residue(:)); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 338</a></span> <span style="color: #000000; background: #E0E0FF;">       FIT.maxerror = max(FIT.residue(:)); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 339</a></span> <span style="color: #000000; background: #E0E0FF;">       end        </span>
               <span style="color: #A0A0A0"> 340</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
               <span style="color: #A0A0A0"> 341</span> <span style="color: #228B22; background: #FFFFFF;">%% DISPLAY</span>
               <span style="color: #A0A0A0"> 342</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 343</a></span> <span style="color: #000000; background: #E0E0FF;">      if OPT.screenoutput </span>
               <span style="color: #A0A0A0"> 344</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 345</span> <span style="color: #A0A0A0; background: #FFFFFF;">         spaces  = repmat(' ',[1 namewidth  ]);</span>
               <span style="color: #A0A0A0"> 346</span> <span style="color: #A0A0A0; background: #FFFFFF;">         spaces1 = repmat('-',[1 namewidth  ]);</span>
               <span style="color: #A0A0A0"> 347</span> <span style="color: #A0A0A0; background: #FFFFFF;">         spaces2 = repmat(' ',[1 namewidth-length(meanname)]);</span>
               <span style="color: #A0A0A0"> 348</span> <span style="color: #228B22; background: #FFFFFF;">         </span>
               <span style="color: #A0A0A0"> 349</span> <span style="color: #228B22; background: #FFFFFF;">         </span>
               <span style="color: #A0A0A0"> 350</span> <span style="color: #A0A0A0; background: #FFFFFF;">         disp(['no | seq| ',spaces ,' |      T     |     f      |   Ampl.    |   Phase    |     Ai     |     Bi     |'])</span>
               <span style="color: #A0A0A0"> 351</span> <span style="color: #228B22; background: #FFFFFF;">        %disp(['[#]| [#]| ',spaces ,' |     [h]    |     [1/h]  |   [m]      |   [deg]    |     [m]    |     [m]    |'])</span>
               <span style="color: #A0A0A0"> 352</span> <span style="color: #A0A0A0; background: #FFFFFF;">         disp(['---+----+-',spaces1,'-+------------+------------+------------+------------+............+............+'])</span>
               <span style="color: #A0A0A0"> 353</span> <span style="color: #228B22; background: #FFFFFF;">        %disp(['   |    | ',spaces ,' |            |            |            |            |            |            |'])</span>
               <span style="color: #A0A0A0"> 354</span> <span style="color: #228B22; background: #FFFFFF;">         </span>
               <span style="color: #A0A0A0"> 355</span> <span style="color: #A0A0A0; background: #FFFFFF;">              disp([num2str(0                  ,'%0.3i')  , '| ',...</span>
               <span style="color: #A0A0A0"> 356</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(0                  ,'%0.3i')  , '| ',...</span>
               <span style="color: #A0A0A0"> 357</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    meanname,spaces2               ,           ' | ',...</span>
               <span style="color: #A0A0A0"> 358</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(0                  ,'%010.4g'),' | ',...</span>
               <span style="color: #A0A0A0"> 359</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(0                  ,'%010.4g'),' # ',...</span>
               <span style="color: #A0A0A0"> 360</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(coef(1)            ,'%010.4g'),' | ',...</span>
               <span style="color: #A0A0A0"> 361</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(0                  ,'%010.4g'),' | ',...</span>
               <span style="color: #A0A0A0"> 362</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(0                  ,'%010.4g'),' | ',...</span>
               <span style="color: #A0A0A0"> 363</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(0                  ,'%010.4g'),' | '])</span>
               <span style="color: #A0A0A0"> 364</span> <span style="color: #228B22; background: #FFFFFF;">         </span>
               <span style="color: #A0A0A0"> 365</span> <span style="color: #A0A0A0; background: #FFFFFF;">           for iw=1:length(OPT.omega)</span>
               <span style="color: #A0A0A0"> 366</span> <span style="color: #A0A0A0; background: #FFFFFF;">              disp([num2str(iw                 ,'%0.3i') ,  '| ',...</span>
               <span style="color: #A0A0A0"> 367</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(amplitude_order(iw),'%0.3i') ,  '| ',...</span>
               <span style="color: #A0A0A0"> 368</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    OPT.names(iw,:)              ,           ' | ',...</span>
               <span style="color: #A0A0A0"> 369</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(OPT.T(iw)/3600       ,'%010.4g'),' | ',...</span>
               <span style="color: #A0A0A0"> 370</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(OPT.freq(iw)*3600    ,'%010.4g'),' # ',...</span>
               <span style="color: #A0A0A0"> 371</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(amplitudes(iw)     ,'%010.4g'),' | ',...</span>
               <span style="color: #A0A0A0"> 372</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(rad2deg(phases(iw)),'%010.4g'),' | ',...</span>
               <span style="color: #A0A0A0"> 373</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(coef(1 + 2*iw-1)   ,'%010.4g'),' | ',...</span>
               <span style="color: #A0A0A0"> 374</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    num2str(coef(1 + 2*iw  )   ,'%010.4g'),' | '])</span>
               <span style="color: #A0A0A0"> 375</span> <span style="color: #A0A0A0; background: #FFFFFF;">           end</span>
               <span style="color: #A0A0A0"> 376</span> <span style="color: #A0A0A0; background: #FFFFFF;">           disp(['---+----+-',spaces1,'-+------------+------------+------------+------------+............+............+'])</span>
               <span style="color: #A0A0A0"> 377</span> <span style="color: #A0A0A0; background: #FFFFFF;">           if OPT.errors</span>
               <span style="color: #A0A0A0"> 378</span> <span style="color: #A0A0A0; background: #FFFFFF;">              disp(['rms error  ',spaces,'| ',repmat(' ',1,26),num2str(FIT.rmserror       ,'%010.4g'),' | '])</span>
               <span style="color: #A0A0A0"> 379</span> <span style="color: #A0A0A0; background: #FFFFFF;">              disp(['min error  ',spaces,'| ',repmat(' ',1,26),num2str(FIT.minerror       ,'%010.4g'),' | '])</span>
               <span style="color: #A0A0A0"> 380</span> <span style="color: #A0A0A0; background: #FFFFFF;">              disp(['max error  ',spaces,'| ',repmat(' ',1,26),num2str(FIT.maxerror       ,'%010.4g'),' | '])</span>
               <span style="color: #A0A0A0"> 381</span> <span style="color: #A0A0A0; background: #FFFFFF;">           end</span>
               <span style="color: #A0A0A0"> 382</span> <span style="color: #228B22; background: #FFFFFF;">           </span>
               <span style="color: #A0A0A0"> 383</span> <span style="color: #A0A0A0; background: #FFFFFF;">         disp(['---+----+-',spaces1,'-+------------+------------+------------+'])</span>
               <span style="color: #A0A0A0"> 384</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
               <span style="color: #A0A0A0"> 385</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
               <span style="color: #A0A0A0"> 386</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
               <span style="color: #A0A0A0"> 387</span> <span style="color: #228B22; background: #FFFFFF;">      %if (1/(t(end)-t(1))) &lt; (min(diff(sort(OPT.freq(:)))))</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 388</a></span> <span style="color: #000000; background: #E0E0FF;">      [dummy, closest_components] = min(abs(diff(OPT.freq))); </span>
               <span style="color: #A0A0A0"> 389</span> <span style="color: #228B22; background: #FFFFFF;"></span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 390</a></span> <span style="color: #000000; background: #E0E0FF;">      if isempty(closest_components) </span>
               <span style="color: #A0A0A0"> 391</span> <span style="color: #A0A0A0; background: #FFFFFF;">          T_rayleigh = 1/OPT.freq(1); % one component only</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 392</a></span> <span style="color: #228B22; background: #FFFFFF;">      else </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 393</a></span> <span style="color: #000000; background: #E0E0FF;">          T_rayleigh = (1/(OPT.freq(closest_components+1)-OPT.freq(closest_components))); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 394</a></span> <span style="color: #000000; background: #E0E0FF;">      end </span>
               <span style="color: #A0A0A0"> 395</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
               <span style="color: #A0A0A0"> 396</span> <span style="color: #228B22; background: #FFFFFF;">%% RAYLEIGH CHECK      </span>
               <span style="color: #A0A0A0"> 397</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 398</a></span> <span style="color: #000000; background: #E0E0FF;">      if (t(end)-t(1)) &gt;= T_rayleigh </span>
               <span style="color: #A0A0A0"> 399</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
<span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 400</a></span> <span style="color: #000000; background: #E0E0FF;">         if OPT.screenoutput; </span>
               <span style="color: #A0A0A0"> 401</span> <span style="color: #A0A0A0; background: #FFFFFF;">         disp('Rayleigh criterion: OK');</span>
               <span style="color: #A0A0A0"> 402</span> <span style="color: #A0A0A0; background: #FFFFFF;">         end</span>
               <span style="color: #A0A0A0"> 403</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 404</span> <span style="color: #228B22; background: #FFFFFF;">      else</span>
               <span style="color: #A0A0A0"> 405</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 406</span> <span style="color: #228B22; background: #FFFFFF;">         %% Always display when not OK</span>
               <span style="color: #A0A0A0"> 407</span> <span style="color: #228B22; background: #FFFFFF;">         </span>
               <span style="color: #A0A0A0"> 408</span> <span style="color: #A0A0A0; background: #FFFFFF;">         disp(['Rayleigh criterion: NOT OK for ',...</span>
               <span style="color: #A0A0A0"> 409</span> <span style="color: #A0A0A0; background: #FFFFFF;">               deblank(OPT.names(closest_components,:)),...</span>
               <span style="color: #A0A0A0"> 410</span> <span style="color: #A0A0A0; background: #FFFFFF;">               ' &amp; ',...</span>
               <span style="color: #A0A0A0"> 411</span> <span style="color: #A0A0A0; background: #FFFFFF;">               deblank(OPT.names(closest_components+1,:))]);</span>
               <span style="color: #A0A0A0"> 412</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 413</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 414</a></span> <span style="color: #000000; background: #E0E0FF;">      if OPT.screenoutput; </span>
               <span style="color: #A0A0A0"> 415</span> <span style="color: #A0A0A0; background: #FFFFFF;">      disp(['  df_{min} possible data / present with specified components = ',...</span>
               <span style="color: #A0A0A0"> 416</span> <span style="color: #A0A0A0; background: #FFFFFF;">             num2str(1/(t(end)-t(1))),' / ',...</span>
               <span style="color: #A0A0A0"> 417</span> <span style="color: #A0A0A0; background: #FFFFFF;">             num2str(min(diff(sort(OPT.freq(:)))))]);</span>
               <span style="color: #A0A0A0"> 418</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
               <span style="color: #A0A0A0"> 419</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
               <span style="color: #A0A0A0"> 420</span> <span style="color: #228B22; background: #FFFFFF;">%% NYQUIST CHECK       </span>
               <span style="color: #A0A0A0"> 421</span> <span style="color: #228B22; background: #FFFFFF;"></span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 422</a></span> <span style="color: #000000; background: #E0E0FF;">      if (1/2/min(diff(t))) &gt; (max(OPT.freq)) </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 423</a></span> <span style="color: #000000; background: #E0E0FF;">      if OPT.screenoutput; </span>
               <span style="color: #A0A0A0"> 424</span> <span style="color: #A0A0A0; background: #FFFFFF;">      disp('Nyquist criterion: OK')</span>
               <span style="color: #A0A0A0"> 425</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
               <span style="color: #A0A0A0"> 426</span> <span style="color: #228B22; background: #FFFFFF;">      else</span>
               <span style="color: #A0A0A0"> 427</span> <span style="color: #A0A0A0; background: #FFFFFF;">      disp('Nyquist criterion: NOT OK')</span>
               <span style="color: #A0A0A0"> 428</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
               <span style="color: #A0A0A0"> 429</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 430</a></span> <span style="color: #000000; background: #E0E0FF;">      if OPT.screenoutput; </span>
               <span style="color: #A0A0A0"> 431</span> <span style="color: #A0A0A0; background: #FFFFFF;">      disp(['  f_{max} possible / present with dataset                    = ',...</span>
               <span style="color: #A0A0A0"> 432</span> <span style="color: #A0A0A0; background: #FFFFFF;">            num2str(1/2/min(diff(t))),' / ',...</span>
               <span style="color: #A0A0A0"> 433</span> <span style="color: #A0A0A0; background: #FFFFFF;">            num2str(max(OPT.freq))]);</span>
               <span style="color: #A0A0A0"> 434</span> <span style="color: #A0A0A0; background: #FFFFFF;">      disp(['----------',spaces1,'--------------------------------------------------------------------------------'])</span>
               <span style="color: #A0A0A0"> 435</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span>
               <span style="color: #A0A0A0"> 436</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 437</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 438</span> <span style="color: #228B22; background: #FFFFFF;">%% RETURN VALUES</span>
               <span style="color: #A0A0A0"> 439</span> <span style="color: #228B22; background: #FFFFFF;"></span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 440</a></span> <span style="color: #000000; background: #E0E0FF;">   if nargout==1 </span>
               <span style="color: #A0A0A0"> 441</span> <span style="color: #228B22; background: #FFFFFF;">   </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 442</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.(OPT.parameter) = reshape(FIT.(OPT.parameter), sizehin); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 443</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.a               = a         ; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 444</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.b               = b         ; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 445</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.coef            = coef      ; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 446</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.hamplitudes     = amplitudes; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 447</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.amplitude_order = amplitude_order; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 448</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.hphases         = phases    ; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 449</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.freq            = OPT.freq  ; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 450</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.omega           = OPT.omega ; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 451</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.T               = OPT.T     ; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 452</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.names           = OPT.names ; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 453</a></span> <span style="color: #000000; background: #E0E0FF;">      FIT.mean            = coef(1)   ; </span>
               <span style="color: #A0A0A0"> 454</span> <span style="color: #228B22; background: #FFFFFF;">      </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 455</a></span> <span style="color: #000000; background: #E0E0FF;">      varargout = {FIT}; </span>
               <span style="color: #A0A0A0"> 456</span> <span style="color: #A0A0A0; background: #FFFFFF;">   elseif nargout==2</span>
               <span style="color: #A0A0A0"> 457</span> <span style="color: #A0A0A0; background: #FFFFFF;">      varargout = {amplitudes,phases};</span>
               <span style="color: #A0A0A0"> 458</span> <span style="color: #A0A0A0; background: #FFFFFF;">   end</span>
</pre>
<p><p>Other subfunctions in this file are not included in this listing.
</div>
</body>
</html>
