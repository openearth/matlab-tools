<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Function details for rws_getDataFromNetCDFGrid</title>
<link type="text/css" href="script/css/jquery-ui-1.7.2.custom.css" rel="stylesheet" />
<link type="text/css" href="script/css/FunctionCoverage.css" rel="stylesheet" />
<script type="text/javascript" src="script/js/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="script/js/jquery-ui-1.7.2.custom.min.js"></script>
<script type="text/javascript" src="script/js/matlab2accordion.js"></script>
</head>
<body>
<h2 class="ui-widget-header ui-state-active ui-corner-all">rws_getDataFromNetCDFGrid</h2>
<div class="ui-widget-content ui-corner-all">
<strong>Coverage results</strong><br/>
<table border=0 cellspacing=0 cellpadding=6>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td>
<td class="td-linebottomrt">140</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td>
<td class="td-linebottomrt">95</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td>
<td class="td-linebottomrt">45</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td>
<td class="td-linebottomrt">39</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td>
<td class="td-linebottomrt">6</td></tr>
<tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td>
<td class="td-linebottomrt">86.67 %</td></tr>
</table>
</div><br/>
<div class="ui-widget-content ui-corner-all">
<strong>Function listing</strong><br/>
<pre>
<span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span> <span style="font-weight: bold; text-decoration: none">line</span><br/>
               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [X, Y, Z, T] = rws_getDataFromNetCDFGrid(varargin)</span>
               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%rws_GETDATAFROMNETCDFGRID  This routine gets data from a NetCDF grid file.</span>
               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%   This routine gets data from a NetCDF grid file</span>
               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%   Syntax:</span>
               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%   varargout = getDataFromNetCDFGrid(varargin)</span>
               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%   Output:</span>
               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%       X                           = X values</span>
               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%       Y                           = Y values</span>
               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%       Z                           = Z values</span>
               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%       T                           = temporal signature of the data</span>
               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%   Example</span>
               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">% </span>
               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%   poly = [68920.9 447892</span>
               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%           69222.7 447863</span>
               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%           69377.2 447909</span>
               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%           69730.6 448307</span>
               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%           69679.1 448608</span>
               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%           69215.3 448682</span>
               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%           68928.2 448631</span>
               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%           68812.9 448211</span>
               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%           68839.9 447961];</span>
               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%   ncfile = 'Delflandsekust.nc'</span>
               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%   </span>
               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%   [X, Y, Z, T] = rws_getDataFromNetCDFGrid('ncfile', ncfile, 'starttime', now, 'polygon', poly)</span>
               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">% </span>
               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%   See also: nc_dump, rws_getDataFromNetCDFGrid_test, nc_varfind</span>
               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%   --------------------------------------------------------------------</span>
               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%   Copyright (C) 2009 Delft University of Technology</span>
               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%       Mark van Koningsveld</span>
               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%       m.vankoningsveld@tudelft.nl	</span>
               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%       Hydraulic Engineering Section</span>
               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%       Faculty of Civil Engineering and Geosciences</span>
               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">%       Stevinweg 1</span>
               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%       2628CN Delft</span>
               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">%       The Netherlands</span>
               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">%   This library is free software: you can redistribute it and/or</span>
               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%   modify it under the terms of the GNU Lesser General Public</span>
               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">%   License as published by the Free Software Foundation, either</span>
               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">%   version 2.1 of the License, or (at your option) any later version.</span>
               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%   This library is distributed in the hope that it will be useful,</span>
               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%   Lesser General Public License for more details.</span>
               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">%</span>
               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">%   You should have received a copy of the GNU Lesser General Public</span>
               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">%   License along with this library. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%   --------------------------------------------------------------------</span>
               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">% Created: 24 Mar 2009</span>
               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">% Created with Matlab version: 7.7.0.471 (R2008b)</span>
               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">% $Id: rws_getDataFromNetCDFGrid.m 867 2009-08-24 10:55:52Z m.vankoningsveld@tudelft.nl $</span>
               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">% $Date: 2009-08-24 12:55:52 +0200 (ma, 24 aug 2009) $</span>
               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">% $Author: m.vankoningsveld@tudelft.nl $</span>
               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;">% $Revision: 867 $</span>
               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;">% $HeadURL: https://repos.deltares.nl/repos/OpenEarthTools/trunk/matlab/applications/Rijkswaterstaat/bathymetry/rws_getDataFromNetCDFGrid.m $</span>
               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;">% $Keywords:</span>
               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">%% settings</span>
               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;">% defaults</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  71</a></span> <span style="color: #000000; background: #E0E0FF;">OPT = struct(... </span>
               <span style="color: #A0A0A0">  72</span> <span style="color: #000000; background: #E0E0FF;">    'ncfile', [], ...                               % filename of nc file to use</span>
               <span style="color: #A0A0A0">  73</span> <span style="color: #000000; background: #E0E0FF;">    'starttime', [], ...                            % this is a datenum of the starting time to search</span>
               <span style="color: #A0A0A0">  74</span> <span style="color: #000000; background: #E0E0FF;">    'searchwindow', -30, ...                        % this indicates the search window (nr of days, '-': backward in time, '+': forward in time)</span>
               <span style="color: #A0A0A0">  75</span> <span style="color: #000000; background: #E0E0FF;">    'polygon', [], ...                              % search polygon (default: [] use entire grid) </span>
               <span style="color: #A0A0A0">  76</span> <span style="color: #000000; background: #E0E0FF;">    'stride', [1 1 1] ...                           % stride vector indicating thinning factor</span>
               <span style="color: #A0A0A0">  77</span> <span style="color: #000000; background: #E0E0FF;">    );</span>
               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;">% overrule default settings by property pairs, given in varargin</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  80</a></span> <span style="color: #000000; background: #E0E0FF;">OPT = setProperty(OPT, varargin{:}); </span>
               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF;">%% find data area of interest</span>
<span style="color: #FF0000">  0.13 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  83</a></span> <span style="color: #000000; background: #E0E0FF;">X        = nc_varget(OPT.ncfile, nc_varfind(OPT.ncfile, 'attributename', 'standard_name', 'attributevalue', 'projection_x_coordinate')); </span>
<span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  84</a></span> <span style="color: #000000; background: #E0E0FF;">Y        = nc_varget(OPT.ncfile, nc_varfind(OPT.ncfile, 'attributename', 'standard_name', 'attributevalue', 'projection_y_coordinate')); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  85</a></span> <span style="color: #000000; background: #E0E0FF;">if ~isempty(OPT.polygon) </span>
               <span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF;">    % determine the extent of the polygon</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  87</a></span> <span style="color: #000000; background: #E0E0FF;">    minx = min(OPT.polygon(:,1)); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  88</a></span> <span style="color: #000000; background: #E0E0FF;">    maxx = max(OPT.polygon(:,1)); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  89</a></span> <span style="color: #000000; background: #E0E0FF;">    miny = min(OPT.polygon(:,2)); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  90</a></span> <span style="color: #000000; background: #E0E0FF;">    maxy = max(OPT.polygon(:,2)); </span>
               <span style="color: #A0A0A0">  91</span> <span style="color: #228B22; background: #FFFFFF;">    </span>
               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF;">    % Find out which part of X and Y data lies within the extent of the polygon </span>
               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;">    % NB: these are indexes, should be reduced with one for netCDF call as nc files start counting at 0</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  94</a></span> <span style="color: #000000; background: #E0E0FF;">    xstart   = find(X&gt;minx, 1, 'first'); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  95</a></span> <span style="color: #000000; background: #E0E0FF;">    xlength  = find(X&lt;maxx, 1, 'last'); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  96</a></span> <span style="color: #000000; background: #E0E0FF;">    ystart   = find(Y&gt;miny, 1, 'first'); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a>  97</a></span> <span style="color: #000000; background: #E0E0FF;">    ylength  = find(Y&lt;maxy, 1, 'last'); </span>
               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;">else</span>
               <span style="color: #A0A0A0">  99</span> <span style="color: #A0A0A0; background: #FFFFFF;">    xstart   = 1;</span>
               <span style="color: #A0A0A0"> 100</span> <span style="color: #A0A0A0; background: #FFFFFF;">    xlength  = size(X,1);</span>
               <span style="color: #A0A0A0"> 101</span> <span style="color: #A0A0A0; background: #FFFFFF;">    ystart   = 1;</span>
               <span style="color: #A0A0A0"> 102</span> <span style="color: #A0A0A0; background: #FFFFFF;">    ylength  = size(Y,1);</span>
               <span style="color: #A0A0A0"> 103</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span>
               <span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF;">%% get relevant data (possibly using stride)</span>
<span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 106</a></span> <span style="color: #000000; background: #E0E0FF;">X        = nc_varget(OPT.ncfile, nc_varfind(OPT.ncfile, 'attributename', 'standard_name', 'attributevalue', 'projection_x_coordinate'), xstart - 1, floor((xlength-(xstart-1))/OPT.stride(3)), OPT.stride(3));  </span>
<span style="color: #FF0000">  0.27 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 107</a></span> <span style="color: #000000; background: #E0E0FF;">Y        = nc_varget(OPT.ncfile, nc_varfind(OPT.ncfile, 'attributename', 'standard_name', 'attributevalue', 'projection_y_coordinate'), ystart - 1, floor((ylength-(ystart-1))/OPT.stride(2)), OPT.stride(2));  </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 108</a></span> <span style="color: #000000; background: #E0E0FF;">Z        = zeros(size(Y,1), size(X,1))*nan; </span>
<span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 109</a></span> <span style="color: #000000; background: #E0E0FF;">T        = zeros(size(Y,1), size(X,1))*nan; </span>
               <span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF;">%% find the data files that lie within the temporal search window</span>
<span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 112</a></span> <span style="color: #000000; background: #E0E0FF;">t        = nc_varget(OPT.ncfile, nc_varfind(OPT.ncfile, 'attributename', 'standard_name', 'attributevalue', 'time')); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 113</a></span> <span style="color: #000000; background: #E0E0FF;">[t,idt]  = sort(t,'descend'); </span>
               <span style="color: #A0A0A0"> 114</span> <span style="color: #228B22; background: #FFFFFF;"></span>
<span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 115</a></span> <span style="color: #000000; background: #E0E0FF;">[start_idx, end_idx, extents, matches, tokens, names, splits]  = regexp(nc_attget(OPT.ncfile,nc_varfind(OPT.ncfile, 'attributename', 'standard_name', 'attributevalue', 'time'),'units'), '\d+'); %#ok&lt;*NASGU&gt; </span>
<span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 116</a></span> <span style="color: #000000; background: #E0E0FF;">t        = t + datenum([matches{1:6}], 'yyyymmddHHMMSS'); </span>
               <span style="color: #A0A0A0"> 117</span> <span style="color: #228B22; background: #FFFFFF;"></span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 118</a></span> <span style="color: #000000; background: #E0E0FF;">idt_in   = find(t&lt;=OPT.starttime &amp; t &gt;= OPT.starttime + OPT.searchwindow); </span>
               <span style="color: #A0A0A0"> 119</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 120</span> <span style="color: #228B22; background: #FFFFFF;">%% one by one place separate grids on overall grid</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 121</a></span> <span style="color: #000000; background: #E0E0FF;">for id_t = [idt(idt_in)-1]' %#ok&lt;NBRAK,FNDSB&gt; </span>
               <span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF;">    % So long as not all Z values inpolygon are nan try to add data</span>
<span style="color: #FF0000">  9.50 </span><span style="color: #0000FF">      7 </span><span style="color: #000000; font-weight: bold"><a> 123</a></span> <span style="color: #000000; background: #E0E0FF;">    if sum(isnan(Z(inpolygon(repmat(X',size(Y,1),1), repmat(Y, 1, size(X',2)), OPT.polygon(:,1), OPT.polygon(:,2)))))~=0 </span>
<span style="color: #FF0000">  3.94 </span><span style="color: #0000FF">      7 </span><span style="color: #000000; font-weight: bold"><a> 124</a></span> <span style="color: #000000; background: #E0E0FF;">        Z_next    = nc_varget(OPT.ncfile, nc_varfind(OPT.ncfile, 'attributename', 'standard_name', 'attributevalue', 'altitude'), [id_t ystart-1 xstart-1], [1 floor((ylength-(ystart-1))/OPT.stride(2)) floor((xlength-(xstart-1))/OPT.stride(3))], OPT.stride); </span>
<span style="color: #FF0000">  0.25 </span><span style="color: #0000FF">      7 </span><span style="color: #000000; font-weight: bold"><a> 125</a></span> <span style="color: #000000; background: #E0E0FF;">        if sum(sum(~isnan(Z_next))) ~=0 </span>
<span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"><a> 126</a></span> <span style="color: #000000; background: #E0E0FF;">            disp(['... adding data from: ' datestr(t(idt(id_t+1)))]) </span>
<span style="color: #FF0000">  0.27 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"><a> 127</a></span> <span style="color: #000000; background: #E0E0FF;">            ids2add = ~isnan(Z_next) &amp; isnan(Z);    % helpul to be in a variable as the nature of Z changes in the next two lines </span>
<span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"><a> 128</a></span> <span style="color: #000000; background: #E0E0FF;">            Z(ids2add) = Z_next(ids2add);           % add Z values from Z_next grid to Z grid at places where there is data in Z_next and no data in Z yet </span>
       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"><a> 129</a></span> <span style="color: #000000; background: #E0E0FF;">            T(ids2add) = t(idt(id_t+1));            % add time information to T at those places where Z data was added </span>
       <span style="color: #0000FF">      2 </span><span style="color: #000000; font-weight: bold"><a> 130</a></span> <span style="color: #000000; background: #E0E0FF;">        end </span>
       <span style="color: #0000FF">      7 </span><span style="color: #000000; font-weight: bold"><a> 131</a></span> <span style="color: #000000; background: #E0E0FF;">    end </span>
       <span style="color: #0000FF">      7 </span><span style="color: #000000; font-weight: bold"><a> 132</a></span> <span style="color: #000000; background: #E0E0FF;">end </span>
               <span style="color: #A0A0A0"> 133</span> <span style="color: #228B22; background: #FFFFFF;"></span>
               <span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;">%% set values outside polygon to nan if a polygon is available</span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 135</a></span> <span style="color: #000000; background: #E0E0FF;">if ~isempty(OPT.polygon) </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 136</a></span> <span style="color: #000000; background: #E0E0FF;">    disp('Setting values not in polygon to nan ...') </span>
<span style="color: #FF0000">  1.34 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 137</a></span> <span style="color: #000000; background: #E0E0FF;">    idout = ~inpolygon(repmat(X',size(Y,1),1), repmat(Y, 1, size(X',2)), OPT.polygon(:,1), OPT.polygon(:,2)); </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 138</a></span> <span style="color: #000000; background: #E0E0FF;">    Z(idout) = nan; </span>
<span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 139</a></span> <span style="color: #000000; background: #E0E0FF;">    T(idout) = nan; </span>
       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"><a> 140</a></span> <span style="color: #000000; background: #E0E0FF;">end </span>
</pre>
</div>
</body>
</html>
